(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"+oIK":function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"b",function(){return f});var a=n("+vh4"),r=n("LeJ0"),c=n("QtlZ"),o=n("LVcX"),s=n("hm8b"),i=n("i9gz"),u=n("MFhO"),l=n("PjZB"),d=n("0lfv"),b={widgetVersion:2,widgetRelease:"LOCAL"!==r.a.ENV?"___RELEASE_ID":"local"},p=function createMessage(e){var t=e.message,n=void 0===t?"":t,r=e.activeConversation,p=e.attributes,f=void 0===p?{}:p,h=e.isMetaMessage,v=void 0!==h&&h,O=e.authorId,j=e.attachments,m=void 0===j?[]:j,_=e.preMessages,k=void 0===_?[]:_,w=e.inboxId,C=e.type,y=void 0===C?l.e.CHAT:C,E=e.contentType,I=void 0===E?l.c.CHAT:E,S=c.a.getState(),x=Object(o.a)({context:{}},["session"],S),A=Object(o.a)(l.b.LEAD,["session","endUser","type"],S),T=Object(o.a)(null,["campaigns","activeCampaign"],S),M=Object(o.a)({},["embed","configuration"],S),R=M.autoAssigneeId,N=M.profileMode,P=void 0!==N&&N,B=g(w),U=Object(s.a)(k)||Object(i.a)(k)?function _applyPremessagesForMessage(e,t){var n=Object(o.a)({},["embed","configuration"],c.a.getState()),a=n.autoAssigneeId,r=n.profileMode,s=void 0!==r&&r,i=n.team,l=n.theme,d=void 0===l?{}:l,b=Object(o.a)(null,["attributes","campaignDisplayType"],t)===u.a.WELCOME_MESSAGE,p=Object(o.a)("",["attributes","message"],t),f=Object(o.a)(null,["attributes","senderId"],t),h=[];return e?h:(s&&a&&h.push({body:d.welcomeMessage,sender:i.find(function(e){return e.id===a})}),b&&h.push({body:p,sender:i.find(function(e){return e.id===f})}),h)}(r,T):k;return{attachments:m,conversationId:r,body:n,type:y,contentType:I,authorId:O,authorType:A,inboxId:B,attributes:Object(a.a)({},f,{widgetGuid:Object(d.n)(),isMetaMessage:v,generatedAt:Date.now().valueOf(),autoAssigneeId:R,profileMode:P,preMessages:U},b),context:{userAgent:x.context.userAgent,timezone:x.context.timezone,locale:x.context.locale,page:x.context.page}}},f=function createPreMessagesForCampaign(e){var t=e.body,n=e.attributes,a=(n=void 0===n?{}:n).title,r=void 0===a?null:a,c=n.senderId,o=void 0===c?null:c,s=n.noSenderId,i=void 0!==s&&s,l=n.automaticSender,b=void 0!==l&&l,p=n.campaignDisplayType,f=(void 0===p?null:p)===u.a.WELCOME_MESSAGE,g=h(o,i,b),v=[];return r&&!f&&v.push({id:Object(d.n)(),body:r,sender:g}),t&&v.push({id:Object(d.n)(),body:t,sender:g}),v},h=function getSender(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t)return null;var a=Object(o.a)({},["embed","configuration"],c.a.getState()),r=a.autoAssigneeId,s=a.team;return n&&r?s.find(function(e){return e.id===r}):s.find(function(t){return t.id===e})},g=function resolveInboxIdForMessage(e){var t=c.a.getState(),n=Object(o.a)({},["embed","configuration"],t).inboxId;if(!Object(s.a)(e))return e;var a=Object(o.a)(null,["conversations","activeConversation"],t),r=Object(o.a)(null,["conversations","conversations",a,"conversation"],t);return Object(s.a)(r)?n:r.inboxId}},"3y+j":function(e,t,n){},"6wvX":function(e,t,n){"use strict";var a=n("uDfI"),r=n("0lfv");t.a=function useIsMobile(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(a.c)(function(t){return Object(r.i)(t.session.context.userAgent,e)})}},"7fJ7":function(e,t,n){"use strict";n.r(t);var a=n("mj2O"),r=n.n(a),c=n("7SM1"),o=n("s8DI"),s=n("QtlZ"),i=n("Wjfv"),u=n("7oto"),l=function UseRemoveActiveCampaign(){Object(u.c)({topic:"CONDUCTOR:remove-active-campaign",handler:function handler(e){s.a.dispatch(Object(i.a)())}})},d=n("+vh4"),b=n("mfas"),p=function UseStateSnapShot(){return Object(u.c)({topic:"CONDUCTOR:request-state-from-controller",handler:function handler(e){var t=e.data,n=s.a.getState();Object(u.a)({topic:"".concat(t.name,":state-snap-shot"),message:{state:Object(d.a)({},Object(b.a)(["session"],n),{session:Object(b.a)(["sockets"],n.session)})}})}}),s.a},f=n("My8U"),h=n("nQD+"),g=n("ab+K"),v=n("LVcX"),O=n("ERkP"),j=n.n(O),m=function useIsBotMessage(e){return Object(O.useMemo)(function(){return Object(v.a)(!1,["attributes","isBot"],e)},[e])},_=n("rAhV"),k=n("SsZN"),w=n("da4L"),C=function setControllerWidth(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(u.a)({topic:"set-frame-width",message:{width:"".concat(e,"px"),name:"controller"}})},y=function setControllerHeight(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(u.a)({topic:"set-frame-height",message:{height:"".concat(e,"px"),name:"controller",max:!1}})},E=function hideWidgetController(){return y(0)},I=function showWidgetController(){return y(76)},S=function resetControllerSize(){y(76),C(76)},x=n("g6eD"),A=n("i9gz"),T=n("DboL"),M=n("RhEL"),R=n("uDfI"),N=n("PjZB"),P=n("t8ds"),B=(n("pUpc"),P.a.sismember),U=function MessagePreview(){var e=Object(O.useRef)(null),t=Object(R.b)(),n=Object(O.useState)(null),a=Object(o.a)(n,2),s=a[0],u=a[1],l=Object(O.useState)(!1),d=Object(o.a)(l,2),b=d[0],p=d[1],f=Object(R.c)(function(e){return e.conversations}).activeConversation,v=Object(R.c)(function(e){return f&&e.conversations.messages[f]||{}}),E=Object(R.c)(function(e){return e.view.chatOpen});Object(O.useEffect)(function(){!function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(s){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,B("messagesSeen",s.id);case 4:e=n.sent,t=e.data,p(t);case 7:case"end":return n.stop()}},_callee)}));return function getHasSeen(){return e.apply(this,arguments)}}()()},[s,E]);var I=Object(O.useMemo)(function(){return!E&&!b&&function isAgentMessage(e){return e&&(e.contentType===N.c.CHAT||e.contentType===N.c.ANNOUNCEMENT||e.contentType===N.c.BOT_CONVERSATION_RATING)&&e.authorType===N.b.USER}(s)},[s,E,b]),P=Object(O.useMemo)(function(){return!I||!s||s.viewerRecipientStatus===N.f.READ||(!s.body||!s.body.length)&&!Object(w.f)(s,"ratingPrompt")},[I,s]),U=Object(_.a)().markAsRead;Object(O.useEffect)(function setLatestMessageFromConvo(){if(!Object(A.a)(v)){var e=Object(w.l)(Object(T.a)(v)).pop()||{};s&&Object(M.a)(e.id,s.id)||u(Object(w.n)(e,100))}},[v]),Object(O.useLayoutEffect)(function updateFrameSize(){if(s){var t=e.current?e.current.clientWidth:22,n=e.current?e.current.clientHeight:22,a=I&&!P,r=a?t+76+40:76;y(a&&n+36>76?n+36:76),C(r)}},[e,s,P,I,S]);var D=m(s);if(P||!s)return null;return j.a.createElement("div",{className:"drift-widget-message-preview-wrapper",key:"".concat(s.id,"-preview-box")},j.a.createElement("div",{className:"drift-widget-message-preview"},j.a.createElement(g.a,{onClick:function dismiss(){s&&(U(f),u({}),S(),D&&(Object(k.p)(s),t(Object(i.a)())))}}),j.a.createElement(h.a,{onClick:function openChat(){S(),U(f),D&&Object(k.o)(s),t(Object(x.a)({chatOpen:!0}))},className:"drift-widget-message-preview-text"},j.a.createElement("p",{ref:e},Object(w.d)(s)))))},D=n("O94r"),L=n.n(D),V=n("+Kbs"),F=n("yEsl"),$=n("hSLT"),W=n("6wvX"),H=n("tLIi"),J=n("o3t1"),G=n("lE29"),q=function useThemeIcon(){var e=Object(R.c)(function(e){return e.embed.configuration}).theme,t=e.iconStyle,n=e.iconUrl,a=e.foregroundColor,r={SOLID1:j.a.createElement(V.h,{fill:"#".concat(a)}),SOLID2:j.a.createElement(V.g,{fill:"#".concat(a)}),OUTLINE1:j.a.createElement(V.e,{fill:"#".concat(a)}),OUTLINE2:j.a.createElement(V.f,{fill:"#".concat(a)}),BOLT:V.c};return{customIcon:n?{backgroundImage:"url(".concat(n,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{},hasCustomIcon:!!n,Icon:r[t]||null}},z=n("0B8E"),K=n("MFhO"),Q=n("0lfv"),Y=function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(e=Object(v.a)(!1,["embed","configuration","theme","soundNotificationEnabled"],s.a.getState()),t=s.a.getState().view.chatOpen,!e){n.next=5;break}return n.next=5,Object(u.a)({topic:"play-host-notification",message:{chatOpen:t}});case 5:case"end":return n.stop()}},_callee)}));return function playSoundNotification(){return e.apply(this,arguments)}}(),Z=n("rTkt"),X=(n("3y+j"),function WidgetIcon(){var e=Object(J.a)(),t=e.hoverProps,n=e.isHovered,a=Object(R.b)(),o=Object(R.c)(function(e){return e.view.chatOpen}),s=Object(R.c)(function(e){return e.session.gdpr}),i=Object(R.c)(function(e){return!!e.conversations.activeConversation}),l=Object(R.c)(function(e){return!!e.campaigns.activeCampaign.id}),b=Object(R.c)(function(e){return e.view.matchedTargeting}),p=Object(R.c)(function(e){return Object(v.a)(!1,["embed","configuration","theme"],e)}).unreadBadgeEnabled,f=Object(R.c)(function(e){return e.conversations}).activeConversation,h=Object(R.c)(function(e){return Object(v.a)([],["conversations","unreadAgentMessages",f],e)}),g=Object(H.a)(),w=m(g),C=Object(G.a)(),y=C.backgroundStyles,S=C.widgetSecondaryColor,A=Object(O.useMemo)(function(){return n?Object(Z.c)(y.background,-35):y.background},[n,y]),T=q(),M=T.Icon,N=T.customIcon,P=T.hasCustomIcon,B=Object($.a)(),U=B.senderId,D=B.type,X=Object(_.a)().markAsRead,ee=U||Object(v.a)(void 0,["authorId"],g),te=h?Object(z.a)(h).length:0,ne=D===K.a.SLIDER,ae=ne&&U,re=ee&&h.length>0,ce=Object(O.useMemo)(function(){return!b&&!l&&!o},[b,l,o]),oe=Object(W.a)();Object(O.useEffect)(function(){Object(u.a)({topic:"toggle-widget-controller",message:{open:o,hasActiveConversation:i&&s.hasConsent}})},[o,s,i]),Object(O.useEffect)(function(){!function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t,n;return r.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Q.m)(50);case 2:return a.next=4,Object(u.a)({topic:"get-frame-height",message:{name:"controller"}});case 4:e=a.sent,t=e.data,n="0px"===t,b&&n&&I(),l&&n&&I(),b||l||n||E();case 10:case"end":return a.stop()}},_callee)}));return function calculateIconVisibility(){return e.apply(this,arguments)}}()()},[b,l]),Object(O.useEffect)(function(){h&&h.length>0&&Y()},[h]);var se=Object(O.useMemo)(function(){return re&&!o?{}:P?o?{background:"".concat(A)}:n?Object(d.a)({opacity:.65},N):N:{background:"".concat(A)}},[N,re,o,A,P,n]);return ce?null:j.a.createElement("button",Object.assign({className:L()("drift-widget-controller",{"drift-widget-controller--closed":!oe&&o,"drift-widget-controller--custom-icon":P,"drift-widget-controller--avatar":re}),onClick:function onToggleChat(){o||(X(f),te>0&&w&&Object(k.o)(g)),function toggle(e){ne?Object(u.a)({topic:"slider:showDetails",message:{}}):a(Object(x.a)({chatOpen:e})),e&&Object(u.a)({topic:"reset-controller-size"})}(!o)},style:se},t,{"aria-label":o?"close chat":"open chat"}),j.a.createElement("div",{className:"drift-widget-controller-icon"},j.a.createElement("div",{className:"drift-controller-icon--active"},!P&&!re&&(ae?j.a.createElement(V.l,{fill:S}):M),re&&j.a.createElement(F.a,{className:"drift-controller-icon--avatar",id:ee})),j.a.createElement("div",{className:"drift-controller-icon--close",style:{backgroundColor:S}})),p&&h.length>0&&j.a.createElement("div",{className:"drift-controller-icon-unread"},Math.min(te,99)))}),ee=function ControllerLayout(){return j.a.createElement("main",{role:"main","aria-label":"drift-controller-main"},j.a.createElement(U,null),j.a.createElement(X,null))},te=n("WwEg"),ne=n("OE2q"),ae=n("LqZ+"),re=n("2PAb"),ce=n("K7i0"),oe=n("Cpup"),se=function receiveEmbedConfiguration(e){return Object(oe.a)({type:"RECEIVE_EMBED_CONFIGURATION",payload:e})},ie=n("PCkZ"),ue=n("TDUE"),le=n("qwiD"),de=n("ws1h"),be=n("FAmh"),pe=n("pqMu"),fe=n("gG69"),he=n("76KI"),ge=n("Nlet"),ve=n("VYE+"),Oe=n("uIJS"),je=n("wQh9"),me=function(){function SyncCallbackRunner(){Object(Oe.a)(this,SyncCallbackRunner),this._running=!1,this._callbacks=[]}return Object(je.a)(SyncCallbackRunner,[{key:"execute",value:function execute(e){this._callbacks.push(e),this.run()}},{key:"run",value:function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(!this._running&&0!==this._callbacks.length){n.next=2;break}return n.abrupt("return");case 2:this._running=!0;case 3:if(!(this._callbacks.length>0)){n.next=11;break}if(e=this._callbacks.shift(),!(t=e())||!t.then){n.next=9;break}return n.next=9,t;case 9:n.next=3;break;case 11:this._running=!1;case 12:case"end":return n.stop()}},_callee,this)}));return function run(){return e.apply(this,arguments)}}()}]),SyncCallbackRunner}(),_e=n("4c+F"),ke=n("hm8b"),we=n("3kqR"),Ce=n("8saY"),ye=Object.freeze({welcomeMessage:"welcomeMessage",awayMessage:"awayMessage",emailCaptureMessage:"emailCaptureMessage",thankYouMessage:"confirmationMessage"}),Ee=function apiWarning(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).warn.apply(e,["Drift API -"].concat(n))},Ie=function apiError(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).error.apply(e,["Drift API -"].concat(n))},Se=n("F8vJ"),xe=function areAttributesValid(e,t,n,a){if(Object(ke.a)(a))return n;if("function"!==typeof a&&Object(pe.a)(Object,a)){for(var r=0,c=Object.keys(a);r<c.length;r++){var o=c[r],s=a[o];if(!Object(pe.a)(Number,s)&&!Object(pe.a)(String,s)&&!Object(pe.a)(Boolean,s))return Ie("".concat(e,'(...) "').concat(o,'" in ').concat(t," must be number, string, or boolean but instead we got ").concat(typeof s,".")),!1;if("email"===o&&(!Object(pe.a)(String,s)||!Object(Se.a)(s)))return Ie("".concat(e,"(...) email in ").concat(t," is invalid:"),s),!1}return!0}return!1},Ae=function param(e,t,n){return{name:e,type:t,optional:n}},Te={config:[Ae("options",Object)],collectFormData:[Ae("data",xe),Ae("options",Object,!0)],goToConversation:[Ae("Conversation ID",Number)],goToNewConversation:[Ae("Message",String)],identify:[Ae("User ID",String),Ae("attributes",xe,!0),Ae("options",Object,!0)],off:[Ae("Event name",String),Ae("handler",Function)],on:[Ae("Event name",String),Ae("handler",Function)],page:[Ae("Page name",String,!0)],setUserAttributes:[Ae("attributes",xe)],setUserJwt:[Ae("User JWT",String)],scheduleMeeting:[Ae("Agent ID",Number),Ae("options",Object,!0)],showAwayMessage:[Ae("Message",String,!0)],showWelcomeMessage:[Ae("Message",String,!0)],startInteraction:[Ae("params",function areStartInteractionParamsValid(e,t,n,a){return Object(ke.a)(a)&&!n||!Object(pe.a)(Object,a)?(Ie("".concat(e,"({ ... }) must be called with ").concat(t," { interactionId: number, goToConversation: boolean } (goToConversation is optional.)")),!1):a.interactionId&&!Object(ke.a)(a.interactionId)&&Object(pe.a)(Number,a.interactionId)?!(a.goToConversation&&!Object(pe.a)(Boolean,a.goToConversation))||(Ie("".concat(e,'({ ... }) "goToConversation" parameter should be boolean but we got ').concat(typeof a.goToConversation,".")),!1):(Ie("".concat(e,"({ ... }) requires ").concat(t,' object with numeric "interactionId" but we got ').concat(typeof a.interactionId,".")),!1)})],toggleHoursAndTargeting:[Ae("enabled",Boolean)],track:[Ae("Event name",String),Ae("attributes",xe,!0)]},Me=function getTypeName(e){return e===String||Object(pe.a)(String,e)?"string":e===Boolean||Object(pe.a)(Boolean,e)?"boolean":e===Number||Object(pe.a)(Number,e)?"number":e===Object||Object(pe.a)(Object,e)?"object":e===Function||Object(pe.a)(Function,e)?"function":Object(ke.a)(e)?"null":"unknown"},Re=function validateMethod(e,t){return Te[e]?function areArgsValid(e,t,n){var a=t.length,r=n.filter(function(e){return!e.optional}).length;return n.reduce(function(n,c,o){var s=c.name,i=c.type,u=c.optional,l=void 0!==u&&u;if(o>=a)return l||Ie("Invalid ".concat(e,"(...) call! It requires ").concat(r," argument(s) and it's missing ").concat(s," ").concat(Me(i),".")),n&&l&&a>=r;var d=t[o],b=!1;return l&&Object(ke.a)(d)?b=!0:i===Function||i===Object||i===String||i===Number||i===Boolean?(b="function"===typeof d?i===Function:Object(pe.a)(i,d))||Ie("Invalid ".concat(e,"(...) call! ").concat(s," (arg ").concat(o,") should be ").concat(Me(i)," instead of ").concat(Me(d),".")):b=i(e,s,l,d),n&&b},!0)}(e,t,Te[e]):(!Object(ke.a)(t)&&Object(pe.a)(Array,t)&&!!t.length&&Ee("".concat(e,"() should ideally be called without arguments.")),!0)},Ne=function track(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{Object(ae.a)(e,t)}catch(n){Object(Q.k)({data:[n],type:"warn"})}},Pe=function(){var e=Object(c.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ve.b)(Object(T.a)(re.a));case 2:Object(u.a)({topic:"reload-all-frames",message:{}});case 3:case"end":return e.stop()}},_callee)}));return function reset(){return e.apply(this,arguments)}}(),Be=function openChat(){Fe(),s.a.dispatch(Object(x.a)({chatOpen:!0}))},Ue=function hideChat(){s.a.dispatch(Object(x.a)({chatOpen:!1}))},De=function(){var e=Object(c.a)(r.a.mark(function _callee2(e){var t,n,a,c;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(ge.b)();case 2:return t=r.sent,s.a.dispatch(Object(le.h)(t)),n=Object(d.a)({},Object(v.a)({},["page"],t)),e&&"string"===typeof e&&(n.pageName=e),Ne("Page",n),r.next=9,Object(u.a)({topic:"reset-campaign-refresh-token"});case 9:a=r.sent,c=a.data,s.a.dispatch(Object(le.t)(Object(Q.n)())),s.a.dispatch(Object(le.s)(c)),Object(be.a)();case 14:case"end":return r.stop()}},_callee2)}));return function page(t){return e.apply(this,arguments)}}(),Le=function debouncedAPIMethod(e){return Object(Q.c)(e,500,!0)}(function(){var e=Object(c.a)(r.a.mark(function _callee3(e){var t;return r.a.wrap(function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:if((t=(e||{}).interactionId)||Object(pe.a)(Number,t)){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,Object(ne.a)(t,{isTriggeredFromAPI:!0});case 5:case"end":return n.stop()}},_callee3)}));return function _startInteraction(t){return e.apply(this,arguments)}}()),Ve=function(){var e=Object(c.a)(r.a.mark(function _callee4(){var e,t,n,a,c,o=arguments;return r.a.wrap(function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:"",r.prev=1,r.next=4,Object(ne.b)(e,{isTriggeredFromAPI:!0});case 4:return t=r.sent,n=t.data,r.next=8,Object(ne.e)(n.conversationId);case 8:a=r.sent,c=a.data,s.a.dispatch(Object(ce.e)({conversation:c})),s.a.dispatch(Object(ce.k)({conversationId:n.conversationId})),r.next=16;break;case 14:r.prev=14,r.t0=r.catch(1);case 16:case"end":return r.stop()}},_callee4,null,[[1,14]])}));return function goToNewConversation(){return e.apply(this,arguments)}}(),Fe=function show(){s.a.dispatch(Object(x.d)({matchedTargeting:!0})),I()},$e=function(){var e=Object(c.a)(r.a.mark(function _callee5(e,t){var n,a,c;return r.a.wrap(function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return n=Object(v.a)(null,["session","endUser","email"],s.a.getState()),Be(),r.prev=2,r.next=5,Object(ne.c)(n,e,t);case 5:a=r.sent,c=a.data.conversationId,s.a.dispatch(Object(ce.k)({conversationId:c})),Object(k.j)(e),Object(ue.d)(fe.c.CALENDAR_DROP),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),Object(Q.k)({data:[r.t0],type:"warn"});case 15:case"end":return r.stop()}},_callee5,null,[[2,12]])}));return function scheduleMeeting(t,n){return e.apply(this,arguments)}}(),We=function(){var e=Object(c.a)(r.a.mark(function _callee6(e){var t,n,a,c,o=arguments;return r.a.wrap(function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=o.length>2&&void 0!==o[2]?o[2]:{},r.prev=2,a=Object(b.a)(["hasProvidedIdentity"],t),r.next=6,Object(ie.c)(a,e,n);case 6:t.email&&(c=t.email,s.a.dispatch(Object(le.j)({endUser:{email:c}}))),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(2),Object(Q.k)({data:[r.t0],type:"warn"});case 12:case"end":return r.stop()}},_callee6,null,[[2,9]])}));return function identify(t){return e.apply(this,arguments)}}(),He=function(){var e=Object(c.a)(r.a.mark(function _callee7(e){return r.a.wrap(function _callee7$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ie.c)(e);case 2:Object(k.s)();case 3:case"end":return t.stop()}},_callee7)}));return function setUserAttributes(t){return e.apply(this,arguments)}}(),Je=function(){var e=Object(c.a)(r.a.mark(function _callee8(e,t){return r.a.wrap(function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:if(Object(he.a)("has_widget_forms")){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,Object(ie.c)(e);case 4:if(Object(k.i)(e),t){n.next=7;break}return n.abrupt("return");case 7:if(!t.redirectTo){n.next=10;break}return n.next=10,Object(u.a)({topic:"redirect-to-url",message:{url:t.redirectTo}});case 10:case"end":return n.stop()}},_callee8)}));return function collectFormData(t,n){return e.apply(this,arguments)}}(),Ge=function(){var e=Object(c.a)(r.a.mark(function _callee9(){return r.a.wrap(function _callee9$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(de.a)();case 2:return e.t0=e.sent,e.next=5,Object(de.b)();case 5:return e.t1=e.sent,e.abrupt("return",{isOnline:e.t0,teamAvailability:e.t1,sidebarOpen:!1});case 7:case"end":return e.stop()}},_callee9)}));return function getWidgetReadyPayload(){return e.apply(this,arguments)}}(),qe={identify:We,config:function config(e){if(!Object(pe.a)(Object,e))return!1;var t=e.cookieDomain;if(t){var n=Object(ve.f)([t]);n&&s.a.dispatch(Object(le.i)({cookieDomain:n}))}var a=function configOptionsToEmbedConfiguration(e){var t={theme:{}};if(Object(ke.a)(e))return t;var n=e.locale,a=e.enableWelcomeMessage,r=e.enableCampaigns,c=e.enableChatTargeting,o=e.backgroundColor,s=e.foregroundColor,i=e.activeColor,u=e.textColor,l=e.widgetBackgroundColor,d=e.autoAssigneeId,b=e.autoAssignee,p=e.inboxId,f=e.enabled,h=e.profileMode,g=e.messages,v=e.cookieDomain,O=e.verticalOffset;return n&&(t.locale=n),Object(ke.a)(a)||(t.theme.showWelcomeMessage=!!a),Object(ke.a)(r)||(t.campaignsEnabled=r),!1===c&&(t.theme.audience=Ce.a.EVERYONE,t.theme.conditions=[]),o&&(t.theme.backgroundColor=o.replace("#","")),s&&(t.theme.foregroundColor=s.replace("#","")),i&&(t.theme.activeColor=i.replace("#","")),u&&(t.theme.textColor=u.replace("#","")),l&&(t.theme.widgetBackgroundColor=l.replace("#","")),Object(ke.a)(d)||(t.autoAssigneeId=d),Object(ke.a)(b)||(t.autoAssignee=b),p&&(t.inboxId=p),Object(ke.a)(O)||(t.verticalOffset=O),Object(ke.a)(f)||(t.enabled=!!f),Object(ke.a)(h)||(t.profileMode=!!h),Object(ke.a)(g)||Object(we.a)(function(e,n){g[n]&&(t.theme[e]=g[n])},ye),Object(ke.a)(v)||(t.theme.cookieDomains=[v]),t}(e);s.a.dispatch(function receiveEmbedConfigurationOverride(e){return Object(oe.a)({type:"RECEIVE_EMBED_CONFIGURATION_OVERRIDE",payload:e})}(a))},track:Ne,reset:Pe,debug:function debug(){Ee("drift.debug is not supported in this release.")},show:Fe,ping:function ping(){Ee("drift.ping is not supported in this release.")},page:De,hide:function hide(){Ue(),E()},off:function off(){},on:function on(){},collectFormData:Je,goToConversation:function goToConversation(e){s.a.dispatch(Object(ce.k)({conversationId:e})),Be()},goToConversationList:function goToConversationList(){var e=s.a.getState().conversations;Object(A.a)(e.conversations)||(Be(),s.a.dispatch(Object(x.b)({conversationHistoryOpen:!0})))},goToNewConversation:Ve,hideAwayMessage:function hideAwayMessage(){return Ue()},hideChat:Ue,hideWelcomeMessage:function hideWelcomeMessage(){return Ue()},openChat:Be,toggleChat:function toggleChat(){Object(v.a)(!1,["view","chatOpen"],s.a.getState())?Ue():Be()},scheduleMeeting:$e,setUserAttributes:He,showAwayMessage:function showAwayMessage(e){s.a.dispatch(Object(ce.a)()),s.a.dispatch(Object(i.a)()),s.a.dispatch(Object(x.d)({matchedHours:!1,matchedTargeting:!0})),e&&"string"===typeof e&&e.length&&s.a.dispatch(function receiveEmbedAwayMessage(e){return Object(oe.a)({type:"RECIEVE_EMBED_AWAY_MESSAGE",payload:e})}({message:e})),I(),s.a.dispatch(Object(x.a)({chatOpen:!0}))},showWelcomeMessage:function showWelcomeMessage(e){s.a.dispatch(Object(ce.a)()),s.a.dispatch(Object(i.a)()),s.a.dispatch(Object(x.d)({matchedHours:!0,matchedTargeting:!0})),e&&"string"===typeof e&&e.length&&s.a.dispatch(function receiveEmbedWelcomeMessage(e){return Object(oe.a)({type:"RECEIVE_EMBED_WELCOME_MESSAGE",payload:e})}({message:e})),I(),s.a.dispatch(Object(x.a)({chatOpen:!0}))},showWelcomeOrAwayMessage:function showWelcomeOrAwayMessage(){s.a.dispatch(Object(ce.a)()),Be()},startInteraction:Le,startVideoGreeting:function startVideoGreeting(){Ee("drift.startVideoGreeting is not supported in this release.")},evaluateCampaignTargeting:function evaluateCampaignTargeting(){Object(be.a)()},toggleHoursAndTargeting:function toggleHoursAndTargeting(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];s.a.dispatch(Object(x.d)({matchedHours:e,matchedTargeting:!0}))},waitForUserJwt:function waitForUserJwt(){try{s.a.dispatch(Object(le.u)())}catch(e){Object(Q.k)({data:[e],type:"warn"})}},setUserJwt:function setUserJwt(e){try{s.a.dispatch(Object(le.m)(e))}catch(t){Object(Q.k)({data:[t],type:"warn"})}}},ze=new me,Ke=function handleApiEvent(e){var t=e.data,n=t.method,a=t.args;qe[n]?Re(n,a)&&ze.execute(function(){return Object(_e.c)("API Event Fired",{method:n}),qe[n].apply(qe,Object(te.a)(a))}):Ie("".concat(n,"(...) does not exist."))},Qe=n("efbE"),Ye=n("m6rJ"),Ze=function widgetBootstrap(e,t){var n=Object(Ye.e)(e);return Qe.c.post("widget_bootstrap",{data:Object(d.a)({},n,t)})},Xe=function getEmbedConfiguration(e){return Qe.m.get("/embeds/".concat(e,".json"))},et=n("jKoD"),tt=n("vEWT"),nt=["BE","BG","CZ","DK","DE","EE","IE","EL","ES","FR","HR","IT","CY","LV","LT","LU","HU","MT","NL","AT","PL","PT","RO","SI","SK","FI","SE","GB"],at=["CA"],rt={EU:nt,CANADA:at,EU_CANADA:[].concat(at,nt),NONE:"NONE",ALL:"ALL"},ct={googleAnalyticsSettings:!0},ot=n("yKvL"),st=n("6BAR"),it=n("z8Kx"),ut=n("qytN"),lt=n("7jL2"),dt=n("LvsC"),bt=P.a.get,pt=function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t,n,a,c,o;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return e=s.a.getState(),t=e.session,n=e.conversations,r.next=3,bt("visitCounts");case 3:return a=r.sent,c=a.data,o=Object(b.a)(["href"],t.context.page),r.abrupt("return",{engagement:{activeConversation:n.endUserEngaged},page:o,location:ht(t.geo),session:ft(t.context,c)});case 7:case"end":return r.stop()}},_callee)}));return function generatePresenceContext(){return e.apply(this,arguments)}}(),ft=function _hydrateSessionPresenceData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{numPageViews:Object(v.a)(0,["total"],t),numSessions:Object(v.a)(0,["total"],t),currentSessionStartedAt:e.currentSessionStartedAt,currentPageViewStartedAt:e.currentPageViewStartedAt,previousSessionStartedAt:Object(v.a)(null,["lastVisit"],t),previousSessionEndedAt:null,firstSessionAt:Object(v.a)(null,["firstVisit"],t),activeSessionStartedAt:e.activeSessionStartedAt}},ht=function _hydrateGeoPresenceData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ip:e.ip,city:e.city,subdivision:e.subdivision,country:e.country,countryCode:e.countryCode,gdprApplicable:e.gdprApplicable,metroCode:e.metroCode,postalCode:e.postalCode,latLong:{lat:e.latitude,lon:e.longitude}}},gt=n("7VeV"),vt=n("LeJ0"),Ot=n("Gzp1"),jt=n("l+Xe"),mt=function OpenSocket(e){var t=e.session_token,n=e.org_id,a=e.socketCluster,r=e.ip,c=vt.a.WS_PROTOCOL,o="LOCAL"===vt.a.WS_USER_ENV?"":"".concat(n,"-"),s=kt(n,o,a),i="".concat(c,"://").concat(s,"/ws"),u=new Ot.Socket(i,{params:{session_token:t,remote_ip:r},timeout:1e4,reconnectAfterMs:function reconnectAfterMs(e){return[1e3,2e3,5e3,1e4][e-1]||1e4},rejoinAfterMs:function rejoinAfterMs(e){return[1e3,2e3,5e3][e-1]||1e4}});return u.connect(),u.onError(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object(Q.k)({data:["Failed to connect to socket: ".concat(i)].concat(t)})}),u.onClose(function(){return Object(Q.k)({data:["socket ".concat(i," has closed")]})}),u},_t=function(){var e=Object(c.a)(r.a.mark(function _callee2(e){var t,n,a,o;return r.a.wrap(function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return t=e.channelName,n=e.socket,a=e.events,o=new Promise(function(){var e=Object(c.a)(r.a.mark(function _callee(e,c){var o;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:o=n.channel(t),a.forEach(function(e){var t=e.topic,n=e.event;o.on(t,n)}),o.join().receive("ok",function(){e({channel:o})}).receive("error",function(e){Object(Q.k)({data:["Error connecting to channel: ".concat(t)]}),c(e)}).receive("timeout",function(e){Object(Q.k)({data:["Joining the ".concat(t," channel timed out. ")]})});case 3:case"end":return r.stop()}},_callee)}));return function(t,n){return e.apply(this,arguments)}}()),s.abrupt("return",o);case 3:case"end":return s.stop()}},_callee2)}));return function JoinChannel(t){return e.apply(this,arguments)}}(),kt=function _resolveSocketBaseForType(e,t,n){switch(n){case Qt.CHAT:return"".concat(Object(jt.d)(e));case Qt.USER:return vt.a.WS_USER_BASE;case Qt.PRESENCE:return"".concat(t).concat(Object(jt.c)(e));case Qt.VISITOR_PRESENCE:return vt.a.WS_VISITOR_PRESENCE_BASE;default:return""}},wt=n("vjCh"),Ct="emailCapture",yt="campaign-conversations",Et="campaign-enrollment",It="bootstrap:complete",St="bootstrap:timeout",xt=n("y0Ar"),At=n("NFvl"),Tt=/(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?/gim,Mt=n("7BJg"),Rt=1e3,Nt=new(function(e){function AgentMessageEventBuffer(){var e;return Object(Oe.a)(this,AgentMessageEventBuffer),(e=Object(ut.a)(this,Object(lt.a)(AgentMessageEventBuffer).call(this,Rt)))._publishBuffer=function(){e._events.length&&(Object(w.l)(e._events).forEach(function(t){e._dispatchAgentMessage(t),Object(w.f)(t,"startInteraction")&&!Object(w.f)(t,"campaignId")?(e._openChatWithMessage(t),e._setMessageReadStatus(t,!0)):e._setMessageReadStatus(t)}),e._resetBuffer())},e._openChatWithMessage=function(e){s.a.getState().view.chatOpen||setTimeout(function(){return s.a.dispatch(Object(x.a)({chatOpen:!0}))},500)},e._setMessageReadStatus=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object(ne.f)(e.conversationId,[e.id]):s.a.dispatch(Object(ce.o)({message:e}))},e._dispatchAgentMessage=function(e){s.a.dispatch(Object(ce.b)({message:e}))},e}return Object(dt.a)(AgentMessageEventBuffer,e),AgentMessageEventBuffer}(Mt.a)),Pt=function evaluateEndUserResponseChatMessage(e){if(Object(w.f)(e,"buttonClicked")&&Object(k.b)(e),e.body){var t=function extractPhoneNumbers(e){return e?e.match(Tt):null}(e.body);t&&t.length&&t.forEach(function(t){Object(k.n)(e,t)})}},Bt=function evaluateBotChatMessage(e){if(Object(w.f)(e,"offerSchedule")||Object(w.f)(e,"presentSchedule")){var t=e.attributes.offerSchedule;Object(k.j)(t),Object(ue.d)(fe.c.CALENDAR_DROP)}},Ut=n("SHZQ"),Dt=n("IpSJ"),Lt=n("BMKr"),Vt=function(){var e=Object(c.a)(r.a.mark(function _callee(e){var t,n,a;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return t=Object(v.a)([],["attributes","conditionSetsToEvaluate"],e),r.next=3,Object(Dt.a)(t);case 3:n=r.sent,a={requestingMessageId:e.id,conversationId:e.conversationId,targetingRequestPayload:n};try{Object(Ut.a)(a)}catch(c){Object(Lt.a)(new Error("Failed to evaluate conditional skill"))}case 6:case"end":return r.stop()}},_callee)}));return function evaluateConditionalMessage(t){return e.apply(this,arguments)}}(),Ft=function evaluateNewMessage(e){var t=Object(At.a)(["body","data"],e);if(Object(w.f)(t,"widgetGuid"))return Pt(t);var n=Object(w.f)(t,"startInteraction"),a=Object(w.f)(t,"liveViewInitiated"),r=Object(w.b)(t,"playbookId"),c=Object(w.b)(t,"interactionId"),o=t.conversationId,i=t.contentType===N.c.BOT_NODE_CONDITION_EVALUATION&&Object(w.f)(t,"conditionSetsToEvaluate"),u=Object(v.a)(!1,["contentType",N.c.CHAT],t)&&!t.body.length;return n&&(Object(k.q)(t),Object(wt.b)(t),Object(xt.a)(r,c,o)),a?function evaluateLiveViewMessage(e){var t=e.id,n=void 0===t?null:t,a=e.conversationId,r=void 0===a?null:a;if(r&&n){var c=Object(d.a)({},e.attributes,{senderId:e.authorId}),o=Object(d.a)({},e,{attributes:c});s.a.dispatch(Object(ce.a)()),s.a.dispatch(Object(ce.k)({conversationId:r})),s.a.dispatch(Object(ce.b)({message:o}))}}(t):i?Vt(t):Object(w.m)(t)?function evaluateChatMessage(e){var t=e.body.data;if(Nt.push(t),Object(k.l)(t),Object(w.f)(t,"isBot"))return Bt(t)}(e):u?Object(ne.f)(t.conversationId,[t.id]):void 0},$t={topic:"conversation",event:function event(e){e.conversation&&s.a.dispatch(Object(ce.e)({conversation:e.conversation}))}},Wt={topic:yt,event:function event(e){Object(wt.c)(e)}},Ht={topic:Et,event:function event(e){var t=Object.keys(e);s.a.dispatch(Object(i.d)(t))}},Jt={topic:It,event:function event(){Object(wt.f)()}},Gt={topic:St,event:function event(){Object(wt.g)()}},qt=[{topic:"data:sentMessage",event:function event(e){s.a.dispatch(Object(ce.g)(e))}}],zt=[{topic:"typing:started",event:function event(e){window.fallbackTimeout&&window.clearTimeout(window.fallbackTimeout),s.a.dispatch(Object(ce.m)({conversationId:e.conversationId,userId:e.userId,isTyping:!0})),window.fallbackTimeout=window.setTimeout(function(){s.a.dispatch(Object(ce.m)({conversationId:e.conversationId,userId:e.userId,isTyping:!1}))},5e3)}},{topic:"typing:finished",event:function event(e){s.a.dispatch(Object(ce.m)({conversationId:e.conversationId,isTyping:!1}))}},{topic:"change",event:function(){var e=Object(c.a)(r.a.mark(function _callee(e){return r.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:"CREATE"===e.body.type&&"MESSAGE"===e.body.object.type&&Ft(e);case 2:case"end":return t.stop()}},_callee)}));return function onUserChangeEvent(t){return e.apply(this,arguments)}}()},{topic:"event",event:function(){var e=Object(c.a)(r.a.mark(function _callee2(e){var t,n,a;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:t=e.body,n=t.type,a=t.data,n===Ct&&s.a.dispatch(Object(le.c)({email:a.email}));case 2:case"end":return r.stop()}},_callee2)}));return function onUserTriggeredEvent(t){return e.apply(this,arguments)}}()},$t,Ht,Gt,Jt,Wt],Kt=[],Qt=Object.freeze({CHAT:"chat",USER:"user",PRESENCE:"presence",VISITOR_PRESENCE:"visitor_presence"}),Yt=Object.freeze({CHAT:"chat",USER:"user",ORG_PUBLIC:"live",LIVE:"live"}),Zt=Object.freeze({CHAT:"chat",USER:"user",PRESENCE:"presence"}),Xt=function(){var e=Object(c.a)(r.a.mark(function _callee2(e){var t,n,a,o,s;return r.a.wrap(function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:return t=e.session_token,n=e.org_id,a=e.socketCluster,o=e.ip,s=new Promise(function(){var e=Object(c.a)(r.a.mark(function _callee(e,c){var s;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,mt({session_token:t,org_id:n,socketCluster:a,ip:o});case 2:if(!(s=r.sent)){r.next=7;break}return r.abrupt("return",e(s));case 7:return r.abrupt("return",c("could not connect"));case 8:case"end":return r.stop()}},_callee)}));return function(t,n){return e.apply(this,arguments)}}()),i.abrupt("return",s);case 3:case"end":return i.stop()}},_callee2)}));return function connectToSocket(t){return e.apply(this,arguments)}}(),en=function(){var e=Object(c.a)(r.a.mark(function _callee3(e){var t,n,a,c,o,s;return r.a.wrap(function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.socket,n=e.socketAuth,a=e.channelEvents,c=e.channelName,o=e.orgId,r.prev=1,r.next=4,_t({channelName:tn(c,n.user_id,o),socket:t,events:nn(a)});case 4:return s=r.sent,r.abrupt("return",s);case 8:r.prev=8,r.t0=r.catch(1),Object(Q.e)(new Error(r.t0));case 11:case"end":return r.stop()}},_callee3,null,[[1,8]])}));return function connectToChannel(t){return e.apply(this,arguments)}}(),tn=function _resolveChannelName(e,t,n){switch(e){case Yt.USER:case Yt.CHAT:return"".concat(e,":").concat(t);case Yt.LIVE:return"".concat(e,":").concat(n);default:return""}},nn=function _resolveChannelEvents(e){switch(e){case Zt.CHAT:return qt;case Zt.USER:return zt;case Zt.PRESENCE:return Kt;default:return[]}},an=6e4,rn=function(){function SocketManager(){Object(Oe.a)(this,SocketManager),this._fireChannelConnectedEvent=function(e,t,n){s.a.dispatch(Object(le.f)(Object(d.a)({key:e,cluster:t},n)))}}return Object(je.a)(SocketManager,[{key:"_fireSocketConnectedEvent",value:function _fireSocketConnectedEvent(e){s.a.dispatch(Object(le.r)({cluster:e}))}}]),SocketManager}(),cn=new(function(e){function ChatSocketManager(){var e;return Object(Oe.a)(this,ChatSocketManager),(e=Object(ut.a)(this,Object(lt.a)(ChatSocketManager).call(this)))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e._sendPresencePing=Object(c.a)(r.a.mark(function _callee(){var t,n;return r.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(e._channel){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,pt();case 4:t=a.sent,n=t.page,e._channel.channel.push("presence:send_update",{page:n});case 7:case"end":return a.stop()}},_callee)})),e.throttledPresencePing=Object(gt.throttle)(an,!1,e._sendPresencePing),e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(dt.a)(ChatSocketManager,e),Object(je.a)(ChatSocketManager,[{key:"connect",value:function(){var e=Object(c.a)(r.a.mark(function _callee2(e){var t,n,a,c=this;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.accessToken,n=e.orgId,Object(Ye.f)(n),r.next=4,Object(it.a)({fn:Ye.b,socketCluster:Qt.CHAT,token:t});case 4:return a=r.sent,r.next=7,Xt({ip:a.remote_ip,org_id:n,session_token:a.session_token,socketCluster:Qt.CHAT});case 7:return this._socket=r.sent,this._fireSocketConnectedEvent(Qt.CHAT),r.next=11,en({socket:this._socket,channelEvents:Zt.USER,channelName:Yt.USER,orgId:n,socketAuth:a});case 11:this._channel=r.sent,this._fireChannelConnectedEvent("user",Qt.CHAT,this._channel),this._channel&&(this._sendPresencePing(),this._channel.channel.on("presence:request_update",function(){c.throttledPresencePing()}));case 14:case"end":return r.stop()}},_callee2,this)}));return function connect(t){return e.apply(this,arguments)}}()},{key:"sendChatBootstrapEvent",value:function sendChatBootstrapEvent(e){var t=e.sessionId,n=e.accessToken,a=e.campaignIds;this._channel&&this._channel.channel.push("chat:bootstrap",{sessionId:t,accessToken:n,campaignIds:a})}}]),ChatSocketManager}(rn)),on=n("4+fu"),sn=(new(function(e){function UserSocketManager(){var e;return Object(Oe.a)(this,UserSocketManager),(e=Object(ut.a)(this,Object(lt.a)(UserSocketManager).call(this)))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e.sendMessage=function(t){e._pushMessageToChannel("request:sendMessage",t)},e._pushMessageToChannel=function(t,n){Object(v.a)(!1,["_channel","channel"],Object(on.a)(e))&&e._channel.channel.push(t,n)},e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(dt.a)(UserSocketManager,e),Object(je.a)(UserSocketManager,[{key:"connect",value:function(){var e=Object(c.a)(r.a.mark(function _callee(e){var t,n,a,c;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.orgId,n=e.accessToken,Object(Ye.g)(),r.next=4,Object(Ye.c)({access_token:n});case 4:return a=r.sent,c=a.data,r.next=8,Xt(Object(d.a)({},c,{socketCluster:Qt.USER,orgId:t,ip:c.remote_ip}));case 8:return this._socket=r.sent,this._fireSocketConnectedEvent(Qt.USER),r.next=12,en({socket:this._socket,channelEvents:Zt.CHAT,socketAuth:c,channelName:Yt.CHAT,orgId:t});case 12:this._channel=r.sent,this._fireChannelConnectedEvent("chat",Qt.USER,this._channel),this._pushMessageToChannel("data:conversations");case 15:case"end":return r.stop()}},_callee,this)}));return function connect(t){return e.apply(this,arguments)}}()}]),UserSocketManager}(rn)),new(function(e){function VisitorPresenceSocketManager(){var e;return Object(Oe.a)(this,VisitorPresenceSocketManager),(e=Object(ut.a)(this,Object(lt.a)(VisitorPresenceSocketManager).call(this)))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(dt.a)(VisitorPresenceSocketManager,e),Object(je.a)(VisitorPresenceSocketManager,[{key:"connect",value:function(){var e=Object(c.a)(r.a.mark(function _callee(e){var t,n,a;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.orgId,n=e.accessToken,Object(Ye.h)(),r.next=4,Object(it.a)({fn:Ye.d,socketCluster:Qt.VISITOR_PRESENCE,token:n});case 4:return a=r.sent,r.next=7,Xt({ip:a.remote_ip,org_id:t,session_token:a.session_token,socketCluster:Qt.VISITOR_PRESENCE});case 7:return this._socket=r.sent,this._fireSocketConnectedEvent(Qt.VISITOR_PRESENCE),r.next=11,en({socket:this._socket,channelEvents:Zt.PRESENCE,channelName:Yt.LIVE,orgId:t,socketAuth:a});case 11:this._channel=r.sent,this._fireChannelConnectedEvent("user",Qt.VISITOR_PRESENCE,this._channel),this._channel&&(this._updatePresence(),this.startPresenceUpdateHeartbeat());case 14:case"end":return r.stop()}},_callee,this)}));return function connect(t){return e.apply(this,arguments)}}()},{key:"startPresenceUpdateHeartbeat",value:function startPresenceUpdateHeartbeat(){this._heartbeatInterval=window.setInterval(this._updatePresence.bind(this),an)}},{key:"_updatePresence",value:function(){var e=Object(c.a)(r.a.mark(function _callee2(){var e;return r.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:if(this._channel){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,pt();case 4:e=t.sent,this._channel.channel.push("heartbeat",e);case 6:case"end":return t.stop()}},_callee2,this)}));return function _updatePresence(){return e.apply(this,arguments)}}()},{key:"stopPresenceUpdateHeartbeat",value:function stopPresenceUpdateHeartbeat(){window.clearInterval(this._heartbeatInterval)}}]),VisitorPresenceSocketManager}(rn))),un=n("OA1u"),ln=n("H/qh"),dn=n("TbSn"),bn=n("SWQ0"),pn=n("A5mO"),fn=n("wNJw"),hn=n("VpmR"),gn={isFromConversationalLandingPage:!1},vn=function(){var e=Object(c.a)(r.a.mark(function _callee(e){var t,n,a,c,o,i;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(t=Object(v.a)({},["embed","configuration"],s.a.getState()),n=t.interactionSlugMap,a=void 0===n?{}:n,c=t.interactionTestingSlugMap,o=void 0===c?{}:c,i=e?e.substring(1):null){r.next=4;break}return r.abrupt("return",!1);case 4:if(!o[i]){r.next=8;break}return r.next=7,On(e,o[i],Object(d.a)({},gn,{isTestingConversation:!0}));case 7:return r.abrupt("return",!0);case 8:if(!a[i]){r.next=12;break}return r.next=11,On(e,a[i],gn);case 11:return r.abrupt("return",!0);case 12:return r.abrupt("return",!1);case 13:case"end":return r.stop()}},_callee)}));return function fireByDriftlink(t){return e.apply(this,arguments)}}(),On=function(){var e=Object(c.a)(r.a.mark(function _callee2(e,t,n){return r.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s.a.dispatch(Object(ce.l)(e)),a.next=4,Object(ne.a)(t,n);case 4:a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),Object(Q.k)({data:["Failed to activate drift link ".concat(e,":").concat(t),a.t0]});case 9:case"end":return a.stop()}},_callee2,null,[[0,6]])}));return function activateDriftLink(t,n,a){return e.apply(this,arguments)}}(),jn=n("HSQL"),mn=P.a.get,_n=P.a.set;function Bootstrap(e){var t=e.embedId,n=e.params;return this.dispatch=s.a.dispatch,this.state=s.a.getState,this.embedId=t,this.params=n,this}Bootstrap.prototype.dataProtection=Object(c.a)(r.a.mark(function _callee(){var e,t,n,a,c,o,s,i,u,l;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(e=this.state(),t=e.embed,n=e.session,a=n.gdpr,c=n.geo,o=c.country,s=t.configuration.dataProtection,i=function resolveNeedsConsent(e){return"ALL"===e||!("NONE"===e||!e)&&(!o||Object(ln.a)(o,rt[e]))},s){r.next=7;break}return r.abrupt("return",this.dispatch(Object(le.n)({needsConsent:!1,hasConsent:!0})));case 7:u=i(s.targeting),l=!u||a.hasConsent,this.dispatch(Object(le.n)({needsConsent:u,hasConsent:l}));case 10:case"end":return r.stop()}},_callee,this)})),Bootstrap.prototype.handleDriftLinks=Object(c.a)(r.a.mark(function _callee2(){var e;return r.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.params.skipCampaigns,t.t0=!e,!t.t0){t.next=5;break}return t.next=5,this.hasDriftLinkFire();case 5:case"end":return t.stop()}},_callee2,this)})),Bootstrap.prototype.hydrateContext=Object(c.a)(r.a.mark(function _callee3(){var e;return r.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ge.b)();case 2:return e=t.sent,this.dispatch(Object(le.h)(e)),t.abrupt("return",e);case 5:case"end":return t.stop()}},_callee3,this)})),Bootstrap.prototype.sendPageTrackEvent=function(e){Object(ae.a)("Page",e.page)},Bootstrap.prototype.countVisit=Object(c.a)(r.a.mark(function _callee4(){var e,t,n,a,c,o,s;return r.a.wrap(function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(u.a)({topic:"access-host-window",message:{key:"location"}});case 2:return e=r.sent,t=e.data,n=void 0===t?{}:t,r.next=7,mn("visitCounts");case 7:a=r.sent,c=a.data,o=c||{},s=Object(st.a)(o,function(e){e.total=(e.total||0)+1,e.daysSinceLastVisit=pn.a.now().since(e.lastVisit||pn.a.now()).diff.days,e.lastVisit=pn.a.now().epoch,e.firstVisit=e.firstVisit||pn.a.now().epoch,e[n.pathname]=(e[n.pathname]||0)+1}),_n("visitCounts",s);case 12:case"end":return r.stop()}},_callee4)})),Bootstrap.prototype.fetchPreRequisiteData=Object(c.a)(r.a.mark(function _callee7(){var e,t,n,a,o,i,u,l,d=this;return r.a.wrap(function _callee7$(b){for(;;)switch(b.prev=b.next){case 0:return e={},this.dispatch(Object(le.q)({session:this.params.session})),b.prev=2,b.next=5,Xe(this.embedId);case 5:t=b.sent,n=t.data,a=t.responseTime,o=void 0===a?0:a,e=n,this.dispatch(se(e)),Object(_e.d)("Bootstrap.embed_fetch",o),b.next=17;break;case 14:b.prev=14,b.t0=b.catch(2),Object(Q.e)(new ot.a("Embed Failed to load correctly - ".concat(b.t0.message)),b.t0);case 17:try{(i=Object(ve.f)(Object(v.a)(null,["configuration","theme","cookieDomains"],e)))&&s.a.dispatch(Object(le.i)({cookieDomain:i}))}catch(p){Object(Q.e)(new ot.a("Failed to set custom cookie domain - ".concat(p.message)),p)}if(u=function(){var t=Object(c.a)(r.a.mark(function _callee5(){var t;return r.a.wrap(function _callee5$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=Object(v.a)("en",["configuration","locale"],e),n.next=4,Object(hn.a)(t);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),Object(Q.k)({data:["i18n failed to load - ".concat(n.t0.message),n.t0],type:"warn"});case 9:case"end":return n.stop()}},_callee5,null,[[0,6]])}));return function setupI18n(){return t.apply(this,arguments)}}(),!Object(v.a)(!1,["configuration","gates","use_widget_bootstrap"],e)){b.next=24;break}return b.next=23,u();case 23:return b.abrupt("return");case 24:return l=function(){var e=Object(c.a)(r.a.mark(function _callee6(){var e,t,n;return r.a.wrap(function _callee6$(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(et.a)();case 3:e=a.sent,t=e.data,n=e.responseTime,d.dispatch(Object(le.o)(t)),Object(_e.d)("Bootstrap.geo_fetch",n),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),Object(Q.k)({data:["Geo Failed to load - ".concat(a.t0.message),a.t0]});case 13:case"end":return a.stop()}},_callee6,null,[[0,10]])}));return function setupGeo(){return e.apply(this,arguments)}}(),b.next=27,Promise.all([l(),u()]);case 27:case"end":return b.stop()}},_callee7,this,[[2,14]])})),Bootstrap.prototype.handleAuthentication=Object(c.a)(r.a.mark(function _callee9(){var e,t,n,a;return r.a.wrap(function _callee9$(o){for(;;)switch(o.prev=o.next){case 0:return e=this.state().embed.orgId,t=null,o.prev=2,o.next=5,Object(jn.c)(Object(c.a)(r.a.mark(function _callee8(){return r.a.wrap(function _callee8$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ie.a)({orgId:e});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},_callee8)})),"widget_core:identity");case 5:n=o.sent,a=n.result,t=a,o.next=13;break;case 10:o.prev=10,o.t0=o.catch(2),Object(Q.e)(new ot.a("Failed to authenticate end user"),o.t0);case 13:if(t){o.next=15;break}return o.abrupt("return");case 15:return this.dispatch(Object(le.j)({endUser:t.endUser})),this.dispatch(Object(le.e)(t)),this.dispatch(Object(le.n)({hasConsent:t.didConsentToRequestedConsentId||!1})),o.next=20,this.handleSockets({orgId:e,accessToken:t.accessToken});case 20:case"end":return o.stop()}},_callee9,this,[[2,10]])})),Bootstrap.prototype.handleBootstrap=Object(c.a)(r.a.mark(function _callee11(){var e,t,n,a,o,s,i,u,l,d,p,f,h,g,O,j,m,_,k,w=this;return r.a.wrap(function _callee11$(C){for(;;)switch(C.prev=C.next){case 0:return e=this.state(),t=e.conversations,n=e.embed,a=e.session,o=t.conversations,s=Object(v.a)("",["context","page","url"],a),i=a.id,u=n.orgId,l=null,C.prev=6,C.next=9,Object(ie.b)();case 9:return d=C.sent,C.next=12,Object(jn.c)(Object(c.a)(r.a.mark(function _callee10(){return r.a.wrap(function _callee10$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yn({orgId:u,embedId:w.embedId,sessionId:i,identifierMap:d,pageUrl:s});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},_callee10)})),"widget_core:bootstrap_api");case 12:p=C.sent,f=p.result,l=f.tokenResult,h=f.chatAuth||null,g=f.presenceAuth||null,this.dispatch(Object(le.o)(f.location)),h&&this.dispatch(Object(le.g)(h)),g&&this.dispatch(Object(le.p)(g)),Object(be.a)({evaluatedConditionsResults:f.evaluatedConditionsResults,onDidNotMatch:function onDidNotMatch(){Object(A.a)(o)||w.dispatch(Object(ce.f)({conversation:Object(dn.a)(Object(T.a)(o))}))}}),C.next=26;break;case 23:C.prev=23,C.t0=C.catch(6),Object(Q.e)(new ot.a("Failed Bootstrap API response - ".concat(C.t0.message)),C.t0);case 26:if(l){C.next=28;break}return C.abrupt("return");case 28:return j=(O=l).accessToken,m=O.didConsentToRequestedConsentId,_=O.assignedAgentId,k=Object(b.a)(["didConsentToRequestedConsentId","accessToken","assignedAgentId"],l),this.dispatch(Object(le.j)({endUser:k,assignedAgentId:_})),this.dispatch(Object(le.e)({accessToken:j})),this.dispatch(Object(le.n)({hasConsent:m||!1})),C.next=35,this.handleSockets({orgId:u,accessToken:j});case 35:case"end":return C.stop()}},_callee11,this,[[6,23]])})),Bootstrap.prototype.handleSockets=function(){var e=Object(c.a)(r.a.mark(function _callee12(e){var t,n;return r.a.wrap(function _callee12$(a){for(;;)switch(a.prev=a.next){case 0:return t=e.orgId,n=e.accessToken,a.next=3,Object(jn.c)(function(){return cn.connect({accessToken:n,orgId:t})},"widget_core.sockets:chat_connect");case 3:case"end":return a.stop()}},_callee12)}));return function(t){return e.apply(this,arguments)}}(),Bootstrap.prototype.hasDriftLinkFire=Object(c.a)(r.a.mark(function _callee13(){var e,t,n,a,c;return r.a.wrap(function _callee13$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(u.a)({topic:"get-host-window"});case 2:return e=r.sent,t=e.data,n=void 0===t?{}:t,a=Object(v.a)("",["location","hash"],n),c=vn(a),r.abrupt("return",!c);case 8:case"end":return r.stop()}},_callee13)})),Bootstrap.prototype.sendChatBootstrapEvent=Object(c.a)(r.a.mark(function _callee14(){var e,t,n,a;return r.a.wrap(function _callee14$(r){for(;;)switch(r.prev=r.next){case 0:if(e=Object(v.a)(null,["params","session","sessionId"],this)){r.next=3;break}return r.abrupt("return");case 3:t=this.state().embed.configuration,n=this.state().session.auth.accessToken,a=t.campaigns.map(function(e){return e.id}),cn.sendChatBootstrapEvent({sessionId:e,accessToken:n,campaignIds:a});case 7:case"end":return r.stop()}},_callee14,this)})),Bootstrap.prototype.connectToPresence=function(){var e=this.state().session.auth.accessToken,t=this.state().embed.orgId;t&&e&&Object(jn.c)(function(){return sn.connect({accessToken:e,orgId:t})},"widget_core.sockets:visitor_presence_connect")},Bootstrap.prototype.attachIntegrations=Object(c.a)(r.a.mark(function _callee15(){var e,t,n;return r.a.wrap(function _callee15$(a){for(;;)switch(a.prev=a.next){case 0:e=this.state().embed.configuration,t=(void 0===e?{}:e).integrations,n=void 0===t?{}:t,Object.keys(n).forEach(function(e){ct[e]&&Object(u.a)({topic:"handle-host-integration",message:{config:n[e],type:e}})});case 3:case"end":return a.stop()}},_callee15,this)})),Bootstrap.prototype.waitForUserJwt=function(){var e=Object(Q.h)(function(){console.warn("Drift Widget is still waiting for user JWT!")},3e4);return new Promise(function(t){var n=s.a.subscribe(Object(c.a)(r.a.mark(function _callee16(){return r.a.wrap(function _callee16$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(it.d)();case 2:if(!a.sent){a.next=4;break}return a.abrupt("return");case 4:e(),n(),t();case 7:case"end":return a.stop()}},_callee16)})))})};var kn=function(){var e=Object(c.a)(r.a.mark(function _callee18(e){var t,n,a,o,s,i,u,l,d;return r.a.wrap(function _callee18$(b){for(;;)switch(b.prev=b.next){case 0:return t=new Bootstrap(e),n=Object(v.a)(!1,["params","skipCampaigns"],e),a=Object(v.a)(!1,["params","forceShow"],e),o=Object(v.a)(null,["params","session","sessionId"],e),s=Object(v.a)(null,["params","session","instanceId"],e),t.dispatch(Object(un.b)(n)),t.dispatch(Object(un.a)(a)),i=function(){var e=Object(c.a)(r.a.mark(function _callee17(){return r.a.wrap(function _callee17$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(jn.c)(function(){return t.fetchPreRequisiteData()},"bootstrap: embed/geo");case 3:return e.next=5,Object(it.d)();case 5:if(!e.sent){e.next=8;break}return e.next=8,Object(jn.c)(function(){return t.waitForUserJwt()},"bootstrap: waitForUserJwt");case 8:if(!Object(he.b)()){e.next=13;break}return e.next=11,Object(jn.c)(function(){return t.handleBootstrap()},"bootstrap: bootstrap");case 11:e.next=15;break;case 13:return e.next=15,Object(jn.c)(function(){return t.handleAuthentication()},"bootstrap: endUserAuth");case 15:return e.next=17,Object(jn.c)(function(){return t.dataProtection()},"bootstrap: GDPR");case 17:return wn(),e.next=20,t.handleDriftLinks();case 20:t.sendChatBootstrapEvent(),t.dispatch(Object(x.c)({initComplete:!0})),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),Object(_e.a)("bootstrap.failure"),Object(Q.e)("Failed to bootstrap - ".concat(e.t0.message),e.t0);case 28:case"end":return e.stop()}},_callee17,null,[[0,24]])}));return function measuredInit(){return e.apply(this,arguments)}}(),b.prev=8,b.next=11,t.countVisit();case 11:return b.next=13,t.hydrateContext();case 13:return u=b.sent,o&&Cn(e.embedId,o,s,u),b.next=17,Object(jn.c)(i,"bootstrap");case 17:l=b.sent,d=l.timing,Object(_e.d)("bootstrap",d),t.sendPageTrackEvent(u),t.attachIntegrations(),t.connectToPresence(),Promise.resolve("bootstrap complete"),b.next=30;break;case 26:b.prev=26,b.t0=b.catch(8),Object(Q.e)(new Error(b.t0)),Promise.reject("bootstrap failed");case 30:case"end":return b.stop()}},_callee18,null,[[8,26]])}));return function init(t){return e.apply(this,arguments)}}(),wn=function(){var e=Object(c.a)(r.a.mark(function _callee19(){var e;return r.a.wrap(function _callee19$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ge();case 2:e=t.sent,Object(fn.a)(bn.b.READY,e);case 4:case"end":return t.stop()}},_callee19)}));return function fireWidgetReadyEvent(){return e.apply(this,arguments)}}(),Cn=function fireWidgetInitEvent(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r={eventName:"[V2] - init",embedId:e,sessionId:t,instanceId:n,context:{url:Object(At.a)(["page","url"],a),hostname:Object(At.a)(["page","hostname"],a),timezone:a.timezone,userAgent:a.userAgent}};Object(tt.c)(r).catch(function(e){Object(Q.k)({type:"warn",data:["Failed to send init event"]})})},yn=function(){var e=Object(c.a)(r.a.mark(function _callee20(e){var t,n,a,c,o,s,i,u,l,b;return r.a.wrap(function _callee20$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.orgId,n=e.embedId,a=e.sessionId,c=e.identifierMap,o=e.pageUrl,s={sessionId:a,pageUrl:o,hasHadConversations:!1,followingCampaignIds:[]},i=Object(d.a)({},c,{embed_id:n,targeting_context:s}),r.next=5,Ze(t,i);case 5:return u=r.sent,l=u.data,b=u.responseTime,Object(_e.d)("enduser_bootstrap",b),r.abrupt("return",l);case 10:case"end":return r.stop()}},_callee20)}));return function callBootstrapApi(t){return e.apply(this,arguments)}}(),En=n("JBtm"),In=n.n(En),Sn=n("uiOv"),xn=n("EQxi");n("z8n0");s.a.name="controller";t.default=Object(Sn.a)(function WidgetControllerPage(e){var t=e.location,n=Object(O.useState)(!1),a=Object(o.a)(n,2),i=a[0],d=a[1],b=Object(xn.d)(In.a.parse(t.search)),h=Object(Q.n)();return Object(O.useEffect)(function(){if(i){var e=Object(jn.b)("widget_core:widget_loaded");e&&(Object(_e.d)("loaded",e),Object(_e.a)("widget.v2.load",!1));var t=s.a.getState().embed,n=void 0===t?{}:t;return Object(Z.a)(n),void Object(Z.b)(n)}Object(f.a)({name:"controller",syncWith:"chat",store:s.a}),p(),l(),Object(u.c)({topic:"trigger-api-event",handler:Ke}),Object(u.c)({topic:"get-ready-payload",handler:Ge}),Object(u.c)({topic:"identity-provided-email",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;s.a.dispatch(Object(le.k)(n.email))}}),Object(u.c)({topic:"hide-widget-on-ready",handler:function handler(e){e.data,s.a.dispatch(Object(un.c)(!0))}}),Object(u.c)({topic:"show-widget-on-ready",handler:function handler(e){e.data,s.a.dispatch(Object(un.a)(!0))}}),Object(u.c)({topic:"identity-provided-id",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;s.a.dispatch(Object(le.l)(n.externalId))}}),Object(u.c)({topic:"identity-provided-jwt",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;s.a.dispatch(Object(le.m)(n.userJwt))}}),Object(u.c)({topic:"host-hash-change",handler:function handler(e){var t=e.data;return vn(t.hash)}}),Object(u.c)({topic:"init-ready",handler:function(){var e=Object(c.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=!i,!e.t0){e.next=5;break}return e.next=5,kn({embedId:b.embedId,params:{skipCampaigns:b.skipCampaigns,forceShow:b.forceShow,session:{sessionId:b.sessionId,sessionStarted:b.sessionStarted,campaignRefreshToken:b.campaignRefreshToken,instanceId:h}}});case 5:d(!0),e.next=11;break;case 8:e.prev=8,e.t1=e.catch(0),console.warn(e.t1);case 11:case"end":return e.stop()}},_callee,null,[[0,8]])}));return function handler(){return e.apply(this,arguments)}}()}),Object(fn.a)(bn.b.API_READY)},[b.embedId,b.forceShow,b.skipCampaigns,i,b.sessionId,b.sessionStarted,b.campaignRefreshToken,h]),j.a.createElement(R.a,{store:s.a},i&&j.a.createElement(ee,null))})},My8U:function(e,t,n){"use strict";var a=n("+vh4"),r=n("SWQ0"),c=n("wNJw"),o=n("7oto");t.a=function UseStoreSync(e){var t=e.store,n=e.syncWith,s=e.name;return Object(o.c)({topic:"CONDUCTOR:action-from-".concat(n),handler:function handler(e){t.dispatch(Object(a.a)({},e.data.action,{_foreignDispatch:!0}))}}),Object(c.a)(r.a["".concat(s.toUpperCase(),"_READY")]),t}},NJR1:function(e,t,n){},OE2q:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"b",function(){return b}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return f});var a=n("+vh4"),r=n("efbE"),c=n("SFoa"),o=n("+oIK"),s=n("t8ds").a.sadd,i=function getConversationById(e){return r.e.get("/conversations/end_users/widget/conversation_context/".concat(e))},u=function markConversationAsRead(e,t){var n=!0,a=!1,c=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var u=o.value;s("messagesSeen",u)}}catch(l){a=!0,c=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r.e.post("/messages/read-bulk",{messageIds:t,conversationId:e})},l=function sendConversationEvent(e){return r.o.post("/conversations/".concat(e.conversationId,"/messages"),{type:"CONVERSATION_EVENT",conversationEvent:e})},d=function createBotConversation(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(c.a)(e),o=Object(c.b)(n,"inboxId"),s={body:"",attributes:Object(a.a)({withGreeting:!0,startInteraction:e,interactionId:e},t,{widgetVersion:2}),status:"BULK_SENT"};return o&&(s.inboxId=o),r.o.post("/messages",s)},b=function createNewConversation(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.o.post("/messages",{body:e,attributes:Object(a.a)({},t,{widgetVersion:2})})},p=function fetchAgentStatus(e){return r.e.get("/agents/".concat(e,"/status"))},f=function createNewConversationWithMeeting(e,t,n){var a={body:"",attributes:{scheduleMeetingFlow:!0,scheduleMeetingWith:t,widgetApiTriggered:!0,isTriggeredFromAPI:!0,widgetVersion:2},status:"BULK_SENT"};if(e&&(a.attributes.endUserEmail=e),n&&n.campaignMessage){var c=n.campaignMessage;a.attributes.relatedCampaignId=c.attributes.campaignId,a.preMessages=Object(o.b)(c)}var s=Object(o.a)(a);return r.o.post("/messages",s)}},"ab+K":function(e,t,n){"use strict";var a=n("/UYI"),r=n("nQD+"),c=n("ERkP"),o=n.n(c);n("NJR1");t.a=function MessageCloseButton(e){var t=e.onClick;return o.a.createElement(r.a,{onClick:t,className:"drift-widget-message-close-button","aria-label":"close"},o.a.createElement(a.a,{width:8,height:8}))}},jKoD:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c});var a=n("efbE"),r=function getGeo(){return a.f.get("/geo/v2")},c=function recordConsent(e,t){return a.f.post("/end_users/".concat(e,"/consent"),{consentId:"has_consent",message:t})}},lE29:function(e,t,n){"use strict";var a=n("+vh4"),r=n("rAc1"),c=n("l6A5"),o=n("uDfI"),s={textColor:"353f45",backgroundColor:"0071EB",foregroundColor:"ffffff",widgetBackgroundColor:"0071EB",activeColor:"blue"},i=function resolveBackgroundStyles(e){return{background:"#".concat(e.backgroundColor),color:"#".concat(e.textColor)}},u=function resolveSvgStyles(e){return{fill:"#".concat(e.textColor)}},l=function resolveBorderStyles(e){return{borderColor:"#".concat(e.backgroundColor)}},d=function resolveTextColorStyles(e){return{color:"#".concat(e.foregroundColor)}},b=function resolveInlineImageStyles(e){return{background:"#".concat(e.foregroundColor),border:"4px solid #".concat(e.foregroundColor)}},p=function resolveHeaderTextStyles(e){return{color:"#".concat(e.foregroundColor)}},f=function resolveInlineFileStyles(e){return{color:"#".concat(e.foregroundColor)}},h=function resolveButtonStyles(e){return{color:"#".concat(e.backgroundColor),borderColor:"#".concat(e.backgroundColor),backgroundColor:"#".concat(e.foregroundColor)}},g=function resolveForegroundColors(e){return{backgroundColor:"#".concat(e.backgroundColor),color:"#".concat(e.foregroundColor),border:"1px solid #".concat(e.backgroundColor)}},v=function resolvePrimaryTextColor(e){return{color:"#".concat(e.backgroundColor)}},O=function resolveWidgetBackgroundStyles(e){return{background:"#".concat(e.widgetBackgroundColor)}},j=function resolveWidgetAlphaBackground(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".8";return{background:function convertHex(e){var n=parseInt(e.substring(0,2),16),a=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return"rgba(".concat(n,", ").concat(a,", ").concat(r,", ").concat(t,")")}(e.widgetBackgroundColor)}},m=Object(c.a)(function memoIdentity(e){return Object(r.a)(e)},function(e){var t=Object(a.a)({},s,e);return{backgroundStyles:i(t),borderStyles:l(t),svgStyles:u(t),textColorStyles:d(t),buttonStyles:h(t),foregroundStyles:g(t),inlineImageStyles:b(t),widgetBackgroundStyles:O(t),conversationHeaderTextStyles:p(t),inlineFileStyles:f(t),activeColor:t.activeColor,widgetSecondaryColor:"#".concat(t.foregroundColor),widgetBackgroundColor:t.widgetBackgroundColor,widgetBackgroundAlpha:j(t),primaryTextColor:v(t)}});t.a=function useThemeColors(){var e=Object(o.c)(function(e){return e.embed.configuration.theme});return m(e)}},o3t1:function(e,t,n){"use strict";var a=n("s8DI"),r=n("ERkP"),c=n("0lfv"),o=n("6wvX");t.a=function useOnHover(){var e=Object(o.a)(),t=Object(r.useState)(!1),n=Object(a.a)(t,2),s=n[0],i=n[1];return Object(r.useMemo)(function(){return e?{}:{hoverProps:{onMouseOver:function onMouseOver(){return i(!0)},onMouseOut:function onMouseOut(){return i(!1)},onFocus:c.l,onBlur:c.l},isHovered:s}},[e,s])}},pUpc:function(e,t,n){},rAhV:function(e,t,n){"use strict";var a=n("OE2q"),r=n("K7i0"),c=n("uDfI"),o=n("0lfv");t.a=function useMarkAsRead(){var e=Object(c.c)(function(e){return e.conversations}).unreadAgentMessages,t=void 0===e?{}:e,n=Object(c.b)();return{markAsRead:function markAsRead(e){var c=t[e]||[];if(c.length)try{Object(a.f)(e,c),n(Object(r.i)({conversationId:e}))}catch(s){Object(o.e)(new Error(s))}}}}},tLIi:function(e,t,n){"use strict";var a=n("LVcX"),r=n("i9gz"),c=n("TbSn"),o=n("uDfI");t.a=function useLastAgentMessage(){var e=Object(o.c)(function(e){return e.conversations}).activeConversation,t=Object(o.c)(function(t){return Object(a.a)(null,["conversations","conversations",e,"lastAgentMessage"],t)}),n=Object(o.c)(function(t){var n=Object(a.a)({},["conversations","messages",e],t);if(Object(r.a)(n))return{};var o=Object.values(n).filter(function(e){return"USER"===Object(a.a)(null,["authorType"],e)});return o.length?Object(c.a)(o):void 0});return t||n||{}}},z8n0:function(e,t,n){}}]);