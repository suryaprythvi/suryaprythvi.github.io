(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+GZi":function(e,t,a){},"+oIK":function(e,t,a){"use strict";a.d(t,"a",function(){return f}),a.d(t,"b",function(){return g});var n=a("+vh4"),r=a("LeJ0"),i=a("QtlZ"),c=a("LVcX"),o=a("hm8b"),s=a("i9gz"),l=a("MFhO"),u=a("PjZB"),d=a("0lfv"),m={widgetVersion:2,widgetRelease:"LOCAL"!==r.a.ENV?"___RELEASE_ID":"local"},f=function createMessage(e){var t=e.message,a=void 0===t?"":t,r=e.activeConversation,f=e.attributes,g=void 0===f?{}:f,b=e.isMetaMessage,p=void 0!==b&&b,j=e.authorId,O=e.attachments,h=void 0===O?[]:O,A=e.preMessages,E=void 0===A?[]:A,y=e.inboxId,w=e.type,k=void 0===w?u.e.CHAT:w,C=e.contentType,M=void 0===C?u.c.CHAT:C,N=i.a.getState(),S=Object(c.a)({context:{}},["session"],N),T=Object(c.a)(u.b.LEAD,["session","endUser","type"],N),I=Object(c.a)(null,["campaigns","activeCampaign"],N),_=Object(c.a)({},["embed","configuration"],N),P=_.autoAssigneeId,R=_.profileMode,x=void 0!==R&&R,z=v(y),D=Object(o.a)(E)||Object(s.a)(E)?function _applyPremessagesForMessage(e,t){var a=Object(c.a)({},["embed","configuration"],i.a.getState()),n=a.autoAssigneeId,r=a.profileMode,o=void 0!==r&&r,s=a.team,u=a.theme,d=void 0===u?{}:u,m=Object(c.a)(null,["attributes","campaignDisplayType"],t)===l.a.WELCOME_MESSAGE,f=Object(c.a)("",["attributes","message"],t),g=Object(c.a)(null,["attributes","senderId"],t),b=[];return e?b:(o&&n&&b.push({body:d.welcomeMessage,sender:s.find(function(e){return e.id===n})}),m&&b.push({body:f,sender:s.find(function(e){return e.id===g})}),b)}(r,I):E;return{attachments:h,conversationId:r,body:a,type:k,contentType:M,authorId:j,authorType:T,inboxId:z,attributes:Object(n.a)({},g,{widgetGuid:Object(d.n)(),isMetaMessage:p,generatedAt:Date.now().valueOf(),autoAssigneeId:P,profileMode:x,preMessages:D},m),context:{userAgent:S.context.userAgent,timezone:S.context.timezone,locale:S.context.locale,page:S.context.page}}},g=function createPreMessagesForCampaign(e){var t=e.body,a=e.attributes,n=(a=void 0===a?{}:a).title,r=void 0===n?null:n,i=a.senderId,c=void 0===i?null:i,o=a.noSenderId,s=void 0!==o&&o,u=a.automaticSender,m=void 0!==u&&u,f=a.campaignDisplayType,g=(void 0===f?null:f)===l.a.WELCOME_MESSAGE,v=b(c,s,m),p=[];return r&&!g&&p.push({id:Object(d.n)(),body:r,sender:v}),t&&p.push({id:Object(d.n)(),body:t,sender:v}),p},b=function getSender(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t)return null;var n=Object(c.a)({},["embed","configuration"],i.a.getState()),r=n.autoAssigneeId,o=n.team;return a&&r?o.find(function(e){return e.id===r}):o.find(function(t){return t.id===e})},v=function resolveInboxIdForMessage(e){var t=i.a.getState(),a=Object(c.a)({},["embed","configuration"],t).inboxId;if(!Object(o.a)(e))return e;var n=Object(c.a)(null,["conversations","activeConversation"],t),r=Object(c.a)(null,["conversations","conversations",n,"conversation"],t);return Object(o.a)(r)?a:r.inboxId}},"2VrW":function(e,t,a){},"2uLe":function(e,t,a){"use strict";var n=a("mj2O"),r=a.n(n),i=a("7SM1"),c=a("8ZCy"),o=a("8Epr"),s=a("ERkP"),l=a("uDfI"),u=a("7oto");t.a=function useSetPreviewHeight(){var e=Object(s.useRef)(null),t=Object(l.c)(function(e){return!!e.conversations.activeConversation}),a=Object(l.c)(function(e){return e.embed.configuration}).showBranding,n=void 0!==a&&a,d=Object(o.a)().noPolicy,m=Object(l.c)(function(e){return e.session.gdpr}).hasConsent,f=Object(s.useCallback)(function(){var e=0,t=!n&&d;return t&&(e+=c.a),m||(e+=t?c.c:c.b),e},[m,d,n]),g=Object(s.useCallback)(function(){return e.current?e.current.clientHeight:200},[e]),b=Object(s.useCallback)(function(){var e=Object(i.a)(r.a.mark(function _callee(e){var a,n,i,o,s=arguments;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(a=s.length>1&&void 0!==s[1]&&s[1],!t||!m){r.next=3;break}return r.abrupt("return");case 3:n=f(),i=g(),o=e?"".concat(i+c.e-n,"px"):"0px",Object(u.a)({topic:"set-frame-height",message:{height:o,name:"chat",transition:!0,transitionHeight:a}});case 7:case"end":return r.stop()}},_callee)}));return function(t){return e.apply(this,arguments)}}(),[t,m,f,g]),v=Object(s.useCallback)(Object(i.a)(r.a.mark(function _callee2(){var e;return r.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:e=g(),Object(u.a)({topic:"set-frame-height",message:{height:"".concat(e+c.f,"px"),name:"slider",transition:!0,transitionHeight:!1}});case 2:case"end":return t.stop()}},_callee2)})),[g]);return{previewRef:e,setChatHeight:b,setSliderHeight:v}}},"6wvX":function(e,t,a){"use strict";var n=a("uDfI"),r=a("0lfv");t.a=function useIsMobile(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(n.c)(function(t){return Object(r.i)(t.session.context.userAgent,e)})}},"8Epr":function(e,t,a){"use strict";var n=a("LVcX"),r=a("uDfI"),i=a("Nlet");t.a=function useResolvePrivacy(){var e=Object(r.c)(function(e){return Object(n.a)({},["embed","configuration","dataProtection"])(e)}),t=Object(i.c)().locale,a=function resolvePolicy(){if(!e.policies)return{};var a=e.default||"en",r=t||a,i=e.policies[r]||{};return Object(n.a)(i,r)(e.policies)}(),c=a.privacyPolicyLink,o=a.privacyPolicyLinkText,s=a.privacyPolicyAlwaysOn;return{privacyPolicyLink:c,privacyPolicyLinkText:o,noPolicy:!c||!o||!(void 0!==s&&s)}}},"97O6":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAAWCAYAAACFbNPBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABa9JREFUeNrsWy1z40gQla8EDAwEDAQCDAIMAgwCDA0XBgYGBu5PyM84aLgw8KDBAoMDBgsEAgQEBAQEBARclZ2uepPrne2WRrbls7PqKpWc0UxPz0y//pIyen9/Dwa6LhqNRjNzmwmPcnOl5kzrYZdOQ+GwBVcDirG5LXGNG7rWpu/O3DcuUEz7ytxW7gDT76WtjzYXAdJcW8MjFWR+EoBMAF4ra3wRmmkdG/Psq/kdac8Vfg/mtpAMiRnzt88C/xpU7yrAEZvbMxR33NLdAukZ4/okmmturicz1yNA3Be9Ku0rM2+keNlFR14DQK4UHE+K9Wwi6v94RlHnfc4HD5Uojx8826zHyQeAfJ6w6tHDa2jhz7czizwzMi969iK1Mu/cCRMjJbTa9JKDSG7M0N5MWDn9iOeUHWpl+hTs2UQZF6HvnrVNIGMFfpq8ltdEUhQeiyvr+FgLm1Pl0WVvWtb8sT6+bkZL5aBJli1ZVLKGmN+GFDM8X3exlB6UCh4qUmTe9eRFKL96VTzVF/MshZ6sjg2tDknSF4pyECoTduALl69pr3CYpDB3aP7OnhOgqP3NXBkbeocFU9/bhjBj1yJjwpRFs3Al+IjzGB6Z4fHWdW+wJlpHaP7eWqBBqRdQ5n8VvksFHL8ov/ltZd8ZvkskwvmJlXMteLdnYa96zXtI1wCEmQDYZSBX9zqHVodWsSocuCVSphiKUDNFIcAU4B9D6DkUocCYqfUs8Dh2czN2AHQVZF3N3y4YXLms98hx2fXRvHMzvmBWmvf5sPgK6EiGG7pIhgaQuDxv2XoSgGTO+N7avZK8B5JMKbT6p+mgzbPtOWIpWPNdh4rXqUOtZ2F/NFnSrqHVoQDZw1rZQ3wDKCLwCq3bZ0qXQtljeIoMijMFWDhAJtQXVta2Fc7BlIq15uEQlzEDQCfwEr/1URSAP6cw5h4gyZRwy503tyAgQ0AApTUh6R5DnqxBDs0SJk6s3aagaln1RFWsQ/KUlyPBWRoepPBfPHOx10PnOvY9CB8/gfC5Yl1JMSZQlg8AADQhlDdCuwXR3uUHyypVODSaCB4iEviULaDJ4AHGSqIYO7lIBABUTLGXAE0Y/PcOoQvll/ISsKGMehb5yFMiMZ+1dN20GcNTAmTMFCtk8WbeUoasBcDMAI4pU6B7KFoBxc49LWuqKKpNgksnQZYSzJR5GNF7dtiniAExpBAKYaINtYh+KIl50GEfzwkIX6ufnDnU+triPY8KOTsDxFHQGiEVxaN7mzsIVi5ylCwHHwuQCjwKgO5GCq9gOXxjSQuOTLDUaYvXkWjqYd1TVqy4gww3dn54z0AArC/FweXT9lwTsVBrderQ6lCA0MFqJbwCSnSLqpEFTMhAVbAEr2IHnrHnFiA1S+K7hiEpqxJFx26S4XUDuWpPd73HAR3zZrlWPHjMwk4C3sYzUT2LRfeoFNVKZBB4hEsSSDbIxX6rbB4TWp0qB+GC2no8KdK9+V2Cv03g3Y/obEzPgWPzk7HkPaCsUtz7pliXBHMsqOLCQppYeHdR8QoVm8d6Ihr7o8m6C6Fd0BK2NSbXSjslpmuWe6XO/vwfAClRXUs8Ddj6yDDubOFo2HETqhaQJCwBj9m4TPAGBZ6VTiyeYbxrZdpCkj341Q5oQyZP5qGwlfB3hTXUDXvjjtkrVarSYy1W9lLwgJS7PZjnr4KC9fktVKq05Z7AuEryBkhDaCVVlFKPfqRAO6E9C359WWjb3zymb+XXtg7PeQ7am659ET5J3xQtUCxJmEGImUfuI95fB38gDZ+7XzARmPBmPFYqZctLrnx9Bho+Vrx8WjcktT7g2AxbOADkM3uRGiDpGucTqE79weIQYg10sSD5xt5ezwL9K1/K/xIl1yk98kOfPl1A6tPWVAjwqQIeOq6VRsP/pF8vOZ/L5MP/ovewxwNABhpIp58CDAChjQWETVMlnAAAAABJRU5ErkJggg=="},"9Hpm":function(e,t,a){},"9wXn":function(e,t,a){},BZgG:function(e,t,a){},I4Wp:function(e,t,a){},IuzP:function(e,t,a){},JhcM:function(e,t,a){},Jrg8:function(e,t,a){},Jwn2:function(e,t,a){},MWt3:function(e,t,a){},OE2q:function(e,t,a){"use strict";a.d(t,"e",function(){return s}),a.d(t,"f",function(){return l}),a.d(t,"g",function(){return u}),a.d(t,"a",function(){return d}),a.d(t,"b",function(){return m}),a.d(t,"d",function(){return f}),a.d(t,"c",function(){return g});var n=a("+vh4"),r=a("efbE"),i=a("SFoa"),c=a("+oIK"),o=a("t8ds").a.sadd,s=function getConversationById(e){return r.e.get("/conversations/end_users/widget/conversation_context/".concat(e))},l=function markConversationAsRead(e,t){var a=!0,n=!1,i=void 0;try{for(var c,s=t[Symbol.iterator]();!(a=(c=s.next()).done);a=!0){var l=c.value;o("messagesSeen",l)}}catch(u){n=!0,i=u}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return r.e.post("/messages/read-bulk",{messageIds:t,conversationId:e})},u=function sendConversationEvent(e){return r.o.post("/conversations/".concat(e.conversationId,"/messages"),{type:"CONVERSATION_EVENT",conversationEvent:e})},d=function createBotConversation(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(i.a)(e),c=Object(i.b)(a,"inboxId"),o={body:"",attributes:Object(n.a)({withGreeting:!0,startInteraction:e,interactionId:e},t,{widgetVersion:2}),status:"BULK_SENT"};return c&&(o.inboxId=c),r.o.post("/messages",o)},m=function createNewConversation(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.o.post("/messages",{body:e,attributes:Object(n.a)({},t,{widgetVersion:2})})},f=function fetchAgentStatus(e){return r.e.get("/agents/".concat(e,"/status"))},g=function createNewConversationWithMeeting(e,t,a){var n={body:"",attributes:{scheduleMeetingFlow:!0,scheduleMeetingWith:t,widgetApiTriggered:!0,isTriggeredFromAPI:!0,widgetVersion:2},status:"BULK_SENT"};if(e&&(n.attributes.endUserEmail=e),a&&a.campaignMessage){var i=a.campaignMessage;n.attributes.relatedCampaignId=i.attributes.campaignId,n.preMessages=Object(c.b)(i)}var o=Object(c.a)(n);return r.o.post("/messages",o)}},P6Di:function(e,t,a){},"PGb/":function(e,t,a){},Q0X4:function(e,t,a){},Q80r:function(e,t,a){},Qp3a:function(e,t,a){},RJSH:function(e,t,a){},SrLZ:function(e,t,a){"use strict";a.r(t);var n=a("mj2O"),r=a.n(n),i=a("7SM1"),c=a("s8DI"),o=a("OE2q"),s=a("mssF"),l=a("O94r"),u=a.n(l),d=a("Rqwx"),m=a("+vh4"),f=a("WwEg"),g=a("ERkP"),b=a.n(g),v=a("liE7"),p=a("uDfI"),j=a("F8vJ"),O=function useAgentName(e){var t=Object(p.c)(function(e){return e.embed.configuration}).team,a=void 0===t?[]:t,n=Object(v.useTranslation)().t;return Object(g.useMemo)(function(){var t=a.find(function(t){return t.id===e});return t&&!Object(j.a)(t.name)?t.name:n("agent")},[a,e,n])},h=a("lE29"),A=(a("I4Wp"),function AgentTypingIndicator(){var e=Object(v.useTranslation)().t,t=Object(h.a)().widgetBackgroundAlpha,a=Object(p.c)(function(e){return e.conversations.typingIndicators[e.conversations.activeConversation]||{}}),n=a.isTyping,r=void 0!==n&&n,i=a.userId,c=O(i);return r?b.a.createElement("p",{style:t,className:"agent-typing-indicator"},e("status.agentTyping",{agent:c})):null}),E=a("HXmn"),y=a("LVcX"),w=a("oFTC"),k=(a("uqJV"),a("Q80r"),Object(g.lazy)(function(){return a.e(9).then(a.t.bind(null,"mznO",7))})),C=function EmojiPickerLoader(e){var t=e.loadingText;return b.a.createElement("div",{className:"drift-widget-emoji-picker--loader"},b.a.createElement("p",null,t),b.a.createElement(E.a,null))},M=function EmojiPicker(e){var t=e.open,n=e.onAddEmoji,o=e.onClickOutside,s=Object(v.useTranslation)().t,l=Object(p.c)(function(e){return e.conversations}).activeConversation,d="en"!==Object(p.c)(function(e){return Object(y.a)("en",["embed","configuration","locale"],e)}),m=Object(g.useMemo)(function(){return function createEmojiMartI18nProp(e){return{search:e("emoji.search"),clear:e("emoji.clear"),notfound:e("emoji.notfound"),skintext:e("emoji.skintext"),categories:{search:e("emoji.category.search"),recent:e("emoji.category.recent"),smileys:e("emoji.category.smileys"),people:e("emoji.category.smileys"),nature:e("emoji.category.nature"),foods:e("emoji.category.foods"),activity:e("emoji.category.activity"),places:e("emoji.category.places"),objects:e("emoji.category.objects"),symbols:e("emoji.category.symbols"),flags:e("emoji.category.flags"),custom:e("emoji.category.custom")},categorieslabel:e("emoji.categorieslabel"),skintones:{1:e("emoji.skintone1"),2:e("emoji.skintone2"),3:e("emoji.skintone3"),4:e("emoji.skintone4"),5:e("emoji.skintone5"),6:e("emoji.skintone6")}}}(s)},[s]),f=Object(g.useRef)(null),j=Object(g.useState)(null),O=Object(c.a)(j,2),h=O[0],A=O[1];Object(g.useEffect)(function(){t&&!h&&function(){var e=Object(i.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.e(19).then(a.t.bind(null,"8ozv",3)).then(function(e){return A(e.default)});case 2:case"end":return e.stop()}},_callee)}));return function fetchEmojiData(){return e.apply(this,arguments)}}()()},[t,h]),Object(w.a)(f,function(e){o(e)});return b.a.createElement("div",{ref:f,className:u()("drift-widget-composer-emoji-picker",{"drift-widget-composer-emoji-picker--open":t,"drift-widget-composer-emoji-picker--full":l,"drift-widget-composer-emoji-picker--mini":!l,"drift-widget-composer-emoji-picker--hide-search":d})},b.a.createElement(g.Suspense,{fallback:b.a.createElement(C,{loadingText:s("status.loading")})},!!h&&b.a.createElement(k,{darkMode:!1,onSelect:function addEmojiToMessage(e){var t=e.native;n(function(e){return"".concat(e," ").concat(t)})},sheetSize:64,set:"apple",data:h,exclude:["flags","symbols","objects"],perLine:6,emojiTooltip:!d,i18n:m})))},N=a("efbE"),S=["en","es","pt","id","fr","ar","tr","th","vi","de","it","ja","zh-CN","zh-TW","ru","ko","pl","nl","ro","hu","sv","cs","hi","bn","da","fa","tl","fi","iw","ms","no","uk"],T=function localeToGiphyLang(e){switch(e){case"de-DE-formal":return"de";case"zh":return"zh-CN";case"zh-HK":return"zh-TW";case"pt-BR":return"pt"}return S.includes(e)?e:"en"},I=function getTrendingGiphys(e){return N.h.get("/trending",{params:{limit:e,rating:"pg"}})},_=function getSearchGiphys(e,t){var a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).locale;return N.h.get("/search",{params:{limit:t,q:e,lang:T(a),rating:"pg"}})},P=function useEmbedLocale(){return Object(p.c)(function(e){return Object(y.a)("en",["embed","configuration","locale"],e)})},R=a("nvPd"),x=a("6wvX");function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var a,n,r=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var z,D,L=b.a.createElement("path",{fill:"#9DA9B0",fillRule:"nonzero",d:"M7.92 11.13c-1.94 0-3.5-1.37-3.5-3.46 0-2.1 1.56-3.45 3.5-3.45 1.3 0 2.15.62 2.68 1.38l-.95.55c-.36-.5-.99-.89-1.73-.89-1.32 0-2.3 1-2.3 2.41 0 1.39.98 2.41 2.3 2.41.68 0 1.28-.31 1.58-.6V8.45h-2V7.42h3.16v2.49c-.65.73-1.59 1.22-2.74 1.22zm5.016-.13h-1.17V4.33h1.17V11zm2.475 0h-1.17V4.33h4.57v1.03h-3.4v1.72h3.33v1.03h-3.33V11zM3 0h17a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H3a3 3 0 0 1-3-3V3a3 3 0 0 1 3-3zm0 1.3A1.7 1.7 0 0 0 1.3 3v10A1.7 1.7 0 0 0 3 14.7h17a1.7 1.7 0 0 0 1.7-1.7V3A1.7 1.7 0 0 0 20 1.3H3z"}),B=function SvgGif(e){var t=e.svgRef,a=_objectWithoutProperties(e,["svgRef"]);return b.a.createElement("svg",_extends({width:23,height:16,viewBox:"0 0 23 16",ref:t},a),L)},H=b.a.forwardRef(function(e,t){return b.a.createElement(B,_extends({svgRef:t},e))}),F=(a.p,a("97O6")),U=a.n(F),G=a("0lfv"),V=(a("RJSH"),function GiphyPicker(e){var t=e.onAddGiphy,a=e.disabled,n=void 0!==a&&a,o=Object(v.useTranslation)().t,s=P(),l=Object(g.useState)([]),d=Object(c.a)(l,2),m=d[0],f=d[1],p=Object(g.useState)(!1),j=Object(c.a)(p,2),O=j[0],h=j[1],A=Object(g.useRef)(null),E=Object(g.useRef)(null),y=Object(R.a)(""),k=y.value,C=y.onChange,M=Object(x.a)(),N=Object(g.useMemo)(function(){return Object(G.c)(function(){var e=Object(i.a)(r.a.mark(function _callee(e){var t,a;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_(e,51,{locale:s});case 2:t=n.sent,a=t.data,f(a.data);case 5:case"end":return n.stop()}},_callee)}));return function(t){return e.apply(this,arguments)}}(),200,!1)},[s]),S=Object(g.useCallback)(Object(i.a)(r.a.mark(function _callee2(){var e,t;return r.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,I(51);case 2:e=a.sent,t=e.data,f(t.data);case 5:case"end":return a.stop()}},_callee2)})),[]);Object(w.a)(A,function(){return h(!1)});var T=Object(g.useCallback)(function(){h(function(e){return!e})},[]);Object(g.useEffect)(function(){O&&!M&&E.current.focus(),O&&S()},[O,M,S]),Object(g.useEffect)(function(){O&&(k.length>0?N(k):S())},[k,O,N,S]);return b.a.createElement("div",{className:"drift-widget-composer-action",ref:A},b.a.createElement("button",{className:"drift-widget-composer-giphy-toggle",onClick:T,"aria-label":"gifs",disabled:n},b.a.createElement(H,null)),b.a.createElement("div",{className:u()("drift-widget-composer-giphy-picker",{"drift-widget-composer-giphy-picker--show":O,"drift-widget-composer-giphy-picker--mobile":M})},b.a.createElement("div",{className:"drift-widget-composer-giphy-picker-search"},b.a.createElement("input",{className:"drift-widget-input",ref:E,type:"search",placeholder:o("gifPicker.searchPlaceholder"),value:k,onChange:C,onFocus:function onInputFocus(e){M&&e.stopPropagation()}})),b.a.createElement("div",{className:"drift-widget-composer-giphy-picker-list-wrapper"},b.a.createElement("ul",{className:"drift-widget-composer-giphy-list"},m.map(function(e){return b.a.createElement("li",{key:e.id},b.a.createElement("button",{onClick:function onClick(){return function addGiphyToMessage(e){t('<img src="'.concat(e.url,'" alt="gif" />')),T()}(e.images.original)}},b.a.createElement("img",{src:e.images.preview_gif.url,alt:e.title})))}))),b.a.createElement("span",{className:"drift-widget-composer-giphy-picker-power"},b.a.createElement("img",{src:U.a,alt:o("gifPicker.poweredBy")}))))}),K=a("+Kbs"),W=a("908p"),Z=a("nQD+"),q=a("QtlZ"),Q=function getRandomTeamMemberId(){var e=q.a.getState(),t=e.embed,a=void 0===t?{}:t,n=e.session,r=void 0===n?{}:n,i=Object(y.a)([],["configuration","team"],a);if(!i)return null;var c=i.map(function(e){return e.id});return c[Object(G.f)(c.length,r.sessionStarted)]},J=function activeCampaignSelector(e){return Object(y.a)(null,["campaigns","activeCampaign"],e)},X=function useActiveCampaign(){return Object(p.c)(J)},Y=function useActiveConversation(){var e=Object(p.c)(function(e){return e.conversations}).activeConversation;return Object(p.c)(function(t){return Object(y.a)(null,["conversations","conversations",e,"conversation"],t)})},$=function useEmbedThemeProperties(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(p.c)(function(e){return Object(y.a)({},["embed","configuration","theme"],e)});return e.map(function(e){return t[e]})},ee=a("tLIi"),te=function useActiveSenderId(){var e=Y(),t=Object(ee.a)(),a=X(),n=$(["userList","userListMode"]),r=Object(c.a)(n,2),i=r[0],o=void 0===i?[]:i,s=r[1],l=void 0===s?"RANDOM":s,u=Object(p.c)(function(e){return e.embed}).configuration,d=(void 0===u?{}:u).autoAssigneeId,m=Object(g.useMemo)(function(){return Object(y.a)(null,["authorId"],t)},[t]),f=Object(g.useMemo)(function(){return Object(y.a)(null,["attributes","senderId"],a)},[a]),b=Object(g.useMemo)(function(){return Object(y.a)(null,["authorId"],a)},[a]),v=Object(g.useMemo)(function(){return!!Object(y.a)(null,["attributes","automaticSender"],a)},[a])&&!!b,j=function getSenderIdFromConversation(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t||(e&&e.assigneeId?e.assigneeId:null)}(e,m);return j||(v?b:f?function getWelcomeMessageSenderId(e){return 0===e?Q():e}(f):function getSenderIdFromEmbedTheme(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RANDOM",a=arguments.length>2?arguments[2]:void 0;return a||("RANDOM"===t?Q():!e.length||e.includes(null)?Q():e.length?e[0]:null)}(o,l,d))},ae=function uploadAttachment(e,t){var a=new FormData;return a.append("conversationId",t),a.append("file",e),N.a.post("/attachments",a)},ne=function fetchAttachments(e,t){return N.a.get("/attachments",{params:{id:e},cancelToken:t})},re=a("K7i0");!function(e){e.NONE="NONE",e.PENDING="PENDING",e.ERROR="ERROR",e.SIZE_ERROR="SIZE_ERROR"}(z||(z={})),function(e){e[e.DEFAULT=26214400]="DEFAULT"}(D||(D={}));var ie=function useAttachmentUpload(e){var t=e.onAttachmentUploadComplete,a=e.activeConversation,n=Object(p.b)(),o=Object(g.useState)(z.NONE),s=Object(c.a)(o,2),l=s[0],u=s[1],d=Object(p.c)(function(e){return Object(y.a)(!1,["embed","configuration","theme"],e)}).allowEndUserFileUpload,m=Object(g.useCallback)(function(){var e=Object(i.a)(r.a.mark(function _callee(e){var i,c,o,s;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(d){r.next=2;break}return r.abrupt("return");case 2:if(l!==z.ERROR){r.next=4;break}return r.abrupt("return");case 4:return u(z.PENDING),i=e.filter(function(e){return e.size<D.DEFAULT}).map(function(e){return ae(e,a)}),r.prev=6,r.next=9,Promise.all(i);case 9:c=r.sent,o=c.map(function(e){return e.data}),s=o.map(function(e){return e.id}),n(Object(re.d)({attachments:o})),t(s),u(z.NONE),r.next=20;break;case 17:r.prev=17,r.t0=r.catch(6),u(z.ERROR);case 20:case"end":return r.stop()}},_callee,null,[[6,17]])}));return function(t){return e.apply(this,arguments)}}(),[a,d,l,n,t]);return{attachmentState:l,uploadAttachments:m,resetAttachmentState:function resetAttachmentState(){u(z.NONE)}}},ce=function useKeyPress(e){var t=e.targetKey,a=e.onKeyDown,n=void 0===a?function(){}:a,r=e.onKeyUp,i=void 0===r?function(){}:r,o=Object(g.useState)(!1),s=Object(c.a)(o,2),l=s[0],u=s[1],d=Object(g.useCallback)(function(e){e.key===t&&(u(!0),n())},[t,n]),m=Object(g.useCallback)(function(e){e.key===t&&(u(!1),i())},[t,i]);return Object(g.useEffect)(function(){return window.addEventListener("keydown",d),window.addEventListener("keyup",m),function(){window.removeEventListener("keydown",d),window.removeEventListener("keyup",m)}},[d,m]),l},oe=a("rAhV"),se=a("0B8E"),le=function usePasteFiles(e){var t=e.inputRef,a=Object(g.useState)([]),n=Object(c.a)(a,2),r=n[0],i=n[1],o=Object(g.useState)(null),s=Object(c.a)(o,2),l=s[0],u=s[1],d=Object(g.useCallback)(function(e){if(e.clipboardData&&e.clipboardData.files){var t=Object(f.a)(e.clipboardData.files);t.length&&i(Object(se.a)([].concat(Object(f.a)(r),Object(f.a)(t)))),t.length&&u(e.clipboardData.getData("Text"))}},[r]);return Object(g.useEffect)(function(){t&&(t.current.onpaste=d)},[t,d]),{pastedTextFromFiles:l,pastedFiles:r,clearFiles:function clearFiles(){i([]),u(null)}}},ue=a("58kB"),de=a("qwiD"),me=a("7VeV"),fe=function useTypingIndicators(e){var t=e.activeConversationId,a=Object(p.b)(),n=Object(g.useRef)(),r=Object(p.c)(function(e){return e.session.endUser.type}),i=Object(p.c)(function(e){return e.session.endUser.id}),c=Object(g.useCallback)(function(e){a(Object(de.d)("chat","user","typing:".concat(e),{userId:i,userType:r,conversationId:t,participants:[]}))},[t,a,i,r]),o=Object(g.useMemo)(function(){return Object(me.throttle)(5e3,!1,function(){return c("started")})},[c]);return{sendTypingStarted:function sendTypingStarted(){o(),n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(function(){return c("finished")},5e3)},sendTypingFinished:function sendTypingFinished(){n.current&&(window.clearTimeout(n.current),n.current=null),c("finished")}}};function emoji_extends(){return(emoji_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function emoji_objectWithoutProperties(e,t){if(null==e)return{};var a,n,r=function emoji_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ge,be=b.a.createElement("path",{fill:"#9DA9B0",fillRule:"evenodd",d:"M8 16c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8zM8 1.333A6.674 6.674 0 0 0 1.333 8 6.674 6.674 0 0 0 8 14.667 6.674 6.674 0 0 0 14.667 8 6.674 6.674 0 0 0 8 1.333zm0 12c-1.942 0-3.705-1.167-4.601-3.046A.666.666 0 1 1 4.6 9.713C5.275 11.123 6.577 12 8 12c1.431 0 2.733-.875 3.397-2.285a.666.666 0 1 1 1.206.57c-.886 1.88-2.65 3.048-4.603 3.048zM10.667 8a1.335 1.335 0 0 1-1.334-1.333 1.335 1.335 0 0 1 2.667 0C12 7.402 11.402 8 10.667 8zM5.333 8A1.335 1.335 0 0 1 4 6.667c0-.736.599-1.334 1.333-1.334a1.335 1.335 0 0 1 0 2.667z"}),ve=function SvgEmoji(e){var t=e.svgRef,a=emoji_objectWithoutProperties(e,["svgRef"]);return b.a.createElement("svg",emoji_extends({width:16,height:16,viewBox:"0 0 16 16",ref:t},a),be)},pe=b.a.forwardRef(function(e,t){return b.a.createElement(ve,emoji_extends({svgRef:t},e))}),je=(a.p,a("+oIK")),Oe=a("U505"),he=a("ovDp"),Ae=(a("IuzP"),function validateMessageText(e){return e&&e.trim().length>0}),Ee=function Composer(e){var t=e.onSubmit,a=e.activeConversationId,n=e.enabled,r=void 0===n||n,i=e.buttonsOnly,o=void 0!==i&&i,s=Object(g.useRef)(null),l=Object(g.useRef)(null),d=Object(g.useState)(""),j=Object(c.a)(d,2),O=j[0],w=j[1],k=Object(g.useState)(!1),C=Object(c.a)(k,2),N=C[0],S=C[1],T=Object(g.useState)([]),I=Object(c.a)(T,2),_=I[0],P=I[1],R=Object(p.c)(function(e){return e.view}).matchedHours,D=Object(p.c)(function(e){return e.conversations.attachments}),L=Object(p.c)(function(e){return e.session.endUser.id}),B=Object(p.c)(function(e){return Object(y.a)(!1,["embed","configuration","theme"],e)}).allowEndUserFileUpload,H=Object(v.useTranslation)().t,F=Object(x.a)(!0),U=Object(oe.a)().markAsRead,G=te(),q=Object(h.a)().activeColor,Q=Object(ue.a)(G).recipient,J=le({inputRef:s}),X=J.pastedFiles,Y=J.clearFiles,$=ce({targetKey:"Enter"}),ee=fe({activeConversationId:a}),ae=ee.sendTypingStarted,ne=ee.sendTypingFinished,re=ie({activeConversation:a,onAttachmentUploadComplete:Object(g.useCallback)(function onAttachmentUploadComplete(e){P(function(t){return[].concat(Object(f.a)(t),Object(f.a)(e))}),Y()},[])}),se=re.attachmentState,de=re.uploadAttachments,me=re.resetAttachmentState,ge=Object(he.a)({onDrop:de,disabled:!r||!B}),be=ge.getRootProps,ve=ge.getInputProps,Ee=ge.open,ye=Ae(O)||_.length,we=se===z.PENDING,ke=se===z.ERROR||se===z.SIZE_ERROR;var Ce=Object(g.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,n=_?{attachments:_}:{},r=a?{}:{sentWelcomeMessage:R,sentOfflineHours:!R};ne(),t({message:Object(je.a)(Object(m.a)({message:e,activeConversation:a||null,authorId:L,attributes:r},n))}),w(""),P([]),me()},[a,L,R,O,t,me,ne,_]);Object(g.useEffect)(function(){B?X.length&&!we&&de(X):Y()},[B,we,Y,X,de]),Object(g.useEffect)(function(){$&&(Ae(O)||_.length)&&Ce()},[$,O,Ce,_.length]),Object(g.useEffect)(function(){a&&w("")},[a]);var Me=Object(g.useMemo)(function(){return r?H("composer.replyToPlaceholder",{name:Q.name}):H(o?"composer.chooseOptionAbove":"composer.replyDisabled")},[Q,r,o,H]),Ne=B&&!!a,Se=!ye&&!!a,Te=!!ye,Ie=Ne||Te||Se,_e=!r||we;return b.a.createElement(b.a.Fragment,null,(_.length||we||ke)&&b.a.createElement("div",{className:"drift-widget-composer--pre-message-attachments"},ke&&b.a.createElement("div",{className:"drift-widget-attachment-send-status drift-widget-attachment-send-status--failed"},b.a.createElement("span",{className:"drift-widget-attachment-send-status--text"},H(se===z.SIZE_ERROR?"attachment.errorSize":"attachment.error")),b.a.createElement(Z.a,{onClick:function onClick(){me(),Y()},className:"drift-widget-attachment-send-status--close"},b.a.createElement(K.j,{width:10,height:10}))),(_.length||we)&&b.a.createElement("ul",{className:"drift-widget-composer-attachment-preview-list"},[].concat(Object(f.a)(_),Object(f.a)(we?[{pending:!0}]:[])).map(function(e,t){return b.a.createElement("li",{key:D[e]?D[e].id:"file-upload-loader"},D[e]&&!D.pending&&b.a.createElement(Z.a,{onClick:function onClick(){return function onRemoveUploadedAttachment(e){P(function(t){return Object(Oe.a)([e],t)})}(e)},"aria-label":"close"},b.a.createElement(K.j,{width:6,height:6})),D[e]&&!D.pending?function resolveAttachmentTypeComponent(e){return e?e.mimeType.includes("image")?b.a.createElement("div",{className:"drift-widget-composer-attachment-preview-list-image-wrapper"},b.a.createElement("img",{alt:e.fileName,src:e.publicUrl})):b.a.createElement("div",{className:"drift-widget-composer-attachment-non-image",title:e.filename},b.a.createElement("strong",null,e.fileName),b.a.createElement(K.k,{width:16,height:16})):null}(D[e]):b.a.createElement(E.a,{size:"small",className:"drift-widget-composer-attachment-loader"}))}))),b.a.createElement("div",Object.assign({},be({onClick:function onClick(e){return e.stopPropagation()}}),{className:u()("drift-widget-composer--default",{"drift-widget-composer--mobile":F})}),B&&b.a.createElement("input",ve()),b.a.createElement(A,null),!F&&b.a.createElement(M,{open:N,onAddEmoji:function onAddEmoji(e){S(!N),r&&(w(e),s.current&&s.current.focus())},onClickOutside:function onEmojiPickerClickOutside(e){l.current&&l.current.contains(e.target)||S(!1)}}),r&&Ie&&b.a.createElement("div",{className:"drift-widget-composer-actions"},Ne&&b.a.createElement("button",{onClick:Ee,"aria-label":"add an attachment",disabled:!r},b.a.createElement(K.a,null)),Se&&b.a.createElement(V,{onAddGiphy:Ce,disabled:!r}),Te&&b.a.createElement("button",{className:u()("drift-widget-composer-send-button",{"drift-widget-composer-send-button--disabled":_e}),"aria-label":"send message",onClick:function onClick(){return Ce()},disabled:!r||we},b.a.createElement(W.a,{color:"#".concat(q)}))),b.a.createElement("div",{className:"drift-widget-composer--text-area"},b.a.createElement("pre",null,r&&O.length?O:" "),b.a.createElement("textarea",{className:"drift-widget-input",ref:s,placeholder:Me,value:r?O:"",onChange:function onTextareaChange(e){$||X.length||(w(e.target.value),ae())},onFocus:function onComposerFocus(){U(a)},"aria-label":"message composer",maxLength:4096,disabled:!r||!!X.length}),r&&!F&&b.a.createElement("button",{ref:l,className:"drift-widget-composer-emoji-toggle",onClick:function onEmojiButtonClick(){r&&S(!N)},disabled:!r,"aria-label":"emojis"},b.a.createElement(pe,null)))))},ye=a("f/zS"),we=a("6lNa"),ke=function useActiveAgentStatus(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Object(p.b)(),n=Object(p.c)(function(t){return Object(y.a)(null,["conversations","agentPresence","".concat(e),"status"],t)});return Object(g.useEffect)(function(){t||!n&&e&&function(){var t=Object(i.a)(r.a.mark(function _callee(){var t,n;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(o.d)(e);case 2:t=r.sent,n=t.data,a(Object(re.c)({agentId:e,availability:n.availability,lastActivity:n.lastActivityAt}));case 5:case"end":return r.stop()}},_callee)}));return function fetchAgentStatusById(){return t.apply(this,arguments)}}()()},[a,e,t,n]),t?we.a.ONLINE:n},Ce=(a("t/7O"),function PresenceAvatar(e){var t=e.size,a=void 0===t?"LARGE":t,n=e.id,r=void 0===n?null:n,i=e.className,c=e.image,o=Object(v.useTranslation)().t,s=Object(ue.a)(r).recipient,l=Object(g.useMemo)(function(){return Object(y.a)(null,["avatarUrl"],s)},[s]),d=ke(r,s.bot),m=Object(g.useMemo)(function(){return d?d===we.a.ONLINE?o("user.status.active"):d===we.a.OFFLINE?o("user.status.away"):null:null},[d,o]);return l?b.a.createElement("div",{className:u()("drift-widget-presence-avatar",i),title:d?m:""},b.a.createElement(ye.a,{size:a,image:c||l,"aria-label":"".concat(s.name," avatar")}),d&&d===we.a.ONLINE&&b.a.createElement("div",{className:u()("drift-widget-agent-status","drift-widget-agent-status--online"),"aria-label":"agent status ".concat(m)}),d&&d===we.a.OFFLINE&&b.a.createElement("div",{className:u()("drift-widget-agent-status","drift-widget-agent-status--offline"),"aria-label":"agent status ".concat(m)},b.a.createElement("div",{className:"drift-widget-agent-status--offline-dot"}))):null}),Me=a("yEsl"),Ne=a("g6eD"),Se=function useConversationHistoryToggle(){var e=Object(p.b)(),t=Object(p.c)(function(e){return e.view.conversationHistoryOpen});return{onToggleConversationHistory:Object(g.useCallback)(function(t){return e(Object(Ne.b)({conversationHistoryOpen:t}))},[e]),conversationHistoryOpen:t}},Te=a("da4L"),Ie=a("i9gz"),_e=a("DboL"),Pe=a("TbSn"),Re=function useLastMessage(e){var t=Object(p.c)(function(t){return Object(y.a)(null,["conversations","conversations",e,"lastMessage"],t)}),a=Object(p.c)(function(t){var a=Object(y.a)({},["conversations","messages",e],t);if(!Object(Ie.a)(a)){var n=Object(Te.l)(Object(_e.a)(a));if(n.length)return Object(Pe.a)(n)}return null});return t||a||{}},xe=a("kXeL"),ze=a.n(xe),De=function useUserResolution(){var e=Object(v.useTranslation)().t,t=Object(p.c)(function(e){return e.session.endUser});return Object(g.useMemo)(function(){return{id:t.id,name:Object(y.a)(e("user.self"),["name"],t),avatar:Object(y.a)(ze.a,["socialProfile","avatar"],t),email:Object(y.a)(null,["socialProfile","email"],t)}},[t,e])},Le=a("SsZN"),Be=a("A5mO"),He=(a("JhcM"),function ConversationHistoryListItem(e){var t=e.conversation,a=void 0===t?{}:t,n=Se().onToggleConversationHistory,r=Object(p.b)(),i=De(),c=Object(g.useMemo)(function(){return Object(y.a)(null,["conversation","id"],a)},[a]),o=Re(c),s=Object(g.useMemo)(function(){return Object(y.a)(null,["authorId"],o)},[o]),l=Object(ue.a)(s).recipient,u=Object(Te.i)(o),d=Object(oe.a)().markAsRead;if(Object(Ie.a)(o))return null;var m=o.createdAt,f=o.attributes,v=void 0===f?{}:f,j=Object(Be.a)(m).isAfter(Be.a.today())?Object(Be.a)(m).unixFmt("h:mm a"):Object(Be.a)(m).unixFmt("M/d/yyyy");return b.a.createElement("li",{className:"drift-widget-conversation-list-item"},b.a.createElement("button",{onClick:function toggleConversation(e){return function(){c&&(d(c),n(!1),r(Object(re.k)({conversationId:e})),Object(Le.f)(e))}}(a.conversation.id),"aria-label":"open conversation"},u?b.a.createElement(Me.a,{size:"SMALL",className:"drift-widget-conversation-list-item-avatar",image:i.avatar}):b.a.createElement(Ce,{size:"SMALL",className:"drift-widget-conversation-list-item-avatar",image:l.avatarUrl,id:s}),b.a.createElement("div",{className:"drift-widget-conversation-list-item-content"},b.a.createElement("h2",null,u?i.name:l.name),b.a.createElement("span",{className:"drift-widget-conversation-list-item-time"},j),b.a.createElement("p",{className:"drift-widget-conversation-list-item-last-message"},v.preview))))}),Fe=a("9xv8"),Ue=(a("PGb/"),function ConversationHistory(){var e=Se().conversationHistoryOpen,t=Object(p.c)(function(e){return e.conversations.conversations}),a=Object(g.useMemo)(function(){return Object(Fe.c)(Object(_e.a)(t),"updatedAt")},[t]),n=Object(g.useMemo)(function(){return b.a.createElement("ul",{className:"drift-widget-conversation-history-list"},a.map(function(e){return b.a.createElement(He,{key:e.conversation.id,conversation:e})}))},[a]);return b.a.createElement("div",{className:u()("drift-widget-conversation-history",{"drift-widget-conversation-history--open":e}),"aria-hidden":!e},e&&n)}),Ge=a("SFoa"),Ve=(a("p0+K"),function Drift(){var e=Object(y.a)("",["context","page","hostname"],Object(p.c)(function(e){return e.session})),t=Object(g.useMemo)(function(){return Object(Ge.c)()<=1?"":"?utm_source=".concat(e,"&utm_medium=web-widget&utm_campaign=widget-referral&utm_version=v2")},[e]);return b.a.createElement("a",{href:"https://www.drift.com/powered-by".concat(t),className:"drift-widget-power",rel:"noopener noreferrer",target:"_blank",title:"Drift"},b.a.createElement(v.Trans,{i18nKey:"composer.footer.poweredByDrift",components:[b.a.createElement(K.c,{height:12,width:12}),b.a.createElement("span",{className:"drift-widget-power-brand"},"Drift")]}))}),Ke=a("8Epr"),We=(a("2VrW"),function Footer(){var e=Object(p.c)(function(e){return e.view}).chatOpen,t=Object(p.c)(function(e){return e.embed.configuration}).showBranding,a=void 0!==t&&t,n=Object(Ke.a)(),r=n.privacyPolicyLink,i=n.privacyPolicyLinkText,c=n.noPolicy;return!e||!a&&c?null:b.a.createElement("div",{className:u()("drift-widget-footer",{"drift-widget-footer--with-branding":a})},a&&b.a.createElement(Ve,null),!c&&b.a.createElement("span",{className:"drift-widget-footer-privacy"},b.a.createElement("a",{href:r,rel:"noopener noreferrer",target:"_blank",title:i,className:"drift-widget-footer-privacy--link"},i)))}),Ze=a("jm9a"),qe=a("hX/4"),Qe=a("o3t1"),Je=(a("Jwn2"),function Button(e){var t=e.children,a=e.className,n=e.invertColors,r=e.invertOnHover,i=Object(qe.a)(e,["children","className","invertColors","invertOnHover"]),c=Object(h.a)(),o=c.buttonStyles,s=c.foregroundStyles,l=Object(Qe.a)(),d=l.hoverProps,f=l.isHovered,g=n?s:o,v=n?o:s;return b.a.createElement("button",Object.assign({className:u()("drift-widget-button",Object(Ze.a)({},a,!!a)),style:f&&r?Object(m.a)({},v):Object(m.a)({},g),onTouchStart:G.l},d,i),t)}),Xe=function AgentRequestedOptions(e){var t=e.message,a=t.attributes,n=t.id,r=t.conversationId,i=Object(p.b)(),c=Object(p.c)(function(e){return e.session}).endUser;if(Re(r).id!==n||!t.attributes.buttons)return null;var o=function doSendMessage(e){var a=e.label;return function(){var e=Object(je.a)({message:a,activeConversation:r,authorId:c.id,attributes:{buttonClicked:!0,questionId:t.attributes.questionId}});i(Object(re.j)({message:e}))}};return b.a.createElement("ul",{className:"drift-widget-message-group drift-widget-message-group-type--END_USER"},b.a.createElement("li",{className:"drift-widget-message drift-widget-message-sender--END_USER"},b.a.createElement("div",{className:"drift-bot-buttons--set"},a.buttons.map(function(e,t){return b.a.createElement(Je,{onClick:o(e),key:"bot-button-".concat(n,"-").concat(t),invertOnHover:!0},e.label)}))))},Ye=a("rAc1"),$e=a("l6A5"),et=function urlIdentity(e){return Object(Ye.a)(e)},tt=(Object($e.a)(et,function(e){return N.k.get("/",{params:{url:encodeURI(e)}})}),Object($e.a)(et,function(e){return N.j.get("/",{params:{url:e,iframe:1,omit_script:1,media:1}})})),at=function Retry(e){var t=e.height,a=void 0===t?24:t,n=e.width,r=void 0===n?24:n;return b.a.createElement("svg",{className:"drift-default-icon drift-default-icon--retry",width:r,height:a,viewBox:"0 0 28 24"},b.a.createElement("path",{d:"M27.82 19.074c-0.17 0.085-0.353 0.126-0.53 0.126-0.436 0-0.854-0.244-1.063-0.664l-0.994-2.010c-1.762 4.469-5.996 7.474-11.002 7.474-5.438 0-10.298-3.548-11.82-8.628-0.19-0.635 0.164-1.304 0.792-1.496 0.624-0.193 1.29 0.166 1.48 0.8 1.222 4.076 5.148 6.924 9.548 6.924 4.128 0 7.481-2.436 8.838-6.126l-2.372 1.199c-0.588 0.298-1.3 0.056-1.592-0.536s-0.055-1.313 0.53-1.609l4.748-2.401c0.589-0.296 1.301-0.055 1.594 0.538l2.374 4.8c0.294 0.593 0.055 1.314-0.53 1.61zM25.259 10.126c-0.626 0.191-1.291-0.167-1.481-0.802-1.223-4.076-5.148-6.924-9.547-6.924-4.132 0-7.486 2.437-8.842 6.127l2.375-1.201c0.588-0.296 1.301-0.055 1.592 0.538 0.294 0.593 0.056 1.314-0.53 1.61l-4.748 2.399c-0.17 0.086-0.352 0.127-0.529 0.127-0.437 0-0.856-0.242-1.063-0.662l-2.375-4.801c-0.293-0.593-0.055-1.314 0.532-1.61 0.589-0.296 1.3-0.055 1.592 0.538l0.994 2.008c1.759-4.468 5.994-7.471 11.003-7.471 5.436 0 10.296 3.548 11.819 8.628 0.191 0.635-0.164 1.304-0.791 1.498z"}))},nt=function MessageFooter(e){var t=e.message,a=e.isLastGroup,n=e.isLastMessage,r=e.delivered,i=e.generated,o=e.messageTimedOut,s=e.deliveryFailed,l=e.resolveMessageHeight,d=Object(v.useTranslation)().t,m=Object(g.useState)(!1),f=Object(c.a)(m,2),p=f[0],j=f[1];return Object(g.useEffect)(function(){(o||r)&&Object(G.d)(function(){return j(!1)},500),r||p||j(!0)},[r,o,p]),Object(g.useLayoutEffect)(function(){l()},[l,r,p,a,n,s]),!r||p?b.a.createElement("li",{key:"".concat(i,"-message-status"),className:u()("drift-widget-message drift-widget-message--meta-date drift-no-op",{"drift-widget-message-failed-status":s})},b.a.createElement("span",{className:"drift-widget-message--meta-status"},!p&&s?d("status.sendMessageFailed"):b.a.createElement(E.a,{size:"small",className:"drift-widget-message--meta-status__sending"}))):a||r?n&&a?b.a.createElement("li",{key:"".concat(t.createdAt,"-message-status"),className:"drift-widget-message--meta-date drift-widget-message"},b.a.createElement("div",{className:"drift-widget-message--meta-status"},b.a.createElement(K.i,{className:"drift-widget-message-sent",height:10,width:12}),b.a.createElement("span",{className:"drift-widget-message--meta-date-stamp"},Object(Be.a)(r).unixFmt("h:mm a")))):null:b.a.createElement("li",{key:"".concat(i,"-message-status"),className:"drift-widget-message drift-widget-message--meta-date drift-no-op"})},rt=a("PjZB"),it=a("EQxi"),ct=/(\s|^)(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/){1}[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/\S*)?/gm,ot=/src\s*=\s*"(.+?)"/g,st=function HtmlMessage(e){var t=e.body,a=e.style,n=void 0===a?{}:a,r=e.resolveMessageHeight,i=void 0===r?function(){}:r,c=e.className;if(Object(g.useLayoutEffect)(function(){i()},[i,t]),Object(Te.h)(t))return null;var o=t.match(ot)||[],s=t.replace(ct,function(e,t){return"".concat(t,'<a href="').concat(e.trim(),'" target="_blank" rel="noopener noreferrer">').concat(e.trim(),"</a>")}).replace(/<img .*?>/g,"");return b.a.createElement("div",{className:u()("drift-widget-message--box drift-widget-message--HTML",c),style:n},b.a.createElement("div",{dangerouslySetInnerHTML:{__html:s}}),o&&o.map(function(e,t){return b.a.createElement("img",{key:"drift-html-message-".concat(e,"-").concat(t),alt:"drift message",onLoad:i,src:e.replace('"',"").replace("src=","").replace('"',"")})}))},lt=(a("Wkzb"),function BotMessage(e){var t=e.body;return Object(Te.h)(t)?null:b.a.createElement(b.a.Fragment,null,b.a.createElement(st,{body:t,className:"drift-widget-message--bot"}))}),ut=(a("vYbd"),function Card(e){return b.a.createElement("div",Object.assign({},e,{className:u()("drift-widget-card",e.className)}),e.children)}),dt=(a("9wXn"),function CardHeader(e){var t=Object(h.a)(),a=t.backgroundStyles,n=t.conversationHeaderTextStyles;return b.a.createElement("header",Object.assign({},e,{className:u()("drift-widget-card-header",e.className),style:Object(m.a)({},a,n,e.style)}),b.a.createElement("div",{className:"drift-widget-card-header--content"},e.children))}),mt=[{emoji:"\ud83d\ude20",value:1},{emoji:"\ud83d\ude41",value:2},{emoji:"\ud83d\ude10",value:3},{emoji:"\ud83d\ude0a",value:4},{emoji:"\ud83d\ude0d",value:5}],ft=(a("BZgG"),function ConversationRatingMessage(e){var t=(e.attributes||{}).conversationRating,a=(t=void 0===t?{}:t).ratingPrompt,n=(a=void 0===a?{}:a).ratingAcknowledgement,r=void 0===n?null:n,i=a.ratingPromptMessage,c=void 0===i?null:i,o=t.ratingText,s=void 0===o?null:o,l=t.ratingValue,d=void 0===l?null:l,m=s&&!Object(Ie.a)(s);return b.a.createElement(ut,{className:"drift-widget-conversation-rating"},b.a.createElement(dt,null,c),b.a.createElement("div",{className:"drift-widget-conversation-rating--rating"},b.a.createElement("div",{className:u()("drift-widget-conversation-rating--value",{"drift-widget-conversation-rating--value--with-text":m})},function getEmojiFromRatingValue(e){var t=mt.find(function(t){return t.value===e});return t?t.emoji:null}(d)),s&&!Object(Ie.a)(s)&&b.a.createElement("div",{className:"drift-widget-conversation-rating--text"},s)),b.a.createElement("div",{className:"drift-widget-conversation-rating--footer"},r))}),gt=function DefaultMessage(e){var t=e.body;return b.a.createElement("div",{className:"drift-widget-message--box drift-widget-message--STRING"},t)},bt=function EmailSuccess(e){e.height,e.width;return b.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},b.a.createElement("path",{fill:"#0076FF",fillRule:"nonzero",d:"M21 24H3c-1.654 0-3-1.403-3-3.13V10.435c0-.009.004-.016.005-.024.002-.08.026-.156.045-.233.006-.03.008-.058.017-.087l.007-.013a1.02 1.02 0 0 1 .092-.186c.02-.037.03-.078.056-.113.011-.014.028-.02.04-.034.006-.006.014-.01.019-.017.019-.02.026-.047.046-.065l3.276-3.108a.97.97 0 0 1 1.413.07 1.075 1.075 0 0 1-.068 1.473l-2.412 2.289 5.73 4.823 2.71-2.317a1.604 1.604 0 0 1 2.04-.008l2.718 2.325 5.729-4.822-2.39-2.269a1.076 1.076 0 0 1-.07-1.473.971.971 0 0 1 1.413-.071l3.256 3.088c.02.018.028.044.045.064.007.007.014.01.02.018.013.014.03.02.04.034.028.036.037.077.058.114.036.06.068.12.091.184l.007.014c.01.03.012.061.019.092.018.075.04.15.043.227.001.008.005.016.005.025V20.87c0 1.727-1.346 3.13-3 3.13zM1.95 12.575v8.032l4.736-4.047-4.735-3.985zM12 14.715l-8.422 7.198h16.844L12 14.715zm10.142-2.217l-4.827 4.062 4.827 4.126v-8.188zM7.775 4.38l3.363 3.48L17.402.361a.987.987 0 0 1 1.424-.108c.422.376.47 1.035.105 1.471l-6.975 8.348a.988.988 0 0 1-1.478.056L6.347 5.855a1.068 1.068 0 0 1 0-1.476.987.987 0 0 1 1.428.001z"}))},vt=function(){var e=Object(i.a)(r.a.mark(function _callee(e){var t,a,n;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(e.email&&e.conversationId){r.next=2;break}return r.abrupt("return");case 2:return t={conversationId:e.conversationId,type:we.b.LEAD_CAPTURED,email:e.email,leadCapture:{email:e.email,integrations:{},context:pt()}},r.next=5,Object(o.g)(t);case 5:return a=r.sent,n=a.data,r.abrupt("return",n);case 8:case"end":return r.stop()}},_callee)}));return function createLeadCapturedConversationEvent(t){return e.apply(this,arguments)}}(),pt=function hydrateConversationEventContext(){var e=q.a.getState().session,t=(void 0===e?{}:e).context||{},a=t.userAgent,n=t.locale,r=t.timezone,i=t.page;return{page:void 0===i?{}:i,locale:n,timezone:r,userAgent:a}},jt=a("NFvl"),Ot=(a("n/d+"),function SuccessCapture(){var e=Object(v.useTranslation)().t;return b.a.createElement("div",{className:"drift-widget-offline-email-input-wrapper drift-widget-email-success"},b.a.createElement(bt,null),b.a.createElement("p",{className:"drift-widget-success-message"},e("automessage.emailCapturedSuccess")))}),ht=function EmailCaptureMessage(){var e=Object(v.useTranslation)().t,t=Object(p.b)(),a=Object(R.a)(""),n=Object(p.c)(function(e){return e.session}).endUser,c=!!n.email&&!Object(Ie.a)(n.email),o=Object(p.c)(function(e){return e.conversations}).activeConversation,s=Object(p.c)(function(e){return Object(jt.a)(["embed","configuration","theme","emailCaptureMessage"],e)}),l=Object(g.useMemo)(function(){return s&&!Object(Ie.a)(s)?s:e("automessage.emailCaptureMessage")},[s,e]),u=function(){var e=Object(i.a)(r.a.mark(function _callee(e){return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:e.preventDefault(),t(Object(de.c)({email:a.value})),vt({email:a.value,conversationId:o});case 3:case"end":return n.stop()}},_callee)}));return function submitEmail(t){return e.apply(this,arguments)}}(),d=e("form.label.emailAddress");return b.a.createElement(b.a.Fragment,null,b.a.createElement(st,{body:l}),c?b.a.createElement(Ot,null):b.a.createElement("form",{className:"drift-widget-offline-email-capture",onSubmit:u},b.a.createElement("label",{htmlFor:"drift-widget-offline-email-capture-input",className:"drift-widget-offline-email-capture-label"},b.a.createElement("span",null,d,":"),b.a.createElement("fieldset",null,b.a.createElement("div",{className:"drift-widget-offline-email-capture-input-container"},b.a.createElement("input",Object.assign({id:"drift-widget-offline-email-capture-input",type:"email",placeholder:d},a,{required:!0}))),b.a.createElement(Je,{className:"drift-widget-offline-email-button",invertColors:!0,type:"submit"},e("form.label.submit"))))))},At=function getMeetingRecipientAgentId(e){return Object(Te.b)(e,"presentSchedule")||Object(Te.b)(e,"scheduleMeetingWith")},Et=function useMeetingMessageInfo(e){var t=Object(p.c)(function(t){var a=t.conversations.activeConversation;return t.conversations.messages[a][e]});return Object(g.useMemo)(function(){var e=Object(Te.b)(t,"appointmentInfo");return{shouldPresentSchedulingCard:!!Object(Te.b)(t,"presentSchedule"),shouldPresentConfirmationCard:!!e,additionalAgents:Object(Te.b)(t,"additionalAgents")||Object(y.a)([],["additionalAgents"],e),meetingRecipientAgentId:At(t),meetingType:Object(Te.b)(t,"meetingType"),meetingSource:Object(Te.b)(t,"meetingSource"),schedulingAgentId:Object(Te.b)(t,"bookedByUserId")||Object(Te.b)(t,"offerSchedule"),appointmentInfo:Object(Te.b)(t,"appointmentInfo")}},[t])},yt=a("7oto"),wt=function(){var e=Object(i.a)(r.a.mark(function _callee(){var e,t,a,n,i=arguments;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:"",r.next=3,Object(yt.a)({topic:"access-host-window",message:{key:"location"}});case 3:return t=r.sent,a=t.data,n=void 0===a?{}:a,r.abrupt("return","https://drift.com?utm_source=".concat(n.host,"&utm_medium=web-widget&utm_campaign=widget-referral&utm_content=").concat(e));case 7:case"end":return r.stop()}},_callee)}));return function getDriftUrl(){return e.apply(this,arguments)}}(),kt=a("JBtm"),Ct=a.n(kt),Mt=function fetchAgentAvailability(e){var t=e.agentId,a=e.additionalAgents,n=void 0===a?[]:a,r=e.meetingType,i=e.start;return N.n.get("scheduling/".concat(t,"/availability"),{params:{meetingType:r,start:i,additionalAgents:Object(f.a)(n)},paramsSerializer:function paramsSerializer(e){return Ct.a.stringify(e)}})},Nt=function scheduleMeeting(e){var t=e.endUserTimeZone,a=e.availabilitySlot,n=e.agentId,r=e.meetingType,i=e.meetingSource,c=e.conversationId,o=e.bookedByUserId;return N.n.post("scheduling/".concat(n,"/schedule"),a,{params:{conversationId:c,meetingSource:i,meetingType:r,timeZone:t,bookedByUserId:o}})},St=(a("Q0X4"),function LoadingDots(e){var t=e.size,a=void 0===t?null:t;return b.a.createElement("div",{className:u()("widget-loading-dots",Object(Ze.a)({},"widget-loading-dots--".concat(a),!!a))},b.a.createElement("span",{className:"widget-loading-dot widget-loading-dot-delay-1"},"."),b.a.createElement("span",{className:"widget-loading-dot widget-loading-dot-delay-2"},"."),b.a.createElement("span",{className:"widget-loading-dot widget-loading-dot-delay-3"},"."))}),Tt=function translateErrorMessage(e){if(!e||!e.message)return"meeting.scheduleAMeetingError";switch(e.message){case"The requested slot cannot be in the past":return"meeting.scheduleAMeetingTimePassedError";case"The requested slot does not fall within agent-configured availability":case"The requested slot does not respect the agent-configured minimum notice time":case"The requested slot--padded by buffer time on both sides--conflicts with an existing event":case"The requested slot--padded by buffer time on both sides--conflicts with an existing point-in-time event":return"meeting.scheduleAMeetingAlreadyBookedError";default:return"meeting.scheduleAMeetingError"}},It=function getTimeZoneGroupI18nKey(e){return"tz.group.".concat(e)},_t=function getTimeZoneI18nKey(e){return"tz.".concat(e)},Pt=function useMeetingRecipients(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=Object(v.useTranslation)().t,n=Object(ue.a)(e).recipient;return n.id?t.length?a("meeting.recipients",{name:n.name,others:t.length}):"".concat(n.name):""},Rt=function MeetingRecipients(e){var t=e.avatarSize,a=void 0===t?"SMALL":t,n=e.additionalRecipientIds,r=void 0===n?[]:n,i=e.primaryRecipientId,c=void 0===i?null:i,o=Pt(c,r);return b.a.createElement("div",{className:"drift-meeting-recipients"},b.a.createElement("div",{className:"drift-meeting-scheduler--avatar"},[c].concat(Object(f.a)(r)).map(function(e,t){return b.a.createElement(Ce,{size:a,id:e,key:"agent-avatar-".concat(t)})})),b.a.createElement("p",{className:"drift-meeting-recipient-name"},o))},xt=function MeetingConfirmation(e){var t=e.meetingTime,a=e.meetingAgentId,n=e.additionalAgents,r=e.meetingDuration,i=e.timezone,c=e.onBackClicked,o=e.onConfirmClicked,s=e.isBookingPending,l=e.resolveMessageHeight,u=e.isConfirmed,d=void 0!==u&&u,m=Object(v.useTranslation)(),f=m.t,p=m.i18n,j=Object(Be.a)(t).format("{month} {".concat("en"===p.lang?"date-ordinal":"date","}, {year}")),O=Object(Be.a)(t).format("time"),h=Object(Be.a)(t).add(r,"minute").format("time"),A=f(_t(i));return Object(g.useEffect)(l,[s,d]),b.a.createElement("div",{className:"drift-meeting-card-body"},!d&&b.a.createElement(Z.a,{className:"drift-meeting-back-button",onClick:c,"aria-label":"back"},b.a.createElement(K.b,null)),b.a.createElement(Rt,{additionalRecipientIds:n,avatarSize:"LARGE",primaryRecipientId:a}),b.a.createElement("div",{className:"drift-meeting-confirmation"},b.a.createElement("span",{className:"drift-meeting-confirmation--time"},O," - ",h),b.a.createElement("span",{className:"drift-meeting-confirmation--date"},j),b.a.createElement("span",{className:"drift-meeting-confirmation--timezone"},A)),!d&&b.a.createElement(Je,{className:"drift-meeting-confirmation__confirm",onClick:o,invertColors:!0,invertOnHover:!0},f("meeting.schedule")))},zt=a("hm8b"),Dt=(a("fmuz"),function MeetingSlotListItem(e){var t=e.meetingSlot,a=e.onItemClicked,n=Object(Qe.a)(),r=n.hoverProps,i=n.isHovered,c=Object(h.a)(),o=c.borderStyles,s=c.primaryTextColor;return b.a.createElement("li",Object.assign({className:"drift-meeting-day-picker--list-item"},r,{style:i?Object(m.a)({},o):{}}),b.a.createElement(Z.a,{onClick:a},b.a.createElement("span",{style:i?Object(m.a)({},s):{}},t.day),b.a.createElement("span",{style:i?Object(m.a)({},s):{}},t.date)))}),Lt=function MeetingDayPicker(e){var t=e.timezone,a=e.meetingInfo,n=e.meetingSlotSets,r=e.onMeetingDateChosen,i=e.onTimezoneLinkClick,o=e.resolveMessageHeight,s=Object(v.useTranslation)().t,l=Object(g.useState)(0),u=Object(c.a)(l,2),d=u[0],m=u[1],f=Object(g.useCallback)(function(){d!==n.length&&m(d+1)},[d,n]),p=Object(g.useCallback)(function(){d>0&&m(d-1)},[d]),j=ce({targetKey:"ArrowRight"}),O=ce({targetKey:"ArrowLeft"}),A=Object(h.a)().primaryTextColor;return Object(g.useEffect)(function(){j&&f(),O&&p()},[j,O,p,f]),Object(g.useEffect)(o,[n]),Object(zt.a)(n)?null:b.a.createElement("div",{className:"drift-meeting-day-picker"},b.a.createElement(Rt,{primaryRecipientId:a.meetingRecipientAgentId,additionalRecipientIds:a.additionalAgents}),b.a.createElement("div",{className:"drift-meeting-day-picker--timezone"},b.a.createElement("span",{className:"drift-meeting-day-picker--timezone-label"},s("meeting.selectADay")),b.a.createElement(Z.a,{onClick:i,style:A},"(",t.name,")")),b.a.createElement("ul",{className:"drift-meeting-day-picker--slots"},n[d].map(function(e,t){return b.a.createElement(Dt,{key:"meeting-slot-".concat(t),meetingSlot:e,onItemClicked:function onItemClicked(){return r(e)}})})),b.a.createElement("div",{className:"drift-meeting-day-picker--slot-nav"},d>0&&b.a.createElement(Z.a,{className:"drift-meeting-day-picker--slot-prev",onClick:function onClick(){return p()},style:A},s("meeting.prev")),d!==n.length-1&&b.a.createElement(Z.a,{className:"drift-meeting-day-picker--slot-next",onClick:function onClick(){return f()},style:A},s("meeting.next"))))},Bt=function MeetingError(e){var t=e.message,a=e.onRetryClicked,n=Object(v.useTranslation)().t;return b.a.createElement("div",{className:"drift-meeting-error"},b.a.createElement(K.d,null),b.a.createElement("div",{className:"drift-meeting-error-message"},b.a.createElement("span",null,t)),b.a.createElement(Je,{onClick:a},n("meeting.chooseNewTime")))},Ht=function MeetingPoweredByDrift(e){var t=e.redirectUrl;return b.a.createElement("div",{className:"drift-meeting-confirmed-text"},b.a.createElement("a",{href:t},b.a.createElement(v.Trans,{i18nKey:"composer.footer.meetingPoweredByDrift",components:[b.a.createElement(K.c,{height:12,width:12})]})))},Ft=function MeetingSchedulerCard(e){var t=e.duration,a=e.children,n=Object(v.useTranslation)().t;return b.a.createElement(ut,{className:"drift-meeting-scheduler"},b.a.createElement(dt,{className:"drift-meeting-scheduler--header"},b.a.createElement("span",null,n("meeting.scheduleAMeeting")),t&&b.a.createElement("span",null,n("meeting.duration",{duration:t}))),b.a.createElement("div",{className:"drift-meeting-scheduler--content"},a))},Ut=a("KwHb"),Gt=function MeetingTimeSlot(e){var t=e.onMeetingTimeChosen,a=e.index,n=e.timeSlot,r=e.timezone,i=Object(Qe.a)(),c=i.hoverProps,o=i.isHovered,s=Object(h.a)(),l=s.borderStyles,u=s.primaryTextColor;return b.a.createElement("li",Object.assign({className:"drift-meeting-time-picker--slot",key:"slot-".concat(a)},c,{style:o?Object(m.a)({},l):{}}),b.a.createElement(Z.a,{onClick:function onClick(){return t(n)}},b.a.createElement("span",{style:o?Object(m.a)({},u):{}},Object(Be.a)(n,r.value).format("time"))))},Vt=function MeetingTimePicker(e){e.additionalAgents,e.meetingAgentId;var t=e.timezone,a=e.meetingSlot,n=e.onBackClicked,r=e.onMeetingTimeChosen,i=e.onTimezoneLinkClick,o=e.resolveMessageHeight,s=Object(v.useTranslation)().t,l=Object(g.useState)(0),u=Object(c.a)(l,2),d=u[0],m=u[1],f=Object(Ut.a)(6,a.slots),p=Object(g.useCallback)(function(){d!==f.length-1&&m(d+1)},[d,f]),j=Object(g.useCallback)(function(){d>0&&m(d-1)},[d]),O=ce({targetKey:"ArrowRight"}),A=ce({targetKey:"ArrowLeft"}),E=Object(h.a)().primaryTextColor;return Object(g.useEffect)(function(){O&&p(),A&&j()},[O,A,p,j]),Object(g.useEffect)(o,[d]),b.a.createElement("div",{className:"drift-meeting-time-picker"},b.a.createElement("header",{className:"drift-meeting-time-picker--header"},b.a.createElement(Z.a,{className:"drift-meeting-back-button",onClick:n,"aria-label":"back"},b.a.createElement(K.b,null)),b.a.createElement("span",{className:"drift-meeting-time-picker--header-day"},a.day," ",a.date)),b.a.createElement("div",{className:"drift-meeting-day-picker--timezone"},b.a.createElement("span",{className:"drift-meeting-day-picker--timezone-label"},s("meeting.selectATime")),b.a.createElement(Z.a,{onClick:i,style:E},"(",t.name,")")),b.a.createElement("ul",{className:"drift-meeting-time-picker--timeslots"},f[d].map(function(e,a){return b.a.createElement(Gt,{key:"drift-meeting-time-slot-".concat(a),onMeetingTimeChosen:r,index:a,timeSlot:e,timezone:t})})),b.a.createElement("div",{className:"drift-meeting-day-picker--slot-nav"},d>0&&b.a.createElement(Z.a,{className:"drift-meeting-day-picker--slot-prev",onClick:function onClick(){return j()},style:E},s("meeting.prev")),d!==f.length-1&&b.a.createElement(Z.a,{className:"drift-meeting-day-picker--slot-next",onClick:function onClick(){return p()},style:E},s("meeting.next"))))},Kt=a("oxCZ"),Wt=a.n(Kt),Zt=[{group:"us",zones:["America/Puerto_Rico","America/New_York","America/Chicago","America/Denver","America/Phoenix","America/Los_Angeles","America/Anchorage","Pacific/Honolulu"]},{group:"america",zones:["America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/ComodRivadavia","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Atikokan","America/Atka","America/Bahia","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Buenos_Aires","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Catamarca","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Coral_Harbour","America/Cordoba","America/Costa_Rica","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Ensenada","America/Fortaleza","America/Fort_Wayne","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Indianapolis","America/Inuvik","America/Iqaluit","America/Jamaica","America/Jujuy","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Knox_IN","America/La_Paz","America/Lima","America/Los_Angeles","America/Louisville","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Mendoza","America/Menominee","America/Merida","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Porto_Acre","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Rosario","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Shiprock","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Virgin","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","US/Eastern"]},{group:"europe",zones:["Europe/Amsterdam","Europe/Andorra","Europe/Athens","Europe/Belfast","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Nicosia","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Tiraspol","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich"]},{group:"asia",zones:["Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Ashkhabad","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Choibalsan","Asia/Chongqing","Asia/Chungking","Asia/Colombo","Asia/Dacca","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Gaza","Asia/Harbin","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Istanbul","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kashgar","Asia/Kathmandu","Asia/Katmandu","Asia/Kolkata","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macao","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Saigon","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Tel_Aviv","Asia/Thimbu","Asia/Thimphu","Asia/Tokyo","Asia/Ujung_Pandang","Asia/Ulaanbaatar","Asia/Ulan_Bator","Asia/Urumqi","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan"]},{group:"africa",zones:["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmara","Africa/Asmera","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Timbuktu","Africa/Tripoli","Africa/Tunis","Africa/Windhoek"]},{group:"australia",zones:["Australia/ACT","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Canberra","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/LHI","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/North","Australia/NSW","Australia/Perth","Australia/Queensland","Australia/South","Australia/Sydney","Australia/Tasmania","Australia/Victoria","Australia/West","Australia/Yancowinna"]},{group:"indian",zones:["Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion"]},{group:"atlantic",zones:["Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faeroe","Atlantic/Faroe","Atlantic/Jan_Mayen","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/Stanley","Atlantic/St_Helena"]},{group:"pacific",zones:["Pacific/Apia","Pacific/Auckland","Pacific/Chatham","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Samoa","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis","Pacific/Yap"]},{group:"antarctica",zones:["Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/South_Pole","Antarctica/Syowa","Antarctica/Vostok"]},{group:"arctic",zones:["Arctic/Longyearbyen"]}],qt={threshold:.4,keys:["value","name"]},Qt=function TimezoneList(e){var t=e.timezoneOptions,a=e.onTimezoneSelect,n=t.filter(function(e){return!!e.zones.length});return b.a.createElement("ul",{className:"drift-meeting-timezone-picker__list"},n.map(function(e,t){var n=b.a.createElement("li",{className:"drift-meeting-timezone-picker-group",key:"timezone-option-group-".concat(t)},e.group),r=e.zones.map(function(e,t){return b.a.createElement("li",{className:"drift-meeting-timezone-picker-list-item",key:"timezone-option-".concat(t)},b.a.createElement(Z.a,{onClick:function onClick(){return a(e)}},e.name))});return[n].concat(Object(f.a)(r))}))},Jt=function TimezonePicker(e){var t=e.onBack,a=e.onTimezoneSelect,n=e.resolveMessageHeight,r=Object(v.useTranslation)().t,i=Object(g.useMemo)(function(){return function translateTimeZones(e){return Zt.map(function(t){return{group:e(It(t.group)),zones:t.zones.map(function(t){return{name:e(_t(t)),value:t}})}})}(r)},[r]),o=Object(g.useState)(i),s=Object(c.a)(o,2),l=s[0],u=s[1],d=Object(R.a)("");return Object(g.useEffect)(function(){if(""!==d.value){var e=i.map(function(e){var t=new Wt.a(e.zones,qt);return{group:e.group,zones:t.search(d.value)}});u(e)}else u(i)},[d,i]),Object(g.useEffect)(n,[]),b.a.createElement("div",{className:"drift-meeting-timezone-picker"},b.a.createElement("div",{className:"drift-meeting-timezone__header"},b.a.createElement(Z.a,{className:"drift-meeting-back-button drift-meeting-timezone-back-button",onClick:t,"aria-label":"back"},b.a.createElement(K.b,null)),b.a.createElement("span",{className:"drift-meeting-timezone__title"},r("meeting.timeZone"))),b.a.createElement("div",{className:"drift-meeting-timezone-picker--container"},b.a.createElement("div",{className:"drift-meeting-timezone-picker-input"},b.a.createElement(K.m,{width:10,height:10}),b.a.createElement("input",Object.assign({type:"text",placeholder:r("meeting.timeZoneSearchPlaceholder")},d))),b.a.createElement(Qt,{timezoneOptions:l,onTimezoneSelect:a})))},Xt=function MeetingScheduler(e){var t=e.messageId,a=e.resolveMessageHeight,n=e.redirectUrl,o=void 0===n?"":n,s=e.isScheduled,l=void 0!==s&&s,u=Object(v.useTranslation)(),d=u.t,m=u.i18n,f=Object(g.useState)(),j=Object(c.a)(f,2),h=j[0],A=j[1],E=Object(g.useState)([]),w=Object(c.a)(E,2),k=w[0],C=w[1],M=Object(g.useState)(!1),N=Object(c.a)(M,2),S=N[0],T=N[1],I=Object(g.useState)(null),_=Object(c.a)(I,2),P=_[0],R=_[1],x=Object(g.useState)(null),z=Object(c.a)(x,2),D=z[0],L=z[1],B=Object(g.useState)(null),H=Object(c.a)(B,2),F=H[0],U=H[1],V=Object(g.useState)(l),K=Object(c.a)(V,2),W=K[0],Z=K[1],q=Object(g.useState)(!1),Q=Object(c.a)(q,2),J=Q[0],X=Q[1],Y=Object(g.useState)(!1),$=Object(c.a)(Y,2),ee=$[0],te=$[1],ae=Object(g.useState)(!1),ne=Object(c.a)(ae,2),ie=ne[0],ce=ne[1],oe=Object(g.useState)(null),se=Object(c.a)(oe,2),le=se[0],ue=se[1],de=Object(p.c)(function(e){return e.conversations}).activeConversation,me=Et(t),fe=O(me.meetingRecipientAgentId),ge=Object(p.b)(),be=Object(g.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(y.a)([],["slots"],e);return a.reduce(function(e,a){var n;try{n=Object(Be.a)(a,t.value)}catch(i){Object(G.k)({data:["Unable to translate non-IANA timezone",i,t.value]}),n=Object(Be.a)(a,"America/New_York")}var r=n.format("{iso-month}_{date}_{year}");return e[r]?e[r].slots.push(a):e[r]=function createMeetingSlot(e,t,a){return{day:t.format("{day}"),date:t.format("{month} {".concat("en"===m.lang?"date-ordinal":"date","}, {year}")),slots:[a]}}(0,n,a),e},{})},[m]),ve=Object(g.useCallback)(Object(i.a)(r.a.mark(function _callee(){var e,t,a;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,X(!0),n.next=4,Mt({agentId:me.meetingRecipientAgentId,additionalAgents:me.additionalAgents});case 4:e=n.sent,t=e.data,A(t),R({name:d(_t(t.agentTimezone)),value:t.agentTimezone}),X(!1),n.next=17;break;case 11:n.prev=11,n.t0=n.catch(0),a=Object(y.a)({},["response","data"],n.t0),ce(!0),ue(Tt(a)),X(!1);case 17:case"end":return n.stop()}},_callee,null,[[0,11]])})),[me.additionalAgents,me.meetingRecipientAgentId,d]);Object(g.useEffect)(function(){if(h&&P){var e=be(h,P),t=Object(G.b)(3,e);C(t)}},[P,h,be]),Object(g.useEffect)(function(){ve()},[ve]);var pe=function sendMeetingMessage(e){var t={id:e.id,url:e.url,availabilitySlot:F,slotDuration:h.slotDuration,agentId:me.meetingRecipientAgentId,bookingAgentId:me.schedulingAgentId,conversationId:de,endUserTimezone:P.value,agentTimezone:h.agentTimezone};ge(Object(re.j)({message:Object(je.a)({activeConversation:de,message:"",attributes:{scheduleMeetingFlow:!0,meetingType:me.meetingType,scheduleMeetingWith:me.meetingRecipientAgentId,widgetGuid:Object(G.n)(),appointmentInfo:t},isMetaMessage:!0})}))},Oe=function(){var e=Object(i.a)(r.a.mark(function _callee2(){var e,t;return r.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return te(!0),a.prev=1,a.next=4,Nt({endUserTimeZone:P.value,availabilitySlot:F,agentId:me.meetingRecipientAgentId,meetingType:me.meetingType,meetingSource:me.meetingSource,conversationId:de,bookedByUserId:me.schedulingAgentId});case 4:e=a.sent,Object(Le.k)({agentId:me.meetingRecipientAgentId,meetingTime:F,duration:h.slotDuration,timeZone:P.value,conversationId:de}),Z(!0),te(!1),pe(e.data),a.next=18;break;case 11:a.prev=11,a.t0=a.catch(1),t=Object(y.a)({},["response","data"],a.t0),ce(!0),te(!1),t&&"Conflict"===t.key&&A(null),ue(Tt(t));case 18:case"end":return a.stop()}},_callee2,null,[[1,11]])}));return function bookMeeting(){return e.apply(this,arguments)}}(),he=function onTimezoneLinkClick(){return T(!0)},Ae=!!D&&!F&&!S,Ee=!D&&!F&&!S,ye=!!D&&!!F&&!S,we=J||!k.length,ke=function clearMeetingSlot(){return L(null)},Ce=function clearMeetingTime(){return U(null)};return Object(g.useEffect)(function(){return function(){}},[ge,t,W]),Object(g.useLayoutEffect)(a,[we,ie]),ie?b.a.createElement(Ft,null,b.a.createElement(Bt,{message:d(le,{agent:fe}),onRetryClicked:function onMeetingScheduleRetry(){ce(!1),ke(),Ce(),h&&!Ee||ve()}})):we||ee?b.a.createElement(Ft,null,b.a.createElement("div",{className:"drift-meeting-card-body loading-state"},b.a.createElement(Rt,{additionalRecipientIds:me.additionalAgents,avatarSize:"LARGE",primaryRecipientId:me.meetingRecipientAgentId}),b.a.createElement(St,{size:"LARGE"}),b.a.createElement(Ht,{redirectUrl:o}))):b.a.createElement(Ft,{duration:h.slotDuration},b.a.createElement("div",{className:"drift-meeting-scheduler--meeting-info"},Ee&&b.a.createElement(Lt,{timezone:P,onMeetingDateChosen:function onMeetingDateChosen(e){L(e)},meetingSlotSets:k,meetingInfo:me,onTimezoneLinkClick:he,resolveMessageHeight:a}),Ae&&b.a.createElement(Vt,{meetingAgentId:me.meetingRecipientAgentId,additionalAgents:me.additionalAgents,timezone:P,meetingSlot:D,onBackClicked:ke,onMeetingTimeChosen:function onMeetingTimeChosen(e){U(e)},onTimezoneLinkClick:he,resolveMessageHeight:a}),ye&&b.a.createElement(xt,{meetingDuration:h.slotDuration,meetingAgentId:me.meetingRecipientAgentId,additionalAgents:me.additionalAgents,meetingTime:F,timezone:P.value,onBackClicked:Ce,onConfirmClicked:Oe,isBookingPending:ee,isConfirmed:W,resolveMessageHeight:a}),S&&b.a.createElement(Jt,{onTimezoneSelect:function onTimezoneSelected(e){R(e),T(!1)},onBack:function onTimezoneSelectBack(){return T(!1)},resolveMessageHeight:a})))},Yt=function MeetingMessage(e){var t=e.attributes,a=e.id,n=e.body,o=void 0===n?"":n,s=e.resolveMessageHeight,l=e.nextMessage,u=Object(y.a)(a,["widgetGuid"],t),d=Et(u),m=d.shouldPresentConfirmationCard,f=d.shouldPresentSchedulingCard,v=d.appointmentInfo,p=d.additionalAgents,j=Object(g.useState)(""),O=Object(c.a)(j,2),h=O[0],A=O[1],E=!!Object(y.a)(null,["attributes","appointmentInfo"],l);return Object(g.useEffect)(function(){!function(){var e=Object(i.a)(r.a.mark(function _callee(){var e;return r.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,wt("scheduling-card");case 3:e=t.sent,A(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(G.k)({data:["Failed to get referral URL: ".concat(t.t0)]});case 10:case"end":return t.stop()}},_callee,null,[[0,7]])}));return function getDriftReferralUrl(){return e.apply(this,arguments)}}()()},[]),f?b.a.createElement(b.a.Fragment,null,b.a.createElement(st,{body:o}),!E&&b.a.createElement(Xt,{messageId:a,redirectUrl:h,resolveMessageHeight:s})):m?b.a.createElement(Ft,{duration:v.slotDuration},b.a.createElement("div",{className:"drift-meeting-scheduler--meeting-info"},b.a.createElement(xt,{meetingDuration:v.slotDuration,meetingTime:v.availabilitySlot,meetingAgentId:v.agentId,additionalAgents:p,timezone:v.endUserTimezone,resolveMessageHeight:s,isConfirmed:!0}),b.a.createElement(Ht,{redirectUrl:h}))):null},$t={STRING:gt,HTML:st,LEGACY:st},ea=a("ggb3"),ta=a.n(ea),aa=function FileAttachmentMessage(e){var t=e.attachment,a=void 0===t?{}:t,n=e.multi,r=Object(h.a)(),i=r.buttonStyles,c=r.inlineFileStyles;return a.fileName?b.a.createElement(b.a.Fragment,null,b.a.createElement(Z.a,{className:"drift-widget-message--file",style:n?i:c,onClick:function onClick(){return function downloadFile(e){var t=document.createElement("a");t.style.display="none",t.href=e.publicUrl,t.download=e.fileName,t.click()}(a)},"aria-label":"download file"},b.a.createElement(K.k,{width:16,height:16}),b.a.createElement("span",{className:"drift-widget-attachment--filename",title:a.fileName},a.fileName))):null},na=function ImageAttachmentMessage(e){var t=e.attachment,a=void 0===t?{}:t,n=e.resolveMessageHeight,r=void 0===n?function(){}:n,i=Object(g.useState)(!1),o=Object(c.a)(i,2),s=o[0],l=o[1];return b.a.createElement(b.a.Fragment,null,b.a.createElement(Z.a,{className:"drift-widget-attachment--img","aria-label":"fullscreen file",onClick:function onClick(){return function triggerFullScreen(e){Object(yt.a)({topic:"generate-new-content-box",message:{type:"image",media:e}})}(a.publicUrl)}},b.a.createElement("img",{src:a.publicUrl,alt:a.fileName,onLoad:function onLoad(){!s&&r(),!s&&l(!0)}})))},ra=(a("Qp3a"),function AttachmentMessage(e){var t=e.attachmentIds,a=void 0===t?[]:t,n=e.style,c=e.resolveMessageHeight,o=Object(p.b)(),s=Object(p.c)(function(e){return e.conversations.attachments}),l=ta.a.CancelToken.source();Object(g.useEffect)(function(){var e=a.filter(function(e){return!s[e]}),t=function(){var t=Object(i.a)(r.a.mark(function _callee(){var t,a;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ne(e,l.token);case 3:t=n.sent,a=t.data,o(Object(re.d)({attachments:a})),n.next=10;break;case 8:n.prev=8,n.t0=n.catch(0);case 10:case"end":return n.stop()}},_callee,null,[[0,8]])}));return function fetchAttachmentsForMessage(){return t.apply(this,arguments)}}();return e.length&&t(),function(){l.cancel()}},[s,a,l,o]);var d=Object(g.useMemo)(function(){return a&&a.map(function(e){return s[e]?function isImage(e){var t=e.mimeType;return/image/.test(t)&&"image/svg+xml"!==t}(s[e])?b.a.createElement(na,{attachment:s[e],key:"drift-widget-attachment--".concat(e),resolveMessageHeight:c}):b.a.createElement(aa,{multi:a.length>1,attachment:s[e],key:"drift-widget-attachment--".concat(e)}):null})},[a,s,c]);return b.a.createElement("div",{style:n,className:u()("drift-widget-attachment drift-widget-message--box",{"drift-widget-attachment--multi":a&&a.length>1})},d)}),ia=(a("mQ2C"),function UnfurlMessage(e){var t=e.unfurlData,a=e.style,n=void 0===a?{}:a,r=e.resolveMessageHeight,i=void 0===r?function(){}:r,c=t.html,o=t.meta,s=void 0===o?{}:o,l=t.links,d=void 0===l?{}:l,m=t.url,f=void 0===m?"":m,v=t.rel,p=void 0===v?[]:v;Object(g.useLayoutEffect)(function(){i()},[i,c]);var j=Object(g.useMemo)(function(){return!!s.title||!!s.description||!!s.site},[s]),O=Object(g.useMemo)(function(){return Object(y.a)(null,["thumbnail",0],d)},[d]),h=Object(g.useMemo)(function(){return Object(y.a)(f,["site"],s)},[f,s]),A=Object(g.useMemo)(function(){return p[0]},[p]),E=Object(g.useMemo)(function(){return"player"===A},[A]),w=Object(g.useMemo)(function(){return"summary"===A},[A]);return b.a.createElement("div",{className:u()("drift-widget-message--box drift-widget-message--unfurl-container"),style:n},E&&b.a.createElement("div",{className:"drift-widget-message--unfurl-video",dangerouslySetInnerHTML:{__html:c}}),w&&O&&b.a.createElement("div",{className:"drift-widget-message--unfurl-image"},b.a.createElement("img",{alt:"".concat(h," - thumbnail"),src:O.href})),j&&b.a.createElement("div",{className:"drift-widget-message--unfurl_meta"},s.title&&b.a.createElement("h3",{className:"drift-widget-message--unfurl_title"},b.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:s.canonical,title:s.title},s.title)),s.description&&b.a.createElement("p",{className:"drift-widget-message--unfurl_description"},s.description),s.site&&b.a.createElement("p",{className:"drift-widget-message--unfurl_site"},s.site)))}),ca=(a("ZP32"),function MessageSentTimestamp(e){var t=e.sender,a=e.deliveredAt;return b.a.createElement("span",{className:"drift-widget-message-timestamp drift-widget-message-timestamp--".concat(t)},Object(Be.a)(a).unixFmt("h:mm a"))}),oa=function MessageComponent(e){var t=e.message,a=e.nextMessage,n=e.isLastGroup,r=e.isLastMessage,i=e.resolveMessageHeight,o=Object(g.useState)([]),s=Object(c.a)(o,2),l=s[0],d=s[1],v=Object(g.useState)(null),j=Object(c.a)(v,2),O=j[0],A=j[1],E=Object(p.b)(),w=Object(p.c)(function(e){return Object(y.a)(!1,["embed","configuration","theme","showUnfurl"],e)}),k=Object(h.a)(),C=k.backgroundStyles,M=k.borderStyles,N=k.textColorStyles,S=function resolveMessageComponent(e){var t=e.attributes,a=t.isBot,n=void 0!==a&&a,r=t.show_email_capture_card,i=t.conversationRating;return r?ht:Object(Te.j)(e)?Yt:n?lt:i?ft:$t.HTML}(t),T=Object(Te.i)(t)?rt.d.END_USER:rt.d.AGENT;Object(g.useEffect)(function(){if(!Object(Te.f)(t,"instantMeeting")){var e=Object(f.a)(Object(it.a)(t.body));e.length&&d(e)}},[t]),Object(g.useEffect)(function(){if(l.length>0){var e=document.createElement("textarea");e.innerHTML=l[0],tt(e.value.replace("#61;","")).then(function(e){var t=e.data;t.html&&A(t)}).catch(function(e){return Object(G.k)({data:["Failed to unfurl url: ".concat(l[0]),e]})})}},[l]),Object(g.useLayoutEffect)(function(){i()},[i,n]);var I=!!t.attributes.appointmentInfo||!!t.attributes.conversationRating||t.type===rt.e.EMAIL_CAPTURE_CARD,_=!!t.body||I,P=w&&O,R=t.attachments&&t.attachments.length>0;if(!_&&!P&&!R)return null;var x=Object(y.a)(null,["createdAt"])(t),z=Object(y.a)(null,["attributes","generatedAt"])(t),D=!x&&Be.a.now().isAfter(Object(Be.a)(z).add(30,"second")),L=!x&&D;return b.a.createElement(b.a.Fragment,null,_&&b.a.createElement("li",{className:u()("drift-widget-message drift-widget-message-sender--".concat(T),{"drift-widget-message-failed":L})},b.a.createElement(S,Object.assign({},t,{nextMessage:a,resolveMessageHeight:i,style:T===rt.d.END_USER?Object(m.a)({},C,N):{}})),!I&&x&&b.a.createElement(ca,{sender:T,deliveredAt:x}),L&&b.a.createElement(Z.a,{onClick:function doSendMessage(){E(Object(re.j)({message:Object(m.a)({},t,{attributes:Object(m.a)({},t.attributes,{generatedAt:(new Date).valueOf()})})}))}},b.a.createElement(at,{height:12,width:12}))),P&&b.a.createElement("li",{className:"drift-widget-message drift-widget-message--unfurl drift-widget-message-sender--".concat(T)},b.a.createElement(ia,{unfurlData:O,resolveMessageHeight:i,style:T===rt.d.END_USER?Object(m.a)({},M):{}})),R&&b.a.createElement("li",{className:"drift-widget-message drift-widget-message-sender--".concat(T)},b.a.createElement(ra,{attachmentIds:t.attachments,resolveMessageHeight:i,style:T===rt.d.END_USER?Object(m.a)({},C,N):{}}),b.a.createElement(ca,{sender:T,deliveredAt:x})),b.a.createElement(nt,{message:t,isLastGroup:n,isLastMessage:r,delivered:x,generated:z,messageTimedOut:D,deliveryFailed:L,resolveMessageHeight:i}))},sa=(a("UwV1"),function getAvatarPositionClassName(e){var t=Object(Te.j)(e),a=e.attributes.show_email_capture_card;return"message-group-avatar-".concat(void 0!==a&&a||t?"top":"bottom")}),la=function MessageGroupHeader(e){var t=e.senderType,a=e.senderId,n=O(a);return t!==rt.d.AGENT?null:b.a.createElement("li",{className:"drift-widget-message-sender"},b.a.createElement("span",{className:"drift-widget-message--meta-author"},n))},ua=function MessageGroup(e){var t=e.messages,a=void 0===t?[]:t,n=e.isLastGroup,r=void 0!==n&&n,i=e.showTimestamp,o=void 0!==i&&i,s=e.role,l=void 0===s?"cell":s,d=e.resolveMessageHeight,m=void 0===d?function(){}:d,f=Object(v.useTranslation)().t;Object(g.useLayoutEffect)(function(){m()},[m,r,o]);var p=Object(c.a)(a,1)[0],j=Object(Te.i)(p)?rt.d.END_USER:rt.d.AGENT,O=p.authorId,h=a[a.length-1],A=Object(Te.f)(h,"buttons");return b.a.createElement("div",{role:l,className:u()("drift-widget-message-group-wrapper",{"drift-widget-message-group-wrapper--last":r})},o&&b.a.createElement("p",{className:"drift-widget-message-group-timestamp"},function formatTimestamp(e,t){return e>0?Object(Be.a)(e).isSame(Be.a.now(),"date")?"".concat(t("dt.today")," ").concat(Object(Be.a)(e).unixFmt("h:mm a")):Object(Be.a)(e).unixFmt("M/d/yyyy h:mm a"):""}(a[0].createdAt,f)),b.a.createElement("ul",{className:"drift-widget-message-group drift-widget-message-group-type--".concat(j)},b.a.createElement(la,{senderType:j,senderId:O}),a.map(function(e,t){var n=t===a.length-1,i=n?null:a[t+1];return b.a.createElement(g.Fragment,{key:e.attributes.generatedAt||e.id||e.attributes.widgetGuid},n&&j===rt.d.AGENT&&b.a.createElement("li",{className:u()("drift-widget-message-group-avatar",sa(e))},b.a.createElement(Me.a,{id:O,size:"SMALL"})),b.a.createElement(oa,{resolveMessageHeight:m,message:e,nextMessage:i,isLastMessage:n,isLastGroup:r}))})),A&&b.a.createElement(Xe,{message:h}))},da=function usePrevious(e){var t=Object(g.useRef)();return Object(g.useEffect)(function(){t.current=e},[e]),t.current},ma=function useScroll(e,t){var a=Object(g.useRef)(),n=Object(g.useMemo)(function(){return Object(me.throttle)(250,!1,function(e){a.current&&a.current(e)})},[a]);Object(g.useEffect)(function(){a.current=e},[e]),Object(g.useEffect)(function(){var e=t.current;if(e)return e.addEventListener("scroll",n),function(){e&&e.removeEventListener("scroll",n)}},[t,n])},fa=a("mfas"),ga=a("XuDI"),ba=(a("P6Di"),function shouldShowTimestamp(e,t){if(!e)return!0;var a=e?e[e.length-1].createdAt:0;return Object(Be.a)(t[0].createdAt).isAfter(Object(Be.a)(a).add(2,"hour"))}),va=function setScrollTop(e,t,a){if(e.scrollTop!==t){var n=e.style;a&&(n["-webkit-overflow-scrolling"]="auto",n.overflow="hidden"),e.scrollTop=t,a&&(n.overflow="scroll",n["-webkit-overflow-scrolling"]="touch")}},pa=function MessageGroupList(e){var t=e.reflowHidden,a=e.messageGroups,n=e.messages,o=e.fetchMessages,s=e.activeConversation,l=Object(h.a)().widgetBackgroundStyles,d=Object(p.c)(function(e){return e.view}).chatOpen,m=Object(p.c)(function(e){return Object(y.a)({},["conversations","conversations",s],e)}),f=m.hasMoreMessages,v=m.nextPageMessageId,j=Object(x.a)(),O=Object(g.useState)(!0),A=Object(c.a)(O,2),w=A[0],k=A[1],C=Object(g.useState)(!1),M=Object(c.a)(C,2),N=M[0],S=M[1],T=Object(g.useState)(!1),I=Object(c.a)(T,2),_=I[0],P=I[1],R=Object(g.useState)(!1),z=Object(c.a)(R,2),D=z[0],L=z[1],B=Object(g.useRef)(null),H=Object(g.useRef)(0),F=Object(g.useRef)(!1),U=Object(oe.a)().markAsRead,V=Object(g.useMemo)(function(){return Object(Pe.a)(n)},[n]),K=da(V),W=!!K&&V!==K,Z=a.length,q=!N&&f&&d,Q=Object(g.useMemo)(function(){return a.map(function(e,t){var n=t===a.length-1,r=t>0?a[t-1]:null,i=e[0].attributes.widgetGuid||e[0].id;return b.a.createElement(ua,{key:"messageGroup-".concat(i),role:"listitem",messages:e,isLastGroup:n,showTimestamp:ba(r,e)})})},[a]),J=Object(g.useCallback)(function(){var e=Object(i.a)(r.a.mark(function _callee(e){return r.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return S(!0),P(!0),t.next=4,o({from:e});case 4:L(!0),S(!1),Object(G.d)(function(){return P(!1)},1e3);case 7:case"end":return t.stop()}},_callee)}));return function(t){return e.apply(this,arguments)}}(),[o]),X=Object(g.useCallback)(function(e){e.target.scrollTop<=200&&q&&!D&&J(v)},[J,v,q,D]);ma(X,B),Object(g.useLayoutEffect)(function(){if(!(Z<1))if(!d||N||t)!d&&W&&(F.current=!0);else{var e=Object(y.a)(0,["current","scrollHeight"],B),a=H.current,n=W||w||F.current;B.current&&(n?(va(B.current,e,j),F.current=!1):D&&va(B.current,e-a,j)),(n||D)&&(H.current=e),k(!1),L(!1)}},[Z,d,w,N,W,D,t,j]),Object(g.useEffect)(function(){L(!1),k(!0)},[s]),Object(g.useEffect)(function(){V&&d&&V.viewerRecipientStatus!==rt.f.READ&&!Object(Te.i)(V)&&U(s)},[V,s,U,d]);return b.a.createElement("div",{className:"drift-widget-message-group-list-container"},b.a.createElement("div",{style:l,className:u()("drift-widget-message-group-list-loader",{"drift-widget-message-group-list-loader--loading":_})},b.a.createElement(E.a,{visible:_})),b.a.createElement(ga.Scrollbars,{ref:function setScrollContainerRef(e){e&&B&&(B.current=e.view)},hideTracksWhenNotNeeded:!0,renderView:function renderScrollbarsView(e){var a=Object(fa.a)(["WebkitOverflowScrolling"],e.style);return b.a.createElement("div",Object.assign({},e,{role:"list",style:a,className:u()("drift-widget-message-group-list",{"drift-widget-message-group-list--hidden":t})}))}},Q))},ja=(a("+GZi"),function TextArea(e){var t=e.value,a=e.onValueChange,n=Object(qe.a)(e,["value","onValueChange"]),r=Object(x.a)(!0),i=Object(g.useState)(!1),o=Object(c.a)(i,2),s=o[0],l=o[1],d=Object(g.useRef)(null),m=Object(g.useRef)(null);return b.a.createElement(b.a.Fragment,null,!r&&b.a.createElement(M,{open:s,onAddEmoji:function onAddEmoji(e){l(!s),n.disabled||(a&&a(e),m.current&&m.current.focus())},onClickOutside:function onEmojiPickerClickOutside(e){d.current&&d.current.contains(e.target)||l(!1)}}),b.a.createElement("div",{className:"drift-widget-textarea"},b.a.createElement("pre",null,t&&t.length?t:" "),b.a.createElement("textarea",Object.assign({},n,{className:u()("drift-widget-input",n.className),value:t,ref:m,onChange:function onTextAreaChange(e){a&&a(e.target.value),n.onChange&&n.onChange(e)},disabled:n.disabled})),!n.disabled&&!r&&b.a.createElement(Z.a,{ref:d,className:"drift-widget-textarea--emoji-toggle",onClick:function onEmojiButtonClick(){n.disabled||l(!s)},disabled:n.disabled,"aria-label":"emojis"},b.a.createElement(pe,null))))}),Oa=(a("Jrg8"),function RateConversation(e){var t=e.message,a=Object(v.useTranslation)().t,n=Object(h.a)(),r=n.activeColor,i=n.widgetSecondaryColor,o=da(t),s=Object(p.b)(),l=Object(p.c)(function(e){return e.session}).endUser,d=Object(g.useState)(!0),m=Object(c.a)(d,2),f=m[0],j=m[1],O=Object(g.useState)(""),A=Object(c.a)(O,2),E=A[0],y=A[1],w=Object(g.useState)(0),k=Object(c.a)(w,2),C=k[0],M=k[1],N=Object(g.useMemo)(function(){return Object(Te.b)(t,"ratingPrompt")},[t]),S=N.ratingPromptMessage,T=N.ratingAcknowledgement,I=ce({targetKey:"Enter"}),_=Object(g.useCallback)(function(){var e=Object(je.a)({message:"",activeConversation:t.conversationId,authorId:l.id,attributes:{conversationRating:{ratingPrompt:{ratingAcknowledgement:T,ratingPromptMessage:S.trim()},ratingValue:C,ratingText:E}},contentType:rt.c.BOT_CONVERSATION_RATING,type:rt.e.BOT_CONVERSATION_RATING});s(Object(re.j)({message:e})),j(!1)},[t,s,l.id,T,S,E,C]);Object(g.useEffect)(function(){I&&function isValidMessage(e){return e&&e.trim().length>0}(E)&&_()},[I,E,_]),Object(g.useEffect)(function(){o&&o!==t&&!f&&j(!0)},[t,o,f]);var P=Object(g.useMemo)(function(){return mt.map(function(e){var t=e.emoji,a=e.value;return b.a.createElement(Z.a,{className:u()("drift-widget-rate-conversation--rating",{"drift-widget-rate-conversation--rating--selected":a===C}),key:"rating_".concat(a),"aria-label":"rate ".concat(a),onClick:function onClick(){return M(a)}},t)})},[C]);if(!f)return null;return b.a.createElement(b.a.Fragment,null,b.a.createElement("div",{className:"drift-widget-rate-conversation--cover"}),b.a.createElement("div",{className:"drift-widget-rate-conversation"},b.a.createElement(dt,null,b.a.createElement("span",null,S),b.a.createElement(Z.a,{className:"drift-widget-rate-conversation--close-button","aria-label":"close rating",onClick:function onClick(){return j(!1)}},b.a.createElement(K.j,{width:20,height:20,fill:i}))),b.a.createElement("div",{className:"drift-widget-rate-conversation--body"},b.a.createElement("div",{className:"drift-widget-rate-conversation--ratings"},P),!!C&&b.a.createElement("div",{className:"drift-widget-rate-conversation--composer"},b.a.createElement("div",{className:"drift-widget-rate-conversation--actions"},b.a.createElement(Z.a,{className:"drift-widget-rate-conversation--send-button",onClick:_},b.a.createElement(K.n,{color:"#".concat(r)}))),b.a.createElement(ja,{"aria-label":"rating input",maxLength:4096,placeholder:a("form.placeholder.tellUsMore"),onValueChange:function onTextAreaValueChange(e){I||y(e)},value:E})))))}),ha=a("rTkt"),Aa=(a("zoZM"),function ThemeStyleSheets(){var e=Object(g.useState)(!1),t=Object(c.a)(e,2),a=t[0],n=t[1],r=Object(p.c)(function(e){return e.embed});return Object(g.useEffect)(function(){a||(Object(ha.a)(r),Object(ha.b)(r),n(!0))},[r,a]),b.a.createElement("div",{className:"drift-widget-preload-fonts","aria-hidden":"true"},b.a.createElement("span",null,"A"),b.a.createElement("strong",null,"B"))}),Ea=a("8ZCy"),ya=function useTimedMessages(e,t){var a=Object(g.useState)(function(){return e}),n=Object(c.a)(a,2),r=n[0],i=n[1],o=Object(g.useRef)(t),s=Object(g.useRef)(null);return Object(g.useEffect)(function(){if(t&&e.length&&e!==r){var a=r.length;if(o.current!==t||a===e.length)return o.current=t,void i(e);var n=function pushMessage(){return i(e.slice(0,a+1))};if(!Object(Te.i)(e[a]))return s.current=window.setTimeout(function(){s.current=null,n()},250),function(){s.current&&window.clearTimeout(s.current)};n()}},[e,r,t]),r},wa=function showBrandingSelector(e){return e.embed.configuration.showBranding||!1},ka=function useHasFooter(){var e=Object(p.c)(wa),t=Object(Ke.a)().noPolicy;return e||!t},Ca=a("jKoD"),Ma=(a("oY6K"),function SenderInfo(e){var t=e.senderId,a=e.messageText,n=void 0===a?null:a,r=Object(v.useTranslation)().t,i=Object(p.c)(function(e){return e.embed.configuration.organizationName}),c=Object(ue.a)(t).recipient,o=Object(g.useMemo)(function(){return n||(c.name?i&&i.length&&!Object(j.a)(i)?r("header.senderInfo",{name:c.name,orgName:i}):"".concat(c.name):"")},[c,i,n,r]);return b.a.createElement("div",{className:"drift-widget-greeting-agent-header"},b.a.createElement("h1",{className:"drift-widget-greeting-recipient-name"},o),b.a.createElement(Me.a,{id:t}))}),Na=a("TDUE"),Sa=a("gG69"),Ta=function useTrackImpressionOnce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sa.c.LIVE_CHAT,t=Object(g.useState)(!1),a=Object(c.a)(t,2),n=a[0],o=a[1],s=Object(p.c)(function(e){return e.view}).chatOpen;Object(g.useEffect)(function(){!function(){var t=Object(i.a)(r.a.mark(function _callee(){var t;return r.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(!s||n){a.next=5;break}return a.next=3,Object(Na.d)(e);case 3:t=a.sent,o(t);case 5:case"end":return a.stop()}},_callee)}));return function trackImpression(){return t.apply(this,arguments)}}()()},[n,s,e])},Ia=a("SWQ0"),_a=a("Nlet"),Pa=a("wNJw"),Ra=(a("sZBt"),function GDPR(e){var t=e.previewRef,a=Object(p.b)(),n=Object(p.c)(function(e){return e.embed.configuration.dataProtection}),c=n.policies,o=n.default,s=Object(p.c)(function(e){return e.embed.configuration}).team,l=void 0===s?[]:s,u=Object(p.c)(function(e){return e.session}).endUser,d=Object(g.useCallback)(function(){return a(Object(Ne.a)({chatOpen:!1}))},[a]),m=Object(_a.c)().locale,f=Object(g.useMemo)(function(){return l.find(function(e){return e.bot})||{}},[l]),v=Object(g.useMemo)(function(){var e=Object(y.a)(null,[m],c);if(e)return e;var t=Object(y.a)(null,["".concat(o)],c);return t||(Object(G.k)({data:["No locale matched and unable to find default policy: ".concat(t)]}),null)},[m,c,o]);if(Ta(Sa.c.GDPR),!v)return null;var j=function doRecordConsent(e){return Object(i.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,Object(Pa.a)(Ia.b.GDPR_CLICKED,{accepted:e,endUser:u.id}),!e){t.next=5;break}return t.next=5,Object(Ca.b)(u.id,v.message);case 5:a(Object(de.n)({hasConsent:e})),!e&&d(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn(t.t0);case 12:case"end":return t.stop()}},_callee,null,[[0,9]])}))};return b.a.createElement("div",{className:"drift-widget-gdpr-consent drift-widget-greeting"},b.a.createElement(Ma,{messageText:"Data Privacy Bot",senderId:f.id}),b.a.createElement("div",{ref:t,className:"drift-widget-gdpr-body"},b.a.createElement("div",{className:"drift-widget-greeting-content"},b.a.createElement("p",{className:"drift-widget-gdpr-consent--copy"},v.message)),b.a.createElement("div",{className:"drift-gdpr-actions"},b.a.createElement(Je,{className:"drift-gdpr-action--allow-consent",onClick:j(!0)},b.a.createElement("span",{className:"drift-gdpr-action--text"},v.giveConsentLabel)),b.a.createElement(Je,{className:"drift-gdpr-action--deny-consent",onClick:j(!1)},b.a.createElement("span",{className:"drift-gdpr-action--text"},v.declineConsentLabel)))))}),xa=a("GtSE"),za=function Time(e){var t=e.height,a=void 0===t?24:t,n=e.width,r=void 0===n?24:n,i=e.fill,c=void 0===i?"#FFF":i;return b.a.createElement("svg",{className:"drift-default-icon drift-default-icon--Time",width:r,height:a,viewBox:"0 0 20 20"},b.a.createElement("path",{d:"M3.55,10.3l.79-.78a.77.77,0,0,1,1.09,1.09L3.3,12.74a.79.79,0,0,1-1.11,0l-2-2.13A.77.77,0,1,1,1.33,9.54l.69.73V10a9,9,0,1,1,3.07,6.77.77.77,0,1,1,1-1.16A7.45,7.45,0,1,0,3.56,10C3.56,10.08,3.56,10.18,3.55,10.3Zm7.72-4.93v4.87h3.34a.77.77,0,0,1,0,1.54H10.5A.76.76,0,0,1,9.73,11V5.37a.77.77,0,0,1,1.54,0Z",fill:c}))},Da=(a("9Hpm"),function ConversationHeader(){var e=Object(v.useTranslation)().t,t=te(),a=Object(ue.a)(t).recipient,n=Object(p.c)(function(e){return e.conversations.conversations}),r=Object(h.a)(),i=r.backgroundStyles,c=r.conversationHeaderTextStyles,o=r.widgetSecondaryColor,s=Object(x.a)(),l=Se(),d=l.conversationHistoryOpen,m=l.onToggleConversationHistory;return b.a.createElement("div",{className:"drift-widget-active-conversation-header"},b.a.createElement(Ce,{size:"SMALL",id:a.id}),b.a.createElement("h1",{"aria-hidden":d,className:"drift-widget-recipient-name",style:c},a.name),b.a.createElement("div",{className:u()("drift-widget-conversation-history-header",{"drift-widget-conversation-history-header--open":d}),style:i},b.a.createElement(Z.a,{className:"drift-widget-history-back-button",onClick:function onClick(){return m(!d)},"aria-label":"back to conversation"},b.a.createElement(xa.a,{color:o,width:20,height:20})),b.a.createElement("h1",{"aria-hidden":!d,style:c},e("history.headerTitle"))),Object.keys(n).length>1&&b.a.createElement(Z.a,{className:u()("drift-widget-history",{"drift-widget-history--mobile":s,"drift-widget-history--open":d}),"aria-label":"drift conversation history",onClick:function onClick(){return m(!d)}},b.a.createElement(za,{fill:o,height:20,width:20})))}),La=function useDefaultGreeting(){var e=Object(v.useTranslation)().t,t=Object(p.c)(function(t){var a=Object(jt.a)(["embed","configuration","theme","welcomeMessage"],t);return a||e("greeting.onlineMessage")}),a=Object(p.c)(function(e){return e.view.matchedHours}),n=Object(p.c)(function(t){var a=Object(jt.a)(["embed","configuration","theme","awayMessage"],t);return a||e("greeting.awayMessage")});return a?t:n},Ba=(a("txDs"),function GreetingMessage(e){var t=e.previewRef,a=La(),n=te(),r=Object(p.c)(function(e){return e.view}).chatOpen,i=da(r),c=Object(p.c)(function(e){return e.view.matchedHours});return Object(g.useEffect)(function(){Object(zt.a)(i)||r===i||(c?Object(Le.t)(r):Object(Le.a)(r))},[i,r,c]),Ta(),b.a.createElement("div",{className:"drift-widget-greeting"},b.a.createElement(Ma,{senderId:n}),b.a.createElement("p",{ref:t,className:"drift-widget-greeting-content"},a))}),Ha=a("xyhj"),Fa=a("hSLT"),Ua=a("vjCh"),Ga=a("Wjfv"),Va=(a("Uo75"),function WelcomeMessage(e){var t=e.previewRef,a=Object(p.b)(),n=Object(p.c)(function(e){return e.view}).chatOpen,c=te(),o=Object(Fa.a)();if(!n)return null;var s=function(){var e=Object(i.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:Object(Ua.i)(o.id,o.playbookId),a(Object(Ga.a)());case 2:case"end":return e.stop()}},_callee)}));return function onCtaClicked(){return e.apply(this,arguments)}}();return b.a.createElement("div",{className:"drift-widget-greeting"},b.a.createElement(Ma,{senderId:c}),b.a.createElement("div",{ref:t,className:"drift-widget-welcome-message-content"},b.a.createElement("div",{dangerouslySetInnerHTML:{__html:'\n              <div class="drift-welcome-message-content--body">\n                '.concat(o.body,"\n              </div>\n            ")}})),o.ctaCopy&&o.ctaType!==rt.a.CHAT_RESPONSE&&b.a.createElement("div",{className:"drift-widget-greeting-cta-wrapper"},b.a.createElement(Ha.a,{ctaUrl:o.ctaUrl,ctaType:o.ctaType,ctaCopy:o.ctaCopy,onClick:s})))}),Ka="GREETING",Wa="CONVERSATION",Za="GDPR",qa="WELCOME_MESSAGE",Qa=(ge={},Object(Ze.a)(ge,qa,function(e){return b.a.createElement(Va,e)}),Object(Ze.a)(ge,Ka,function(e){return b.a.createElement(Ba,e)}),Object(Ze.a)(ge,Wa,function(e){return b.a.createElement(Da,e)}),Object(Ze.a)(ge,Za,function(e){return b.a.createElement(Ra,e)}),ge),Ja=a("2uLe"),Xa=(a("SwvN"),function HeaderLayout(e){var t=e.activeConversation,a=e.chatHidden,n=Object(p.b)(),r=Object(h.a)(),i=r.backgroundStyles,o=r.conversationHeaderTextStyles,s=Object(p.c)(function(e){return e.campaigns.activeCampaign}).id,l=Object(p.c)(function(e){return e.session.gdpr}).hasConsent,d=Object(x.a)(),m=Object(Ja.a)(),f=m.setChatHeight,v=m.previewRef,j=Object(p.c)(function(e){return e.view}).chatOpen,O=Object(g.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;return l?e?Wa:s?qa:Ka:Za},[t,l,s]),A=Object(g.useState)(O()),E=Object(c.a)(A,2),y=E[0],w=E[1],k=da(y),C=y!==k;Object(g.useLayoutEffect)(function(){j&&!a&&f(j,C)},[j,a,f,C]),Object(g.useEffect)(function(){var e=O(t);e!==y&&w(e)},[t,s,l,O,y]);var M=Qa[y],N=y!==Wa;return b.a.createElement("header",{className:u()("drift-widget-header",{"drift-widget-header--collapsed":N})},b.a.createElement("div",{className:"drift-widget-header-top-line",style:i}),b.a.createElement("div",{className:"drift-widget-header--content"},b.a.createElement(M,{previewRef:v})),d&&b.a.createElement(Z.a,{onClick:function doToggleChat(){n(Object(Ne.a)({chatOpen:!1}))},className:"drift-widget-mobile-close","aria-label":"close",style:o},b.a.createElement(K.j,{width:16,height:16})))}),Ya=a("kNJ0"),$a=a("MFhO"),en=a("VpmR"),tn=a("HSQL"),an=(a("sXTY"),null),nn=function ChatLayout(){var e=Object(p.b)(),t=Object(g.useState)(!0),a=Object(c.a)(t,2),n=a[0],l=a[1],d=Object(g.useState)(!1),m=Object(c.a)(d,2),f=m[0],v=m[1],j=Object(p.c)(function(e){return e.view}).chatOpen,O=Object(p.c)(function(e){return e.conversations.activeConversation}),A=da(O),E=Object(p.c)(function(e){return e.conversations.conversations}),w=Object(p.c)(function(e){return e.conversations.messages}),k=Object(p.c)(function(e){return Object(y.a)({},["conversations","messages",e.conversations.activeConversation],e)}),C=Object(g.useMemo)(function(){return Object(Te.l)(Object(_e.a)(k))},[k]),M=Object(p.c)(function(e){return e.campaigns.activeCampaign}),N=Object(g.useMemo)(function(){return Object(y.a)(null,["attributes","campaignDisplayType"],M)===$a.a.WELCOME_MESSAGE},[M]),S=Object(p.c)(function(e){return e.session.gdpr}).hasConsent,T=Object(h.a)().widgetBackgroundStyles,I=Object(g.useCallback)(function(){var t=Object(i.a)(r.a.mark(function _callee(t){var a,n,i,c,o,l;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(a=t.limit,n=void 0===a?30:a,i=t.from,c=void 0===i?null:i,O&&O!==Ea.d){r.next=3;break}return r.abrupt("return");case 3:return r.prev=3,r.next=6,Object(s.a)({conversationId:O,limit:n,from:c});case 6:return o=r.sent,l=o.data,e(Object(re.h)({messages:l.data,hasMoreMessages:Object(y.a)(!1,["pagination","more"],l),nextPageMessageId:Object(y.a)(null,["pagination","next"],l),conversationId:O})),r.abrupt("return",l);case 12:r.prev=12,r.t0=r.catch(3),Object(G.e)("Failed to fetch messages",r.t0);case 15:case"end":return r.stop()}},_callee,null,[[3,12]])}));return function(e){return t.apply(this,arguments)}}(),[O,e]);Object(g.useEffect)(function(){(function(){var t=Object(i.a)(r.a.mark(function _callee2(){var t,a,n,i,c;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(t=!O||O===Ea.d,a=A===O,n=!!E[O]&&!!w[O],!(t||a||n)){r.next=5;break}return r.abrupt("return");case 5:return r.prev=5,r.next=8,Object(o.e)(O);case 8:i=r.sent,c=i.data,e(Object(re.e)({conversation:c})),I({}),r.next=17;break;case 14:r.prev=14,r.t0=r.catch(5),Object(G.e)("Failed to fetch messages or active conversation",r.t0);case 17:case"end":return r.stop()}},_callee2,null,[[5,14]])}));return function fetchInfoForActiveConversation(){return t.apply(this,arguments)}})()()},[O,e,I,A,E,w]),Object(g.useEffect)(function(){j?(an&&clearTimeout(an),l(!1)):an=setTimeout(function delaySetReflowHidden(){l(!0)},300)},[j]),Object(g.useEffect)(function(){if(M.id){var e=!!Object(y.a)(null,["attributes","cta"],M),t="CHAT_RESPONSE"!==Object(y.a)(null,["attributes","cta","CtaType"],M);e&&t&&v(!0)}else v(!1)},[M,e]),Object(g.useEffect)(function(){Object(tn.b)("WIDGET_CHAT_FRAME.start")},[]);var _=Object(g.useMemo)(function(){if(Object(Te.a)(C))return{composerEnabled:!1};var e=Object(Pe.a)(C);if(!e)return{composerEnabled:!0};var t=Object(Ya.a)(-2,C);return Object(Te.g)(e)||Object(Te.g)(t)&&Object(Te.i)(e)?{composerEnabled:!1,buttonsOnly:!0}:{composerEnabled:!0}},[C]),P=_.composerEnabled,R=void 0!==P&&P,x=_.buttonsOnly,z=void 0!==x&&x,D=ya(C,O),L=Object(g.useMemo)(function(){return Object(Te.e)(D)},[D]),B=Object(g.useMemo)(function(){return b.a.createElement(pa,{activeConversation:O,messageGroups:L,messages:D,fetchMessages:I,reflowHidden:n})},[O,L,D,I,n]),H=ka(),F=Object(g.useMemo)(function(){if(D&&D.length){var e=Object(Pe.a)(D);if(e&&Object(Te.k)(e))return e}return null},[D]);return b.a.createElement("main",{className:"drift-widget-chat-layout",role:"main","aria-label":"drift-chat-main"},b.a.createElement(Aa,null),b.a.createElement("div",{className:u()("drift-widget-chat-wrapper",{"drift-widget-chat-wrapper__open":j,"drift-widget-chat-wrapper__closed":!j,"drift-widget-chat-wrapper__reflow-hidden":n,"drift-widget-chat-wrapper__active-conversation":!!O&&S})},b.a.createElement(Xa,{activeConversation:O,chatHidden:n}),b.a.createElement(Ue,null),O&&S&&b.a.createElement("div",{className:u()("drift-widget-message-history",{"drift-widget-message-history--with-footer":H}),style:T},B),b.a.createElement("div",{className:"drift-widget-chat-bottom"},!f&&S&&b.a.createElement(Ee,{enabled:R,buttonsOnly:z,onSubmit:function doSendMessage(t){if(N&&!O){var a=Object(y.a)(null,["attributes","playbookId"],M);Object(Le.c)(we.b.SUBMITTED,M.id),Object(Ua.i)(M.id,a)}e(Object(re.j)(t))},activeConversationId:O}),b.a.createElement(We,null)),O&&!!F&&b.a.createElement(Oa,{message:F})))};t.default=function(e){var t=Object(g.useState)(!1),a=Object(c.a)(t,2),n=a[0],o=a[1],s=Object(p.c)(function(e){return e.view.initComplete}),l=Object(p.c)(function(e){return Object(y.a)("en",["embed","configuration","locale"],e)});return Object(g.useEffect)(function(){s&&!n&&function(){var e=Object(i.a)(r.a.mark(function _callee3(){return r.a.wrap(function _callee3$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(en.a)(l);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),Object(G.k)({data:["i18n failed to load - ".concat(e.t0.message),e.t0],type:"warn"});case 8:o(!0);case 9:case"end":return e.stop()}},_callee3,null,[[0,5]])}));return function runAsync(){return e.apply(this,arguments)}}()()},[s,n,l]),s&&n?b.a.createElement(nn,e):b.a.createElement(d.a,null)}},SwvN:function(e,t,a){},Uo75:function(e,t,a){},UwV1:function(e,t,a){},Wkzb:function(e,t,a){},ZP32:function(e,t,a){},fmuz:function(e,t,a){},jKoD:function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"b",function(){return i});var n=a("efbE"),r=function getGeo(){return n.f.get("/geo/v2")},i=function recordConsent(e,t){return n.f.post("/end_users/".concat(e,"/consent"),{consentId:"has_consent",message:t})}},lE29:function(e,t,a){"use strict";var n=a("+vh4"),r=a("rAc1"),i=a("l6A5"),c=a("uDfI"),o={textColor:"353f45",backgroundColor:"0071EB",foregroundColor:"ffffff",widgetBackgroundColor:"0071EB",activeColor:"blue"},s=function resolveBackgroundStyles(e){return{background:"#".concat(e.backgroundColor),color:"#".concat(e.textColor)}},l=function resolveSvgStyles(e){return{fill:"#".concat(e.textColor)}},u=function resolveBorderStyles(e){return{borderColor:"#".concat(e.backgroundColor)}},d=function resolveTextColorStyles(e){return{color:"#".concat(e.foregroundColor)}},m=function resolveInlineImageStyles(e){return{background:"#".concat(e.foregroundColor),border:"4px solid #".concat(e.foregroundColor)}},f=function resolveHeaderTextStyles(e){return{color:"#".concat(e.foregroundColor)}},g=function resolveInlineFileStyles(e){return{color:"#".concat(e.foregroundColor)}},b=function resolveButtonStyles(e){return{color:"#".concat(e.backgroundColor),borderColor:"#".concat(e.backgroundColor),backgroundColor:"#".concat(e.foregroundColor)}},v=function resolveForegroundColors(e){return{backgroundColor:"#".concat(e.backgroundColor),color:"#".concat(e.foregroundColor),border:"1px solid #".concat(e.backgroundColor)}},p=function resolvePrimaryTextColor(e){return{color:"#".concat(e.backgroundColor)}},j=function resolveWidgetBackgroundStyles(e){return{background:"#".concat(e.widgetBackgroundColor)}},O=function resolveWidgetAlphaBackground(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".8";return{background:function convertHex(e){var a=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return"rgba(".concat(a,", ").concat(n,", ").concat(r,", ").concat(t,")")}(e.widgetBackgroundColor)}},h=Object(i.a)(function memoIdentity(e){return Object(r.a)(e)},function(e){var t=Object(n.a)({},o,e);return{backgroundStyles:s(t),borderStyles:u(t),svgStyles:l(t),textColorStyles:d(t),buttonStyles:b(t),foregroundStyles:v(t),inlineImageStyles:m(t),widgetBackgroundStyles:j(t),conversationHeaderTextStyles:f(t),inlineFileStyles:g(t),activeColor:t.activeColor,widgetSecondaryColor:"#".concat(t.foregroundColor),widgetBackgroundColor:t.widgetBackgroundColor,widgetBackgroundAlpha:O(t),primaryTextColor:p(t)}});t.a=function useThemeColors(){var e=Object(c.c)(function(e){return e.embed.configuration.theme});return h(e)}},mQ2C:function(e,t,a){},"n/d+":function(e,t,a){},nvPd:function(e,t,a){"use strict";var n=a("s8DI"),r=a("ERkP");t.a=function useInputValue(e){var t=Object(r.useState)(e),a=Object(n.a)(t,2),i=a[0],c=a[1];return{value:i,onChange:Object(r.useCallback)(function(e){c(e.currentTarget.value)},[])}}},o3t1:function(e,t,a){"use strict";var n=a("s8DI"),r=a("ERkP"),i=a("0lfv"),c=a("6wvX");t.a=function useOnHover(){var e=Object(c.a)(),t=Object(r.useState)(!1),a=Object(n.a)(t,2),o=a[0],s=a[1];return Object(r.useMemo)(function(){return e?{}:{hoverProps:{onMouseOver:function onMouseOver(){return s(!0)},onMouseOut:function onMouseOut(){return s(!1)},onFocus:i.l,onBlur:i.l},isHovered:o}},[e,o])}},oY6K:function(e,t,a){},"p0+K":function(e,t,a){},rAhV:function(e,t,a){"use strict";var n=a("OE2q"),r=a("K7i0"),i=a("uDfI"),c=a("0lfv");t.a=function useMarkAsRead(){var e=Object(i.c)(function(e){return e.conversations}).unreadAgentMessages,t=void 0===e?{}:e,a=Object(i.b)();return{markAsRead:function markAsRead(e){var i=t[e]||[];if(i.length)try{Object(n.f)(e,i),a(Object(r.i)({conversationId:e}))}catch(o){Object(c.e)(new Error(o))}}}}},sXTY:function(e,t,a){},sZBt:function(e,t,a){},"t/7O":function(e,t,a){},tLIi:function(e,t,a){"use strict";var n=a("LVcX"),r=a("i9gz"),i=a("TbSn"),c=a("uDfI");t.a=function useLastAgentMessage(){var e=Object(c.c)(function(e){return e.conversations}).activeConversation,t=Object(c.c)(function(t){return Object(n.a)(null,["conversations","conversations",e,"lastAgentMessage"],t)}),a=Object(c.c)(function(t){var a=Object(n.a)({},["conversations","messages",e],t);if(Object(r.a)(a))return{};var c=Object.values(a).filter(function(e){return"USER"===Object(n.a)(null,["authorType"],e)});return c.length?Object(i.a)(c):void 0});return t||a||{}}},txDs:function(e,t,a){},vYbd:function(e,t,a){},xyhj:function(e,t,a){"use strict";var n=a("lE29"),r=a("ERkP"),i=a.n(r),c=a("uDfI"),o=a("PjZB"),s=a("7oto");a("MWt3");t.a=function CtaButton(e){var t=e.ctaUrl,a=e.ctaCopy,r=e.ctaType,l=e.onClick,u=Object(n.a)().backgroundStyles,d=Object(c.c)(function(e){return e.campaigns.activeCampaign}),m=function onCtaClick(e){r===o.a.CHAT_RESPONSE?Object(s.a)({topic:"drift-api:open-chat"}):r===o.a.SCHEDULE_MEETING&&Object(s.a)({topic:"drift-api:schedule-meeting",message:{scheduleMeetingWith:d.attributes.senderId,options:{activeCampaign:d}}}),l&&l(e)};return r===o.a.LINK_TO_URL?i.a.createElement("div",{className:"drift-widget-announcement-cta drift-widget-announcement-cta-link-wrapper",style:u},i.a.createElement("a",{className:"drift-widget-announcement-cta-link",href:t,onClick:m,target:"_blank",rel:"noopener noreferrer"},a)):i.a.createElement("button",{className:"drift-widget-announcement-cta",onClick:m,style:u},a)}},zoZM:function(e,t,a){}}]);